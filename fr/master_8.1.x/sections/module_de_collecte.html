<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>14. Module de collecte &mdash; Vitam documentation fonctionnelle</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=eea1f72d" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f4732e6d"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=bf059b8c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="15. Les éliminations avec la solution logicielle Vitam" href="eliminations.html" />
    <link rel="prev" title="13. Description des workflows et des opérations" href="modele_de_workflow.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../index.html">
            
              <img src="../_static/Vitam_Logo-CMJN.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">première approche</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="guide_lecture.html">1. Documentation Vitam - guide de lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation_programme.html">2. Présentation du programme Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation_solution_logicielle.html">3. Présentation de la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide_prise_en_main.html">4. Guide de prise en main de la solution logicielle Vitam – Vitam UI<br>
<em>Réaliser une première entrée</em></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">documentation métier</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="organisation_information.html">1. Organisation de l’information</a></li>
<li class="toctree-l1"><a class="reference internal" href="gestion_archives_arbo.html">2. Gestion des archives et des arborescences</a></li>
<li class="toctree-l1"><a class="reference internal" href="modele_de_donnees.html">3. Modèle de données</a></li>
<li class="toctree-l1"><a class="reference internal" href="SIP.html">4. Structuration des <em>Submission Information Packages</em> (SIP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="DIP.html">5. Structuration des <em>Dissemination Information Packages</em> (DIP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gestion_habilitations.html">6. Gestion des habilitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="regles_gestion.html">7. Règles de gestion</a></li>
<li class="toctree-l1"><a class="reference internal" href="services_prod.html">8. Services producteurs</a></li>
<li class="toctree-l1"><a class="reference internal" href="profil_archivage.html">9. Profils d’archivage</a></li>
<li class="toctree-l1"><a class="reference internal" href="profil_unite_archivistique.html">10. Profils d’unité archivistique</a></li>
<li class="toctree-l1"><a class="reference internal" href="ontologie.html">11. Ontologie</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">12. Schéma</a></li>
<li class="toctree-l1"><a class="reference internal" href="modele_de_workflow.html">13. Description des workflows et des opérations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">14. Module de collecte</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">14.1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#documents-de-reference">14.1.1. Documents de référence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#presentation-du-document">14.1.2. Présentation du document</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#presentation-du-module-de-collecte">14.2. Présentation du module de collecte</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quest-ce-que-la-collecte-darchives">14.2.1. Qu’est-ce que la collecte d’archives ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quest-ce-que-le-module-de-collecte">14.2.2. Qu’est-ce que le module de collecte ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pourquoi-quand-et-comment-utiliser-le-module-de-collecte">14.2.3. Pourquoi, quand et comment utiliser le module de collecte ?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mecanismes-mis-en-oeuvre-dans-la-solution-logicielle-vitam">14.3. Mécanismes mis en œuvre dans la solution logicielle Vitam</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">14.3.1. Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#definitions">14.3.1.1. Définitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creation-d-un-projet-de-versement">14.3.1.2. Création d’un projet de versement</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#utilisation-des-api">14.3.1.2.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#utilisation-dans-vitamui">14.3.1.2.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#acces">14.3.1.3. Accès</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id3">14.3.1.3.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id4">14.3.1.3.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#modification-d-un-projet-de-versement">14.3.1.4. Modification d’un projet de versement</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id5">14.3.1.4.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id6">14.3.1.4.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#suppression-d-un-projet-de-versement">14.3.1.5. Suppression d’un projet de versement</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id7">14.3.1.5.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id8">14.3.1.5.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#versement">14.3.2. Versement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">14.3.2.1. Définitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creation-d-une-transaction">14.3.2.2. Création d’une transaction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id10">14.3.2.2.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id12">14.3.2.2.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#alimentation-d-une-transaction-en-mode-unitaire">14.3.2.3. Alimentation d’une transaction en mode « unitaire »</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#envoi-dunites-archivistiques">14.3.2.3.1. Envoi d’unités archivistiques</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id13">14.3.2.3.1.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id16">14.3.2.3.1.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#envoi-des-metadonnees-techniques">14.3.2.3.2. Envoi des métadonnées techniques</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id17">14.3.2.3.2.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id20">14.3.2.3.2.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#envoi-des-objets">14.3.2.3.3. Envoi des objets</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id21">14.3.2.3.3.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id23">14.3.2.3.3.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#alimentation-d-une-transaction-en-mode-lot">14.3.2.4. Alimentation d’une transaction en mode « lot »</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#envoi-dune-arborescence-bureautique">14.3.2.4.1. Envoi d’une arborescence bureautique</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id24">14.3.2.4.1.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id30">14.3.2.4.1.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#envoi-dune-arborescence-bureautique-avec-fichier-csv">14.3.2.4.2. Envoi d’une arborescence bureautique avec fichier .csv</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id31">14.3.2.4.2.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id38">14.3.2.4.2.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#envoi-dune-arborescence-bureautique-avec-fichier-jsonl">14.3.2.4.3. Envoi d’une arborescence bureautique avec fichier .jsonl</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id39">14.3.2.4.3.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id45">14.3.2.4.3.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id46">14.3.3. Accès</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id47">14.3.3.1. Définitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acces-aux-informations-du-versement">14.3.3.2. Accès aux informations du versement</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id48">14.3.3.2.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id49">14.3.3.2.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#acces-aux-unites-archivistiques">14.3.3.3. Accès aux unités archivistiques</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id50">14.3.3.3.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id51">14.3.3.3.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#acces-aux-groupes-d-objets-techniques">14.3.3.4. Accès aux groupes d’objets techniques</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id52">14.3.3.4.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id53">14.3.3.4.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gestion-des-transactions">14.3.4. Gestion des transactions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id54">14.3.4.1. Définitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modification-d-une-transaction">14.3.4.2. Modification d’une transaction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id55">14.3.4.2.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id56">14.3.4.2.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#suppression-d-une-transaction">14.3.4.3. Suppression d’une transaction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id57">14.3.4.3.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id58">14.3.4.3.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#abandon-d-une-transaction">14.3.4.4. Abandon d’une transaction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id59">14.3.4.4.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id63">14.3.4.4.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#reouverture-d-une-transaction">14.3.4.5. Réouverture d’une transaction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id65">14.3.4.5.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id67">14.3.4.5.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#validation-d-une-transaction">14.3.4.6. Validation d’une transaction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id69">14.3.4.6.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id72">14.3.4.6.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#envoi-d-une-transaction">14.3.4.7. Envoi d’une transaction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id74">14.3.4.7.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id78">14.3.4.7.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gestion-des-archives">14.3.5. Gestion des archives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id80">14.3.5.1. Définitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modification-des-metadonnees">14.3.5.2. Modification des métadonnées</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#modification-unitaire-en-masse">14.3.5.2.1. Modification unitaire en masse</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id81">14.3.5.2.1.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id83">14.3.5.2.1.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#modification-par-import-de-fichier-csv">14.3.5.2.2. Modification par import de fichier .csv</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id84">14.3.5.2.2.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id87">14.3.5.2.2.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#modification-par-import-de-fichier-jsonl">14.3.5.2.3. Modification par import de fichier .jsonl</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id88">14.3.5.2.3.1. Utilisation des API</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id90">14.3.5.2.3.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#reorganisation-des-arborescences">14.3.5.3. Réorganisation des arborescences</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id91">14.3.5.3.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id92">14.3.5.3.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#ajout-d-archives">14.3.5.4. Ajout d’archives</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id93">14.3.5.4.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id97">14.3.5.4.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#suppression-d-archives">14.3.5.5. Suppression d’archives</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id98">14.3.5.5.1. Utilisation des API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id99">14.3.5.5.2. Utilisation dans VitamUI</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#conseils-de-mise-en-oeuvre">14.4. Conseils de mise en œuvre</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#comment-formaliser-les-donnees-dans-les-api-du-module-de-collecte">14.4.1. Comment formaliser les données dans les API du module de collecte ?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generalites">14.4.1.1. Généralités</a></li>
<li class="toctree-l4"><a class="reference internal" href="#types">14.4.1.2. Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cas-particulier">14.4.1.3. Cas particulier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#comment-sont-geres-les-statuts-dune-transaction">14.4.2. Comment sont gérés les statuts d’une transaction ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comment-parametrer-un-versement">14.4.3. Comment paramétrer un versement ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quels-sont-les-rattachements-possibles">14.4.4. Quels sont les rattachements possibles ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comment-parametrer-des-regles-de-transformation">14.4.5. Comment paramétrer des règles de transformation ?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#absence-d-actions-sur-les-donnees-entrantes">14.4.5.1. Absence d’actions sur les données entrantes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#actions-sur-les-donnees-entrantes">14.4.5.2. Actions sur les données entrantes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#quels-sont-les-profils-utilisateurs-possibles">14.4.6. Quels sont les profils utilisateurs possibles ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quels-sont-les-services-disponibles">14.4.7. Quels sont les services disponibles ?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#annexe-1-exemples-de-donnees-entrantes">14.5. Annexe 1 : Exemples de données entrantes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#metadonnees-d-en-tete">14.5.1. Métadonnées d’en-tête</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-unitaire-d-archives">14.5.2. Création unitaire d’archives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#unites-archivistiques">14.5.2.1. Unités archivistiques</a></li>
<li class="toctree-l4"><a class="reference internal" href="#objets">14.5.2.2. Objets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#creation-d-archives-en-lot-avec-fichier-jsonl">14.5.3. Création d’archives en lot avec fichier .jsonl</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-d-archives-en-lot-avec-fichier-csv">14.5.4. Création d’archives en lot avec fichier .csv</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#annexe-2-types-json">14.6. Annexe 2 : Types JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="#annexe-3-liste-des-points-dapi">14.7. Annexe 3 : Liste des points d’API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#annexe-4-exemples-de-transformations-jslt">14.8. Annexe 4 : Exemples de transformations JSLT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exemple-1">14.8.1. Exemple 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemple-2">14.8.2. Exemple 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemple-3">14.8.3. Exemple 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemple-4">14.8.4. Exemple 4</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#annexe-5-liste-de-fonctions-jslt">14.9. Annexe 5 : Liste de fonctions JSLT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fonctions-generales">14.9.1. Fonctions générales</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fonctions-string">14.9.2. Fonctions string</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fonctions-date">14.9.3. Fonctions date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fonctions-booleen">14.9.4. Fonctions booléen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fonctions-numeriques">14.9.5. Fonctions numériques</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fonctions-objet">14.9.6. Fonctions objet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fonctions-tableau-array">14.9.7. Fonctions tableau (array)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#autres-fonctions">14.9.8. Autres fonctions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="eliminations.html">15. Les éliminations avec la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="gel.html">16. Le gel d’archives avec la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="preservation.html">17. Gestion de la préservation</a></li>
<li class="toctree-l1"><a class="reference internal" href="stockage.html">18. Gestion de multiples stratégies de stockage</a></li>
<li class="toctree-l1"><a class="reference internal" href="transfert.html">19. Le transfert avec la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="valeur_probante.html">20. Conservation de la valeur probante</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">documentation Vitam UI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="VitamUI_Autoprovisionning.html">1. Vitam UI : présentation de la fonctionnalité d’auto-provisioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="VitamUI_Arbres_Plans.html">2. APP Arbres et plans</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">outils connexes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="resip.html">1. RESIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="resip_faq.html">2. RESIP : foire aux questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="pastis_standalone.html">3. PASTIS STANDALONE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chantier préservation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="chantier_preservation_validation_format.html">1. Validation du format des fichiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="chantier_identification_format.html">2. Identification des formats de fichiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="chantier_extraction_MD.html">3. Extraction des métadonnées techniques</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vademecum</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_sommaire.html">1. Vademecum: sommaire thématique</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_glossaire.html">2. Notions utilisées dans la solution logicielle Vitam et lien vers la fiche qui les définit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_arbre.html">3. L’arbre de positionnement dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_audit.html">4. Les audits dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_classification.html">5. La gestion des archives classifiées avec la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_contrat_acces.html">6. Le contrat d’accès dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_contrat_entree.html">7. Le contrat d’entrée dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_contrat_gestion.html">8. Le contrat de gestion dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_echeances.html">9. Le calcul des héritages des règles de gestion et l’indexation des échéances dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_eliminations.html">10. Réaliser des éliminations d’archives avec la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_habilitations.html">11. La gestion des droits et permissions des utilisateurs applicatifs dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_identifiants.html">12. L’attribution des identifiants dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_journalisation.html">13. La journalisation et la conservation de la valeur probante dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_ontologie.html">14. L’ontologie dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_pa.html">15. Les profils d’archivage dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_parametrages_pf.html">16. Le paramétrage fonctionnel d’une plate-forme utilisant la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_plan.html">17. Le plan de classement dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_preservation.html">18. La préservation dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_pua.html">19. Les profils d’unité archivistique dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_rattachement.html">20. Faire un rattachement dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_referentiel_formats.html">21. Le référentiel des formats dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_referentiel_griffons.html">22. Le référentiel des griffons dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_referentiel_preservation.html">23. Le référentiel des scénarios de préservation dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_referentiel_rg.html">24. Le référentiel des règles de gestion dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_referentiel_sa.html">25. Le référentiel des services agents dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_registre_fonds.html">26. Le registre des fonds dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_structuration_information.html">27. La structuration des informations dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_suivi_acces.html">28. Le suivi des accès dans la solution logicielle Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vademecum_tenant.html">29. Les tenants dans la solution logicielle Vitam</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Documentation utilisateur Vitam</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">14. </span>Module de collecte</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/sections/module_de_collecte.md.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">


           <div itemprop="articleBody">
             
  <section id="module-de-collecte">
<h1><span class="section-number">14. </span>Module de collecte<a class="headerlink" href="#module-de-collecte" title="Lien vers cette rubrique"></a></h1>
<section id="introduction">
<h2><span class="section-number">14.1. </span>Introduction<a class="headerlink" href="#introduction" title="Lien vers cette rubrique"></a></h2>
<section id="documents-de-reference">
<h3><span class="section-number">14.1.1. </span>Documents de référence<a class="headerlink" href="#documents-de-reference" title="Lien vers cette rubrique"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Document</p></th>
<th class="head text-center"><p>Date de la version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>NF Z 44022 – MEDONA – Modélisation des données pour l’archivage</p></td>
<td class="text-center"><p>18/01/2014</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Standard d’échange de données pour l’archivage – SEDA – v. 2.1</p></td>
<td class="text-center"><p>06/2018</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Standard d’échange de données pour l’archivage – SEDA – v. 2.2</p></td>
<td class="text-center"><p>02/2022</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Standard d’échange de données pour l’archivage – SEDA – v. 2.3</p></td>
<td class="text-center"><p>06/2024</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><a class="reference internal" href="SIP.html"><span class="std std-doc">Vitam – Structuration des <em>Submission Information Package</em> (SIP)</span></a></p></td>
<td class="text-center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><a class="reference internal" href="modele_de_donnees.html"><span class="std std-doc">Vitam – Modèle de données</span></a></p></td>
<td class="text-center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><a class="reference internal" href="ontologie.html"><span class="std std-doc">Vitam – Ontologie</span></a></p></td>
<td class="text-center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><a class="reference internal" href="schema.html"><span class="std std-doc">Vitam – Schéma</span></a></p></td>
<td class="text-center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><a class="reference internal" href="profil_archivage.html"><span class="std std-doc">Vitam – Profils d’archivage</span></a></p></td>
<td class="text-center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><a class="reference internal" href="profil_unite_archivistique.html"><span class="std std-doc">Vitam – Profils d’unité archivistiques</span></a></p></td>
<td class="text-center"><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="presentation-du-document">
<h3><span class="section-number">14.1.2. </span>Présentation du document<a class="headerlink" href="#presentation-du-document" title="Lien vers cette rubrique"></a></h3>
<p>Le document présente les fonctionnalités associées à l’utilisation du module de collecte dans la solution logicielle Vitam.</p>
<p>Il s’articule autour des axes suivants :</p>
<ul class="simple">
<li><p>une présentation du module de collecte ;</p></li>
<li><p>une présentation des mécanismes mis en œuvre dans la solution logicielle Vitam pour prendre en compte les opérations de collecte, en application du SEDA ;</p></li>
<li><p>des conseils de mise en œuvre.</p></li>
</ul>
<p>Le présent document décrit les fonctionnalités qui sont offertes par la solution logicielle Vitam au terme de la version 8.1 (printemps 2025). Il a vocation à être amendé, complété et enrichi au fur et à mesure de la réalisation de la solution logicielle Vitam et des retours et commentaires formulés par les ministères porteurs et les partenaires du programme.</p>
</section>
</section>
<section id="presentation-du-module-de-collecte">
<h2><span class="section-number">14.2. </span>Présentation du module de collecte<a class="headerlink" href="#presentation-du-module-de-collecte" title="Lien vers cette rubrique"></a></h2>
<section id="quest-ce-que-la-collecte-darchives">
<h3><span class="section-number">14.2.1. </span>Qu’est-ce que la collecte d’archives ?<a class="headerlink" href="#quest-ce-que-la-collecte-darchives" title="Lien vers cette rubrique"></a></h3>
<p>La <strong>collecte</strong> d’archives désigne l’ensemble des opérations qui vont conduire au <strong>transfert</strong> d’un ensemble d’archives :</p>
<ul class="simple">
<li><p>d’un service producteur à un service d’archives,</p></li>
<li><p>d’un service d’archives intermédiaires à un service d’archives définitives.</p></li>
</ul>
<p>Un <strong>versement</strong> correspond à un ensemble d’archives faisant l’objet du transfert.</p>
<p>Le <strong>transfert</strong> matérialise l’opération visant à transférer la responsabilité de la conservation des archives d’un service à un autre.</p>
<p>La collecte d’archives peut intervenir à plusieurs occasions :</p>
<ul class="simple">
<li><p>Un service producteur soumet un versement à un service d’archives ;</p></li>
<li><p>La collecte peut être à l’initiative d’un service d’archives, dans le cadre d’une campagne de collecte d’archives ;</p></li>
<li><p>Des règles de gestion associées à des archives arrivent à échéance et impliquent un transfert de responsabilité en termes de conservation de ces dernières et, de fait, un transfert vers un autre service d’archivage.</p></li>
</ul>
<p>La manière de procéder au transfert d’archives est définie dans la norme NF Z 44-022 et dans sa déclinaison pour les acteurs du service public, le Standard d’échanges de données pour l’archivage (SEDA).</p>
<p>Le versement, pouvant également être nommé transfert ou <strong>transaction</strong>, s’effectue en deux temps :</p>
<ul class="simple">
<li><p>la soumission d’un ensemble d’archives à verser en vue de :</p>
<ul>
<li><p>vérifier son contenu et, le cas échéant, procéder à des traitements (ex. suppression de documents, renommage, etc.) ;</p></li>
<li><p>documenter et contextualiser le versement, par l’ajout d’informations sur le service producteur, son contenu, ses règles de gestion ;</p></li>
</ul>
</li>
<li><p>après validation de l’ensemble d’archives candidates à l’archivage par les parties concernées, transfert des archives en vue d’en assurer leur conservation et transfert de la responsabilité liée à leur conservation.</p></li>
</ul>
<p>Au préalable de versements, une politique ou stratégie de versement est définie par le service d’archives, en termes de rôles et responsabilités, mais aussi de contenu attendu. Elle est définie dans un contrat de versement, dont une partie est matérialisée dans un projet de versement et un contrat d’entrée.</p>
</section>
<section id="quest-ce-que-le-module-de-collecte">
<h3><span class="section-number">14.2.2. </span>Qu’est-ce que le module de collecte ?<a class="headerlink" href="#quest-ce-que-le-module-de-collecte" title="Lien vers cette rubrique"></a></h3>
<p>La solution logicielle Vitam met à disposition un <strong>module de collecte</strong> en vue de recevoir des ensembles hétérogènes d’archives, de paramétrer leur réception, de procéder à des traitements sur ces archives et de les transférer pour conservation dans le système d’archivage électronique. Ce module :</p>
<ul class="simple">
<li><p>constitue un service du back-office de la solution logicielle Vitam ;</p></li>
<li><p>est utilisé par l’APP « Collecte et préparation des versements » du front-office VitamUI.</p></li>
</ul>
<p>Ce module intervient en amont du transfert (ou versement) d’archives dans la solution logicielle Vitam. Son installation, ainsi que son utilisation, sont optionnelles.</p>
<p><em>Positionnement du module de collecte en amont du versement</em></p>
<p><img alt="" src="../_images/100002010000028D000001AB99F8EB7026B5C8F3.png" /></p>
<p>Il permet de :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><strong>Configurer des versements</strong></p></td>
<td><p>Définir un projet de versement et paramétrer :<br>- acteurs et références génériques,<br>- un rattachement automatisé à une position dans l’arborescence, avec ou sans paramétrages de conditions de rattachement,<br>- une clôture automatique après validation du versement,<br>- le formatage des données entrantes.</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><strong>(Pré-)Verser les archives</strong></p></td>
<td><p>Collecter depuis l’extérieur un ensemble d’archives, caractérisées par des métadonnées et des fichiers numériques, et constituer :<br>- des (pré-)versements (ou transactions) automatisés émanant d’un système d’information externe <br>- des (pré-)versements (ou transactions) manuels et unitaires : <br>a) constitués par exemple d’arborescences bureautiques ou de messageries,<br>b) réalisés depuis des interfaces, notamment celles de l’APP « Collecte et préparation des versements » du front-office VitamUI.</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><strong>Consulter les (pré-)versement</strong></p></td>
<td><p>Consulter :<br>- la liste des projets de versement et des (pré-)versements (ou transactions) en attente,<br>- un projet de versement en particulier, c’est-à-dire sa description, les informations contextuelles et la position de rattachement dans le tenant de destination,<br>- le contenu d’un (pré-)versement (ou transaction), c’est-à-dire la liste des archives associées, une unité archivistique en particulier et, le cas échéant, l’objet numérique associé.</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><strong>Traiter les archives</strong></p></td>
<td><p>Procéder à des traitements archivistiques tels que :<br>- définition de métadonnées contextuelles,<br>- identification de format,<br>- calcul d’empreintes,<br>- calcul du poids de l’objet numérique,<br>- réorganisation d’arborescence,<br>- ajout de dossiers et d’objets numériques,<br>- mise à jour de métadonnées descriptives et de gestion,<br>- suppression d’arborescences et/ou d’objets numériques,<br>- tri, dédoublonnage <em>(services non implémentés),</em><br>- gestion de statuts (ex. réouverture d’un (pré-)versement en erreur),<br>- suppression de projets et de (pré-)versements,<br>- etc.</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><strong>Transférer les archives</strong></p></td>
<td><p>- Générer un SIP conforme au Standard d’échanges de données pour l’archivage (SEDA) et le transférer dans le système d’archivage électronique pour conservation.<br>- Suppression  automatisée d’un (pré-)versement</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pourquoi-quand-et-comment-utiliser-le-module-de-collecte">
<h3><span class="section-number">14.2.3. </span>Pourquoi, quand et comment utiliser le module de collecte ?<a class="headerlink" href="#pourquoi-quand-et-comment-utiliser-le-module-de-collecte" title="Lien vers cette rubrique"></a></h3>
<p>Le module de collecte permet de :</p>
<ul class="simple">
<li><p>faciliter, voire automatiser, les versements (ou transactions) d’archives, depuis un service externe vers la solution logicielle Vitam ;</p></li>
<li><p>le cas échéant, effectuer un contrôle supplémentaire sur les projets de versement et leur contenu, en vue de vérifier la qualité des données, en amont de leur transfert dans un système d’archivage électronique ;</p></li>
<li><p>enrichir les métadonnées (notamment par l’identification de formats, le calcul d’empreintes et du poids de l’objet numérique, ou encore la mise à jour des métadonnées descriptives et de gestion) ;</p></li>
<li><p>proposer un format pivot et générique pour les services externes souhaitant verser des archives au sein de la solution logicielle Vitam ;</p></li>
<li><p>améliorer l’interopérabilité entre les systèmes d’information.</p></li>
</ul>
<p>L’utilisation du module de collecte peut être envisagée dans les cas suivants :</p>
<ul class="simple">
<li><p>versements de flux applicatifs, afin de les automatiser ;</p></li>
<li><p>versements de dossiers ou de documents dits « sériels », obéissant <em>strictement</em> à des règles de nommage et de description uniformes (par exemple, des images numérisées par un service d’archives) ;</p></li>
<li><p>versements réguliers et récurrents d’un même type d’archives par différents services producteurs et donc répondant à la volonté de disposer d’une description homogène, y compris pour faciliter les recherches sur celles-ci ;</p></li>
<li><p>versements ponctuels d’archives hétérogènes, quel que soit leur type (bureautique, audiovisuel, etc.).</p></li>
</ul>
<p>En outre, il peut être utilisé de manière différente en permettant de :</p>
<ul class="simple">
<li><p>en faisant appel uniquement à ses services back-office et ses API, automatiser des flux de versements émanant de systèmes d’information ;</p></li>
<li><p>construire des interfaces, en appelant ses API permettant de générer un SIP, en vue de faciliter la saisie d’un bordereau de transfert et la préparation d’un versement ;</p></li>
<li><p>utiliser les interfaces de l’APP « Collecte et préparation des versements » du front-office VitamUI.</p></li>
</ul>
</section>
</section>
<section id="mecanismes-mis-en-oeuvre-dans-la-solution-logicielle-vitam">
<h2><span class="section-number">14.3. </span>Mécanismes mis en œuvre dans la solution logicielle Vitam<a class="headerlink" href="#mecanismes-mis-en-oeuvre-dans-la-solution-logicielle-vitam" title="Lien vers cette rubrique"></a></h2>
<p>La solution logicielle Vitam offre à un service d’archives plusieurs fonctionnalités lui permettant de <strong>collecter des archives</strong> au moyen du module de collecte :</p>
<ul class="simple">
<li><p>la <strong>configuration</strong> des (pré-)versements (ou transactions) au moyen de la définition d’un projet de versement ;</p></li>
<li><p>leur <strong>(pré-)versement</strong> (ou collecte) dans le module ;</p></li>
<li><p>leur <strong>recherche</strong> et leur consultation ;</p></li>
<li><p>leur <strong>gestion</strong> et leur traitement ;</p></li>
<li><p>leur <strong>transfert</strong> vers les espaces de conservation pérennes de la solution logicielle Vitam.</p></li>
</ul>
<section id="configuration">
<h3><span class="section-number">14.3.1. </span>Configuration<a class="headerlink" href="#configuration" title="Lien vers cette rubrique"></a></h3>
<section id="definitions">
<h4><span class="section-number">14.3.1.1. </span>Définitions<a class="headerlink" href="#definitions" title="Lien vers cette rubrique"></a></h4>
<p>Dans la solution logicielle Vitam, il est possible de configurer le versement de un à plusieurs SIP conforme(s) au Standard d’échanges des données pour l’archivage (SEDA) en initialisant un <strong>projet de versement</strong> au sein du module de collecte.</p>
<p>Un projet de versement est propre à chaque tenant de la solution logicielle Vitam.</p>
<p>Il permet de préconfigurer dans une base de données dédiée, sous forme d’enregistrements JSON, les informations relatives à :</p>
<ul class="simple">
<li><p>des métadonnées correspondant à l’en-tête du message ArchiveTransfer (Base Collect &gt; Collection Project),</p></li>
<li><p>le rattachement automatisé à :</p>
<ul>
<li><p>une position dans le tenant de destination,</p></li>
<li><p>une à plusieurs position(s) en fonction de la définition de conditions à respecter dans le versement,</p></li>
</ul>
</li>
<li><p>les métadonnées descriptives et de gestion attendues dans le cas d’un versement en lot d’archives,</p></li>
<li><p>la gestion automatisée des transactions,</p></li>
<li><p>la fréquence des transferts vers la solution logicielle Vitam, etc. (<em>service non implémenté</em>).</p></li>
</ul>
<p>Les fonctionnalités ont été conçues et réalisées de manière à prendre en compte 1 à n transaction(s) pour un projet de versement.</p>
<p><img alt="" src="../_images/ProjetEtTransactions.png" /></p>
<p>Un projet de versement est modifiable.</p>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>La création et la modification d’un projet de versement dans le module de collecte ne sont pas journalisées dans le journal des opérations.</p></li>
<li><p>Il est recommandé d’avoir une seule transaction en cours d’alimentation pour un projet de versement.</p></li>
<li><p>Il n’est pas recommandé de modifier un projet de versement lorsqu’une transaction est en cours d’alimentation.</p></li>
</ul>
</section>
<section id="creation-d-un-projet-de-versement">
<h4><span class="section-number">14.3.1.2. </span>Création d’un projet de versement<a class="headerlink" href="#creation-d-un-projet-de-versement" title="Lien vers cette rubrique"></a></h4>
<section id="utilisation-des-api">
<h5><span class="section-number">14.3.1.2.1. </span>Utilisation des API<a class="headerlink" href="#utilisation-des-api" title="Lien vers cette rubrique"></a></h5>
<p>L’envoi et l’enregistrement d’un projet de versement dans le module de collecte s’effectue au moyen d’une commande de création d’un projet de versement.</p>
<p><em><strong>Point d’attention :</strong></em> la création d’un projet de versement est un prérequis à la création des transactions (ou versements).</p>
<p>Lors de la création d’un projet de versement sont envoyées :</p>
<ul class="simple">
<li><p>les métadonnées correspondant aux informations dites d’en-tête du bordereau telles que l’identifiant du message ou le contrat d’entrée ;</p></li>
<li><p>le cas échéant, les paramètres suivants :</p>
<ul>
<li><p>position de rattachement et/ou paramètres de rattachement automatisés,</p></li>
<li><p>gestion automatisée des transactions,</p></li>
<li><p>transformation des données entrantes.</p></li>
</ul>
</li>
</ul>
<p>Un projet de versement peut comporter les éléments suivants<a class="footnote-reference brackets" href="#id135" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Champ</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Name</p></td>
<td><p>Intitulé du projet de versement (champ facultatif)<a class="footnote-reference brackets" href="#id136" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>ArchivalAgreement</p></td>
<td><p>Identifiant du contrat d’entrée utilisé pour réaliser l’entrée, destiné à alimenter le champ ArchivalAgreement du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>MessageIdentifier</p></td>
<td><p>Identifiant du lot d’objets, utilisé pour identifier les versements, destiné à alimenter le champ MessageIdentifier du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>Comment</p></td>
<td><p>Précisions sur la demande de transfert destiné à alimenter le champ Comment du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>OriginatingAgencyIdentifier</p></td>
<td><p>Identifiant du service producteur, destiné à alimenter le champ OriginatingAgencyIdentifier du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>SubmissionAgencyIdentifier</p></td>
<td><p>Identifiant du service versant, destiné à alimenter le champ SubmissionAgencyIdentifier du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>ArchivalAgencyIdentifier</p></td>
<td><p>Identifiant du service d’archivage, destiné à alimenter le champ Identifier du bloc ArchivalAgency du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>TransferringAgencyIdentifier</p></td>
<td><p>Identifiant du service de transfert, destiné à alimenter le champ Identifier du bloc TransferringAgency du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>ArchivalProfile</p></td>
<td><p>Identifiant du profil d’archivage utilisé pour réaliser l’entrée, destiné à alimenter le champ ArchivalProfile du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>UnitUp</p></td>
<td><p>Identifiant de l’unité archivistique à laquelle rattacher automatiquement la ou les unité(s) racine(s) des transactions associées au projet de versement (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>UnitUps</p></td>
<td><p>Liste de conditions permettant un rattachement automatisé de l’(des) unité(s) racine(s).<br> A une métadonnée (MetadataKey) définissant une valeur spécifique (MetadataValue) peut être associée une unité archivistique de rattachement (UnitUp) (champs facultatifs).</p></td>
</tr>
<tr class="row-odd"><td><p>AcquisitionInformation</p></td>
<td><p>Modalité d’entrée.<br>  Champ destiné à alimenter le champ AcquisitionInformation du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>LegalStatus</p></td>
<td><p>Statut légal des archives, destiné à alimenter le champ LegalStatus du message ArchiveTransfer (champ facultatif). <br> Si le champ est renseigné, les valeurs attendues sont : « Public Archive », « Private Archive », « Public and Private Archive ».</p></td>
</tr>
<tr class="row-odd"><td><p>AutomaticIngest</p></td>
<td><p>Paramètre permettant d’automatiser l’envoi de transaction(s) vers la solution logicielle Vitam (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>TransformationRules</p></td>
<td><p>Paramètre permettant de lister des règles de transformation à opérer sur les données entrantes (champ facultatif).</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Point d’attention :</strong></em> Au terme de la version 8.1 :</p>
<ul class="simple">
<li><p>on ne peut pas inclure de règles de gestion dans un projet de versement ;</p></li>
<li><p>aucun contrôle n’est effectué avec les référentiels et unités archivistiques de rattachement présents dans la solution logicielle Vitam. De fait, il est fortement recommandé de :</p>
<ul>
<li><p>veiller à inclure des références (ex. service producteur, contrat d’entrée, etc.) existant dans la solution, de manière à éviter de possibles échecs lors des étapes de contrôles des données référentielles du processus d’entrée (opération « INGEST ») ;</p></li>
<li><p>ne pas envoyer dans le module de collecte des éléments sans valeurs, en particulier ceux qui sont obligatoires et doivent nécessairement être renseignés.</p></li>
</ul>
</li>
<li><p>la plupart des champs d’un projet de versement sont facultatifs. Néanmoins, il est recommandé d’indiquer un intitulé (Name) et les éléments obligatoires à la génération d’un SIP :</p>
<ul>
<li><p>le contrat d’entrée (champ ArchivalAgreement),</p></li>
<li><p>l’identifiant du message (champ MessageIdentifier),</p></li>
<li><p>le service producteur (champ OriginatingAgencyIdentifier),</p></li>
<li><p>le service d’archivage (champ Identifier du bloc ArchivalAgency),</p></li>
<li><p>le service responsable du transfert (champ Identifier du bloc TransferringAgency).</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : requête de création d’un projet de versement</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">POST</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">401</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  
  <span class="p">{</span>
   <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Versements du SG&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ArchivalAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Vitam&quot;</span><span class="p">,</span>
   <span class="s2">&quot;TransferringAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
   <span class="s2">&quot;OriginatingAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
   <span class="s2">&quot;SubmissionAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
   <span class="s2">&quot;MessageIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;20200131-000013&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ArchivalAgreement&quot;</span><span class="p">:</span><span class="s2">&quot;IC-000001&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Comment&quot;</span><span class="p">:</span> <span class="s2">&quot;SG – bureautique&quot;</span><span class="p">,</span>
   <span class="s2">&quot;UnitUp&quot;</span><span class="p">:</span> <span class="s2">&quot;aeaqaaaaaehedmpfaay5gambwxsspviaaaba&quot;</span>
  <span class="p">}</span>

</pre></div>
</div>
<p>Cette action provoque :</p>
<ul class="simple">
<li><p>la création d’un enregistrement dans la base de données MongoDB, dans la collection « Project » (base <em>Collect</em>) ;</p></li>
<li><p>l’ajout des informations suivantes, associées à cet enregistrement :</p>
<ul>
<li><p>un statut (champ « Status ») dont la valeur est égale à « OPEN »,</p></li>
<li><p>une date de création (champ « CreationDate ») dont la valeur est égale à la date de création de l’enregistrement,</p></li>
<li><p>une date de dernière modification (champ « LastUpdate ») dont la valeur est égale à la date de création de l’enregistrement.</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : enregistrement du projet de versement dans la collection « Project »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">{</span>
   <span class="n">_id</span><span class="p">:</span> <span class="s1">&#39;aeeaaaaaaghj3m7nabjocamcdqvqqviaaaaq&#39;</span><span class="p">,</span>
   <span class="n">Name</span><span class="p">:</span> <span class="s1">&#39;Versements du SG&#39;</span><span class="p">,</span>
   <span class="n">Context</span><span class="p">:</span> <span class="p">{</span>
   <span class="n">ArchivalAgreement</span><span class="p">:</span> <span class="s1">&#39;IC-000001&#39;</span><span class="p">,</span>
   <span class="n">MessageIdentifier</span><span class="p">:</span> <span class="s1">&#39;20200131-000013&#39;</span><span class="p">,</span>
   <span class="n">ArchivalAgencyIdentifier</span><span class="p">:</span> <span class="s1">&#39;Vitam&#39;</span><span class="p">,</span>
   <span class="n">TransferirngAgencyIdentifier</span><span class="p">:</span> <span class="s1">&#39;RATP&#39;</span><span class="p">,</span>
   <span class="n">OriginatingAgencyIdentifier</span><span class="p">:</span> <span class="s1">&#39;RATP&#39;</span><span class="p">,</span>
   <span class="n">SubmissionAgencyIdentifier</span><span class="p">:</span> <span class="s1">&#39;RATP&#39;</span><span class="p">,</span>
   <span class="n">Comment</span><span class="p">:</span> <span class="s1">&#39;SG - bureautique&#39;</span><span class="p">,</span>
   <span class="n">UnitUp</span><span class="p">:</span> <span class="s1">&#39;aeaqaaaaaehedmpfaay5gambwxsspviaaaba&#39;</span>
   <span class="p">},</span>
   <span class="n">CreationDate</span><span class="p">:</span> <span class="s1">&#39;2022-08-23T09:05:52.242&#39;</span><span class="p">,</span>
   <span class="n">LastUpdate</span><span class="p">:</span> <span class="s1">&#39;2022-08-23T09:05:52.242&#39;</span><span class="p">,</span>
   <span class="n">Status</span><span class="p">:</span> <span class="s1">&#39;OPEN&#39;</span><span class="p">,</span>
   <span class="n">_tenant</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Lors de cette action, non journalisée, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>Présence d’un champ inconnu dans la requête.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="utilisation-dans-vitamui">
<h5><span class="section-number">14.3.1.2.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#utilisation-dans-vitamui" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet de créer un projet de versement au moyen d’un wizard ou boîte de dialogue. Il peut s’agir d’un projet de versement pour :</p>
<ul>
<li><p>un versement manuel. Ce projet de versement donne lieu au renseignement :</p>
<ul class="simple">
<li><p>d’un possible rattachement à un nœud d’arbre de positionnement ou de plan de classement,</p></li>
<li><p>d’un possible rattachement automatique en fonction de conditions devant être respectées dans les unités racines envoyées dans le module de collecte,</p></li>
<li><p>d’informations décrivant le versement (intitulé du message, description, service producteur et service versant),</p></li>
<li><p>d’informations contextuelles (service d’archives et service responsable du transfert des archives, contrat d’entrée, profil d’archivage, modalité d’entrée, statut légal des versements).</p></li>
</ul>
<p>La création du projet dans l’APP entraîne la création d’une unique transaction.</p>
</li>
<li><p>des versements de flux automatisé. Ce projet de versements donne lieu au renseignement :</p>
<ul class="simple">
<li><p>d’un possible rattachement à un nœud d’arbre de positionnement ou de plan de classement,</p></li>
<li><p>d’un possible rattachement automatique en fonction de conditions devant être respectées dans les unités racines envoyées dans le module de collecte,</p></li>
<li><p>d’un possible envoi automatique des transactions associées au projet après leur validation,</p></li>
<li><p>d’un possible paramétrage de règles de transformations des données entrantes. Ce service passe par l’import d’un fichier au format JSLT,</p></li>
<li><p>d’informations décrivant le versement (intitulé du message, description, service producteur et service versant),</p></li>
<li><p>d’informations contextuelles (service d’archives et service responsable du transfert des archives, contrat d’entrée, profil d’archivage, modalité d’entrée, statut légal des versements).</p></li>
</ul>
<p>La création du projet de versements de flux automatisé dans l’APP n’entraîne pas la création de transaction.</p>
</li>
</ul>
<p>L’APP « Collecte et préparation des versements » permet également de :</p>
<ul class="simple">
<li><p>rechercher un projet de versement,</p></li>
<li><p>accéder à la liste des projets de versement,</p></li>
<li><p>accéder au détail d’un projet de versement en particulier,</p></li>
<li><p>modifier un projet de versement.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em> Au terme de la version 8.1 :</p>
<ul class="simple">
<li><p>l’intitulé saisi dans le wizard ou boîte de dialogue incrémente à la fois l’identifiant du message (MessageIdentifier) et l’intitulé du projet (Name) ;</p></li>
<li><p>on ne peut pas inclure de règles de gestion dans un projet de versement ;</p></li>
<li><p>aucun contrôle n’est effectué avec les référentiels présents dans la solution logicielle Vitam. De fait, il est fortement recommandé de :</p>
<ul>
<li><p>veiller à inclure des références (ex. service producteur, contrat d’entrée, etc.) existant dans le tenant (coffre), de manière à éviter de possibles échecs lors des étapes de contrôles des données référentielles du processus d’entrée (opération « INGEST ») ;</p></li>
<li><p>ne pas envoyer dans le module de collecte des éléments sans valeurs, en particulier ceux qui sont obligatoires et doivent nécessairement être renseignés.</p></li>
</ul>
</li>
<li><p>il n’est pas possible de modifier les paramétrages liés au rattachement automatique ou via conditions depuis les interfaces. De fait, il est recommandé de veiller à ne pas faire d’erreurs lors de la saisie des informations.</p></li>
<li><p>Au terme de la version 8.1, le paramétrage permettant de définir des règles de transformation n’est pas accessible depuis les interfaces. De fait, il est recommandé de veiller à ne pas faire d’erreurs lors de la saisie des informations.</p></li>
</ul>
</section>
</section>
<section id="acces">
<h4><span class="section-number">14.3.1.3. </span>Accès<a class="headerlink" href="#acces" title="Lien vers cette rubrique"></a></h4>
<section id="id3">
<h5><span class="section-number">14.3.1.3.1. </span>Utilisation des API<a class="headerlink" href="#id3" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet de :</p>
<ul class="simple">
<li><p>accéder à la liste des projets de versement créés sur un tenant donné ;</p></li>
<li><p>consulter les informations d’un projet en particulier sur un tenant donné ;</p></li>
<li><p>rechercher un à plusieurs projets de versement par rapport à certains critères (recherche approchante) :</p>
<ul>
<li><p>un intitulé,</p></li>
<li><p>un identifiant du message,</p></li>
<li><p>un service producteur ;</p></li>
</ul>
</li>
<li><p>rechercher les projets de versement d’un service producteur en particulier.</p></li>
</ul>
<p><em>Exemple : requête en vue d’obtenir l’ensemble des projets de versement disponibles sur un tenant donné</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
</pre></div>
</div>
<p><em>Exemple : requête en vue d’obtenir les informations relatives à un projet donné dont l’identifiant est « aeeaaaaaaghpmborabjyyambxjekiyyaaaaq »</em>* *<em>sur un tenant donné.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@project</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">**</span><span class="n">aeeaaaaaaghpmborabjyyambxjekiyyaaaaq</span><span class="o">**</span>
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="p">{{</span><span class="n">project</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
</pre></div>
</div>
<p><em>Exemple : requête en vue d’obtenir les projets de versement dont l’intitulé et/ou le service producteur contient le terme « Versement » sur un tenant donné.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">143</span>
  
  <span class="p">{</span>
   <span class="s2">&quot;$query&quot;</span><span class="p">:</span><span class="s2">&quot;Versement&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p><em>Exemple : requête en vue d’obtenir les projets de versement dont le service producteur est égal à « Vitam » sur un tenant donné.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="o">-</span><span class="n">collect</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">143</span>

 <span class="p">{</span>
   <span class="s2">&quot;originatingAgencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Vitam&quot;</span><span class="p">]</span>
 <span class="p">}</span>
</pre></div>
</div>
<p><em><strong>Point d’attention :</strong></em>
En résultats, la solution logicielle renvoie systématiquement l’ensemble des métadonnées relatives au(x) projet(s) de versement. Au terme de la version 8.1, il n’est pas possible de récupérer une sélection de métadonnées.</p>
</section>
<section id="id4">
<h5><span class="section-number">14.3.1.3.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id4" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet d’accéder à la liste des projets de versement préalablement créés et de les rechercher au moyen de :</p>
<ul class="simple">
<li><p>leur intitulé (champ MessageIdentifier),</p></li>
<li><p>leur service versant (champ SubmissionAgencyIdentifier).</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em>
La recherche est approchante.</p>
<p><em>Exemple : champ de recherche dans l’APP « Collecte et préparation des versements »</em></p>
<p><img alt="" src="../_images/ListeProjets.png" /></p>
<p>Par ailleurs, pour un projet donné, il est possible de :</p>
<ul class="simple">
<li><p>consulter son détail ;</p></li>
<li><p>consulter les transactions associées ;</p></li>
<li><p>consulter les archives associées.</p></li>
</ul>
<p>L’accès aux projets de versement peut être restreint via l’utilisation d’un contrat d’accès. Ainsi, un utilisateur du front-office VitamUI devant accéder aux projets de versement
d’un service en particulier pourra ne voir que ceux-là si son profil utilisateur est associé à un contrat d’accès lui permettant d’accéder uniquement aux archives de ce service.</p>
<p><em><strong>Point d’attention :</strong></em>
Au terme de la version 8.1, ce filtre n’est disponible que depuis le front-office VitamUI.</p>
</section>
</section>
<section id="modification-d-un-projet-de-versement">
<h4><span class="section-number">14.3.1.4. </span>Modification d’un projet de versement<a class="headerlink" href="#modification-d-un-projet-de-versement" title="Lien vers cette rubrique"></a></h4>
<section id="id5">
<h5><span class="section-number">14.3.1.4.1. </span>Utilisation des API<a class="headerlink" href="#id5" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet de modifier un projet de versement, et plus précisément de :</p>
<ul class="simple">
<li><p>modifier ses métadonnées,</p></li>
<li><p>lui ajouter des métadonnées,</p></li>
<li><p>supprimer des métadonnées.</p></li>
</ul>
<p><em>Exemple : requête en vue de modifier des métadonnées d’un projet de versement dont l’identifiant est « aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">PUT</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">401</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  
  <span class="p">{</span>
    <span class="s2">&quot;#id&quot;</span><span class="p">:</span> <span class="s2">&quot;**aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq**&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ArchivalAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Vitam&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TransferringAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;OriginatingAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SubmissionAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;20200131-000006&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ArchivalAgreement&quot;</span><span class="p">:</span><span class="s2">&quot;IC-000001&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Bulletins de salaire - Janvier 2020&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>Le service de mise à jour d’un projet de versement fonctionne en mode « annule et remplace ».</p></li>
<li><p>La plupart des champs d’une transaction étant facultatifs, il est recommandé d’indiquer les éléments obligatoires à la génération d’un SIP :</p>
<ul>
<li><p>le contrat d’entrée (champ « ArchivalAgreement »),</p></li>
<li><p>l’identifiant du message (champ « MessageIdentifier),</p></li>
<li><p>le service producteur (champ « OriginatingAgencyIdentifier »),</p></li>
<li><p>le service d’archivage (champ « ArchivalAgencyIdentifier »),</p></li>
<li><p>le service responsable du transfert (« TransferringAgencyIdentifier »)</p></li>
</ul>
</li>
<li><p>Au terme de la version 8.1 :</p>
<ul>
<li><p>le module de collecte permet de modifier un rattachement ainsi que les conditions de rattachement. Néanmoins, il n’est pas recommandé de les modifier si une transaction contenant des archives a été créée, car la modification n’est pas répercutée dans cette transaction ;</p></li>
<li><p>ce service ne vérifie pas le caractère obligatoire d’un champ. Il est fortement recommandé de veiller à ne pas supprimer un champ obligatoire, de manière à éviter de possibles échecs lors des étapes de contrôles des données référentielles du processus d’entrée (opération « INGEST ») ;</p></li>
<li><p>on ne peut pas ajouter de règles de gestion dans un projet de versement ;</p></li>
<li><p>aucun contrôle n’est effectué avec les référentiels et unités archivistiques de rattachement présents dans la solution logicielle Vitam. De fait, il est fortement recommandé de :</p>
<ul>
<li><p>veiller à inclure des références (ex. service producteur, contrat d’entrée, etc.) existant dans la solution, de manière à éviter de possibles échecs lors des étapes de contrôles des données référentielles du processus d’entrée (opération « INGEST ») ;</p></li>
<li><p>ne pas envoyer dans le module de collecte des éléments sans valeurs, en particulier ceux qui sont obligatoires et doivent nécessairement être renseignés.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Cette action, non journalisée, provoque la mise à jour du projet.</p>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>Présence d’un champ inconnu dans la requête. <br>Le projet n’existe pas.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id6">
<h5><span class="section-number">14.3.1.4.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id6" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet de modifier un projet de versement, avec, le cas échéant, la(les) transaction(s) associée(s) si elle(s) a(ont) un statut égal à « OPEN ».</p>
<p><em><strong>Point d’attention :</strong></em>
Au terme de la version 8.1, il n’est pas possible, depuis les interfaces, de modifier :</p>
<ul class="simple">
<li><p>les paramètres de rattachement ;</p></li>
<li><p>les conditions de rattachement ;</p></li>
<li><p>la gestion automatique des transactions ;</p></li>
<li><p>les règles de transformation.</p></li>
</ul>
</section>
</section>
<section id="suppression-d-un-projet-de-versement">
<h4><span class="section-number">14.3.1.5. </span>Suppression d’un projet de versement<a class="headerlink" href="#suppression-d-un-projet-de-versement" title="Lien vers cette rubrique"></a></h4>
<section id="id7">
<h5><span class="section-number">14.3.1.5.1. </span>Utilisation des API<a class="headerlink" href="#id7" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet de supprimer un projet de versement.</p>
<p><em><strong>Point d’attention :</strong></em> En prérequis à cette action, il faut avoir au préalable créé un projet de versement et le signaler dans l’API, pour une suppression de projet.</p>
<p><em>Exemple : requête en vue de supprimer un projet de versement dont l’identifiant est «  aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@project</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span><span class="o">*</span>
  
  <span class="n">DELETE</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="p">{{</span><span class="n">project</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
</pre></div>
</div>
<p>Cette action provoque la suppression de l’enregistrement dans la base de données MongoDB, dans la collection « Project » (base <em>Collect</em>).
Si le projet de versement est associé à une transaction qui, elle-même contient des archives (unités archivistiques, objets techniques), l’ensemble des archives sont supprimées de la base de données et des offres de stockage :</p>
<ul class="simple">
<li><p>les unités archivistiques sont supprimées de la collection « Unit » (base <em>MetadataCollect</em>) ;</p></li>
<li><p>les groupes d’objets techniques sont supprimées de la collection « ObjectGroup » (base <em>MetadataCollect</em>).</p></li>
<li><p>les objets sont supprimés des offres de stockage.</p></li>
</ul>
<p>Lors de cette action, non journalisée, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>Le projet n’existe pas.<br>Le projet n’est pas reconnu dans la requête.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id8">
<h5><span class="section-number">14.3.1.5.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id8" title="Lien vers cette rubrique"></a></h5>
<p>Au terme de la version 8.1, il n’est pas possible de supprimer un projet de versement depuis l’APP « Collecte et préparation des versements » du front-office VitamUI.</p>
</section>
</section>
</section>
<section id="versement">
<h3><span class="section-number">14.3.2. </span>Versement<a class="headerlink" href="#versement" title="Lien vers cette rubrique"></a></h3>
<section id="id9">
<h4><span class="section-number">14.3.2.1. </span>Définitions<a class="headerlink" href="#id9" title="Lien vers cette rubrique"></a></h4>
<p>Dans la solution logicielle Vitam, il est possible de préparer le versement d’un SIP conforme au Standard d’échanges des données pour l’archivage (SEDA) au moyen du module de collecte.</p>
<p>Ce module est propre à chaque tenant de la solution logicielle Vitam.</p>
<p>Il permet de recevoir dans un espace de stockage et des bases de données dédiés :</p>
<ul class="simple">
<li><p>sous forme d’enregistrements JSON les informations relatives à :</p>
<ul>
<li><p>des métadonnées correspondant à l’en-tête du message ArchiveTransfer (Base <em>Collect</em>, Collection « Transaction »),</p></li>
<li><p>des métadonnées descriptives et de gestion associées à des unités archivistiques (Base <em>MetadataCollect</em>, Collection « Unit »),</p></li>
<li><p>le cas échéant, des métadonnées techniques (Base <em>MetadataCollect</em>, Collection « ObjectGroup »),</p></li>
</ul>
</li>
<li><p>les objets associés.</p></li>
</ul>
<p>À l’étape d’ajout des objets, la solution logicielle Vitam réalise une mise à jour des métadonnées techniques, qui inclut :</p>
<ul class="simple">
<li><p>un calcul d’empreinte de l’objet,</p></li>
<li><p>un calcul du poids de l’objet (exprimé en octets),</p></li>
<li><p>une identification de format.</p></li>
</ul>
<p>L’envoi des métadonnées et des objets peut s’effectuer de deux manières :</p>
<ul class="simple">
<li><p>en mode « unitaire » : pour chaque type de métadonnées et pour chaque objet à collecter, le module de collecte reçoit une requête d’envoi ;</p></li>
<li><p>en mode « lot » : pour un ensemble d’unités archivistiques et d’objets, le module de collecte reçoit une unique requête lui faisant parvenir l’ensemble.</p></li>
</ul>
<p><img alt="" src="../_images/ImportsUnitairesOuLots.png" /></p>
<p>Les fonctionnalités ont été conçues et réalisées de manière à prendre en compte :</p>
<ul class="simple">
<li><p>1 à n unités archivistiques pour une transaction, correspondant à un ensemble de métadonnées d’en-tête,</p></li>
<li><p>0 à n parents pour les unités archivistiques,</p></li>
<li><p>1 groupe d’objets techniques par unité archivistique,</p></li>
<li><p>1 objet binaire pour une version d’usage de l’objet pour un groupe d’objets techniques donné.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em> Le versement des métadonnées et des objets dans le module de collecte n’est pas journalisé dans le journal des opérations.</p>
</section>
<section id="creation-d-une-transaction">
<h4><span class="section-number">14.3.2.2. </span>Création d’une transaction<a class="headerlink" href="#creation-d-une-transaction" title="Lien vers cette rubrique"></a></h4>
<section id="id10">
<h5><span class="section-number">14.3.2.2.1. </span>Utilisation des API<a class="headerlink" href="#id10" title="Lien vers cette rubrique"></a></h5>
<p>À un projet de versement peu(ven)t être associée(s) 1 à n transaction(s) (ou versement(s)).</p>
<p>Dans la transaction sont :</p>
<ul class="simple">
<li><p>héritées des métadonnées correspondant aux informations dites d’en-tête préalablement définies dans le projet de versement, si elles ne sont pas définies dans la transaction ;</p></li>
<li><p>envoyées les métadonnées correspondant aux informations dites d’en-tête du bordereau telles que l’identifiant du message, qui sont spécifiques à la transaction.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à la création d’une transaction, il faut avoir au préalable créé un projet de versement et le signaler dans l’API.</p></li>
<li><p>La création d’une transaction est un prérequis à l’ajout d’archives en mode « unitaire » ou en mode « lot ».</p></li>
</ul>
<p>La transaction peut comporter les éléments suivants<a class="footnote-reference brackets" href="#id137" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Champ</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Name</p></td>
<td><p>Intitulé de la transaction (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>ArchivalAgreement</p></td>
<td><p>Identifiant du contrat d’entrée utilisé pour réaliser l’entrée, destiné à alimenter le champ ArchivalAgreement du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>MessageIdentifier</p></td>
<td><p>Identifiant du lot d’objets, utilisé pour identifier les versements, destiné à alimenter le champ MessageIdentifier du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>Comment</p></td>
<td><p>Précisions sur la demande de transfert, destinées à alimenter le champ Comment du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>OriginatingAgencyIdentifier</p></td>
<td><p>Identifiant du service producteur, destiné à alimenter le champ OriginatingAgencyIdentifier du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>SubmissionAgencyIdentifier</p></td>
<td><p>Identifiant du service versant, destiné à alimenter le champ SubmissionAgencyIdentifier du message ArchiveTransfer (champ facultatif). <br>S’il est absent ou vide à l’initialisation de la transaction, alors la valeur contenue dans le champ OriginatingAgencyIdentifier est reportée dans ce champ.</p></td>
</tr>
<tr class="row-even"><td><p>ArchivalAgencyIdentifier</p></td>
<td><p>Identifiant du service d’archivage, destiné à alimenter le champ ArchivalAgencyIdentifier du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>TransferringAgencyIdentifier</p></td>
<td><p>Identifiant du service de transfert, destiné à alimenter le champ TransferringAgencyIdentifier du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>ArchivalProfile</p></td>
<td><p>Identifiant du profil d’archivage utilisé pour réaliser l’entrée, destiné à alimenter le champ ArchivalProfile du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-odd"><td><p>AcquisitionInformation</p></td>
<td><p>Modalité d’entrée. <br>Champ destiné à alimenter le champ AcquisitionInformation du message ArchiveTransfer (champ facultatif).</p></td>
</tr>
<tr class="row-even"><td><p>LegalStatus</p></td>
<td><p>Statut légal des archives, destiné à alimenter le champ LegalStatus du message ArchiveTransfer (champ facultatif).<br>Si le champ est renseigné, les valeurs attendues sont : « Public Archive », « Private Archive » ou « Public and Private Archive ».</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Point d’attention :</strong></em> Au terme de la version 8.1 :</p>
<ul class="simple">
<li><p>on ne peut pas inclure de règles de gestion dans la partie transactionnelle ;</p></li>
<li><p>aucun contrôle n’est effectué avec les référentiels et unités archivistiques de rattachement présents dans la solution logicielle Vitam. De fait, il est fortement recommandé de :</p>
<ul>
<li><p>veiller à inclure des références (ex. service producteur, contrat d’entrée, etc.) existant dans la solution, de manière à éviter de possibles échecs lors des étapes de contrôles des données référentielles du processus d’entrée (opération « INGEST ») ;</p></li>
<li><p>ne pas envoyer dans le module de collecte des éléments sans valeurs, en particulier ceux qui sont obligatoires et doivent nécessairement être renseignés ;</p></li>
<li><p>renseigner les valeurs attendues par le SEDA pour le statut légal des archives, à savoir : « Public Archive », « PrivateArchive » ou « Public and Private Archive ».</p></li>
</ul>
</li>
<li><p>la plupart des champs d’une transaction sont facultatifs. Néanmoins, il est recommandé d’indiquer les éléments obligatoires à la génération d’un SIP, soit dans le projet de versement, soit dans la transaction :</p>
<ul>
<li><p>le contrat d’entrée (champ « ArchivalAgreement »),</p></li>
<li><p>l’identifiant du message (champ « MessageIdentifier),</p></li>
<li><p>le service producteur (champ « OriginatingAgencyIdentifier »),</p></li>
<li><p>le service d’archivage (champ « ArchivalAgencyIdentifier »),</p></li>
<li><p>le service responsable du transfert (« TransferringAgencyIdentifier »)</p></li>
</ul>
</li>
<li><p>s’ils ne sont pas renseignés dans la transaction, les champs suivants peuvent être hérités du projet de versement s’ils y ont été renseignés :</p>
<ul>
<li><p>le contrat d’entrée (champ « ArchivalAgreement »),</p></li>
<li><p>l’identifiant du message (champ « MessageIdentifier »),</p></li>
<li><p>les précisions sur la demande de transfert (« Comment »),</p></li>
<li><p>le service producteur (champ « OriginatingAgencyIdentifier »),</p></li>
<li><p>le service versant (champ « SubmissionAgencyIdentifier »),</p></li>
<li><p>le service d’archivage (champ « ArchivalAgencyIdentifier »),</p></li>
<li><p>le service responsable du transfert (« TransferringAgencyIdentifier »),</p></li>
<li><p>le profil d’archivage (« ArchivalProfile »),</p></li>
<li><p>le statut légal des archives (« LegalStatus »),</p></li>
<li><p>les modalités d’entrée (« AcquisitionInformation »).</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : requête de création d’une transaction pour le projet de versement préalablement créé dont l’identifiant est aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@project</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">**</span><span class="n">aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq</span><span class="o">**</span>
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">POST</span>  <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="p">{{</span><span class="n">project</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">transactions</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  
  <span class="p">{</span>
    <span class="s2">&quot;ArchivalAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Vitam&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TransferringAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;AN&quot;</span><span class="p">,</span>
    <span class="s2">&quot;OriginatingAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SubmissionAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;20220302-000005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ArchivalAgreement&quot;</span><span class="p">:</span><span class="s2">&quot;IC-000001&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Archives bureautiques du cabinet de Michel Mercier&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Cette action provoque la création d’un enregistrement dans la base de données MongoDB, dans la collection « Transaction » (base <em>Collect</em>).</p>
<p>À cet enregistrement, est associé :</p>
<ul class="simple">
<li><p>un statut (champ « Status ») dont la valeur est égale à « OPEN »,</p></li>
<li><p>l’identifiant du projet de versement à l’origine de la création de la transaction (champ « ProjectId »),</p></li>
<li><p>une date de création (champ « CreationDate ») dont la valeur est égale à la date de création de l’enregistrement,</p></li>
<li><p>une date de dernière modification (champ « LastUpdate ») dont la valeur est égale à la date de création de l’enregistrement.</p></li>
</ul>
<p><em>Exemple : enregistrement de la transaction dans la collection « Transaction »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaacecwapyabsgsamwiiin6eaaaaaq&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Name: &quot;</span><span class="n">Archives</span> <span class="n">bureautiques</span> <span class="n">du</span> <span class="n">cabinet</span> <span class="n">de</span> <span class="n">Michel</span> <span class="n">Mercier</span><span class="s2">&quot;,</span>
    <span class="s2">&quot;Context: {</span>
        <span class="s2">&quot;AcquisitionInformation&quot;</span><span class="p">:</span> <span class="s2">&quot;Versement&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LegalStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;Private Archive&quot;</span><span class="p">,</span>
		<span class="s2">&quot;ArchivalAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Vitam&quot;</span><span class="p">,</span>
    	<span class="s2">&quot;TransferringAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;AN&quot;</span><span class="p">,</span>
    	<span class="s2">&quot;OriginatingAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
    	<span class="s2">&quot;SubmissionAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
    	<span class="s2">&quot;MessageIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;20220302-000005&quot;</span><span class="p">,</span>
    	<span class="s2">&quot;ArchivalAgreement&quot;</span><span class="p">:</span><span class="s2">&quot;IC-000001&quot;</span><span class="p">,</span>
    	<span class="s2">&quot;Comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Archives bureautiques du cabinet de Michel Mercier&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="s2">&quot;OPEN&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CreationDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-17T04:45:24.115&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LastUpdate&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-17T04:45:24.296&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ProjectId&quot;</span><span class="p">:</span> <span class="s2">&quot;aeaaaaaaaaecwapyabsgsamwiiin35iaaaaq&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_tenant&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;_v&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Présence d’un champ inconnu dans la requête.<br> - Le projet associé à la transaction n’existe pas.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id12">
<h5><span class="section-number">14.3.2.2.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id12" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam ne permet pas à l’utilisateur de créer une transaction.</p>
<p>Néanmoins, La création d’un projet de versement manuel entraîne la création d’une unique transaction qui hérite des informations saisies dans le projet :</p>
<ul class="simple">
<li><p>description du versement (intitulé du message, description, service producteur et service versant),</p></li>
<li><p>contexte du versement (service d’archives et service responsable du transfert des archives, contrat d’entrée, profil d’archivage, modalité d’entrée, statut légal des versements).</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em> La création du projet de versement de flux automatisé dans l’APP n’entraîne pas la création de transaction.</p>
</section>
</section>
<section id="alimentation-d-une-transaction-en-mode-unitaire">
<h4><span class="section-number">14.3.2.3. </span>Alimentation d’une transaction en mode « unitaire »<a class="headerlink" href="#alimentation-d-une-transaction-en-mode-unitaire" title="Lien vers cette rubrique"></a></h4>
<p>L’envoi et l’enregistrement des archives dans le module de collecte s’effectue au moyen de trois commandes distinctes :</p>
<ul class="simple">
<li><p>création unitaire des unités archivistiques,</p></li>
<li><p>création unitaire des groupes d’objets techniques,</p></li>
<li><p>ajout des objets.</p></li>
</ul>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à la création d’une unité archivistique, il faut avoir au préalable créé une transaction et le signaler dans l’API.</p></li>
<li><p>L’ordre d’utilisation des API doit être respecté en vue d’enregistrer avec succès l’ensemble des métadonnées et objets constituant un versement (ou transaction).</p></li>
</ul>
<section id="envoi-dunites-archivistiques">
<h5><span class="section-number">14.3.2.3.1. </span>Envoi d’unités archivistiques<a class="headerlink" href="#envoi-dunites-archivistiques" title="Lien vers cette rubrique"></a></h5>
<section id="id13">
<h6><span class="section-number">14.3.2.3.1.1. </span>Utilisation des API<a class="headerlink" href="#id13" title="Lien vers cette rubrique"></a></h6>
<p>À une transaction peu(ven)t être associée(s) 1 à n unité(s) archivistique(s).</p>
<p>Chaque unité archivistique :</p>
<ul class="simple">
<li><p>doit définir un titre (Title) et un niveau de description (DescriptionLevel), qui sont des éléments rendus obligatoires en entrée de la solution logicielle Vitam ;</p></li>
<li><p>peut inclure :</p>
<ul>
<li><p>des règles de gestion ;</p></li>
<li><p>des métadonnées descriptives supplémentaires ;</p></li>
<li><p>un lien vers une unité archivistique de niveau supérieur.</p></li>
</ul>
</li>
</ul>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à la création d’une unité archivistique, il faut avoir au préalable créé une transaction et la signaler dans l’API. En outre, la transaction associée doit avoir un statut « OPEN »<a class="footnote-reference brackets" href="#id138" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a> ;</p></li>
<li><p>Au terme de la version 8.1, aucun contrôle n’est effectué avec les référentiels présents dans la solution logicielle Vitam. De fait, il est fortement recommandé de veiller à :</p>
<ul>
<li><p>inclure les métadonnées obligatoires attendues par la solution logicielle Vitam, à savoir un titre (Title) et un niveau de description (DescriptionLevel) ;</p></li>
<li><p>inclure des règles de gestion existant dans la solution, de manière à éviter de possibles échecs lors des étapes de contrôles des données référentielles du processus d’entrée (opération « INGEST ») ;</p></li>
<li><p>veiller au bon nommage des éléments (ou vocabulaires internes), tout en respectant leurs caractéristiques (s’il s’agit d’une chaîne de caractères, d’une date, etc.), et à leur insertion dans l’ontologie, s’il s’agit de vocabulaires externes ;</p></li>
<li><p>ne pas envoyer dans le module de collecte des éléments sans valeurs, en particulier ceux qui sont obligatoires et doivent nécessairement être renseignés.</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : requête de création d’une unité archivistique pour la transaction préalablement créée dont l’identifiant est aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">**</span><span class="n">aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq</span><span class="o">**</span>
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">POST</span>  <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">units</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">ContratTNR</span>
  
  <span class="p">{</span>
      <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;RecordGrp&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours du ministre&quot;</span><span class="p">,</span>
      <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                      <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00001&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2000-01-01&quot;</span>
                  <span class="p">}</span>
              <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>L’élément <strong>#management</strong> doit <strong>toujours</strong> être présent dans la requête, même si aucune règle de gestion n’est définie pour une unité archivistique donnée ;</p></li>
</ul>
<p><em>Exemple : requête de création d’une unité archivistique qui ne définit pas de règle de gestion.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">POST</span>  <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">units</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">ContratTNR</span>
  <span class="p">{</span>
      <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;RecordGrp&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours de Michel Mercier&quot;</span><span class="p">,</span>
      <span class="o">**</span><span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="p">}</span><span class="o">**</span>
  <span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Pour <strong>associer une unité archivistique à une autre unité archivistique</strong>, de niveau supérieur, il est recommandé de :</p>
<ul>
<li><p>créer en premier lieu l’unité archivistique de niveau supérieur et de récupérer son identifiant technique,</p></li>
<li><p>ajouter parmi les métadonnées de l’unité archivistique de niveau inférieur le paramètre #unitups avec pour valeur l’identifiant de(s) unité(s) archivistique(s) de niveau supérieur.</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : requête de création d’une unité archivistique incluant un rattachement à une unité archivistique de niveau supérieur.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">POST</span>  <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">units</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">ContratTNR</span>
  
  <span class="p">{</span>
      <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours prononcé à l&#39;occasion de l&#39;audition devant la commission des lois relative à la proposition de loi constitutionnelle relative à la fonction de représentation par le Sénat des collectivités locales&quot;</span><span class="p">,</span>
      <span class="s2">&quot;TransactedDate&quot;</span><span class="p">:</span><span class="s2">&quot;2010-12-08&quot;</span><span class="p">,</span>
      <span class="o">**</span><span class="s2">&quot;#unitups&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;aeeaaaaaaghiyso4ablmyal74smvqcqaaaaq&quot;</span><span class="p">]</span><span class="o">**</span><span class="p">,</span>
      <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Cette action provoque la création d’un enregistrement dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect</em>)<a class="footnote-reference brackets" href="#id139" id="id15" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.
À cet enregistrement, sont associés :</p>
<ul class="simple">
<li><p>l’identifiant de la transaction (_opi),</p></li>
<li><p>l’identifiant du service producteur (_sp et _sps).</p></li>
</ul>
<p>Le cas échéant, l’action provoque également :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- si le projet de versement déclarait un rattachement unique, la création d&#39;une unité archivistique dans la base de données MongoDB, dans la collection « Unit » (base *MetadataCollect[^10]*). Sont enregistrés automatiquement :
  -   un niveau de description (DescriptionLevel) dont la valeur est « Series »,
  -   un intitulé (Title) dont la valeur est « STATIC_ATTACHEMENT »,
  -   l&#39;identifiant de l&#39;unité archivistique de rattachement (champ SystemId inclus dans un bloc UpdateOperation);
- si le projet de versement déclarait un rattachement par clé / valeur, la création d&#39;une unité archivistique dans la base de données MongoDB, dans la collection « Unit » (base *MetadataCollect[^10]*). Sont enregistrés automatiquement :
  -   un niveau de description (DescriptionLevel) dont la valeur est « Series »,
  -   un intitulé (Title) dont la valeur est « DYNAMIC_ATTACHEMENT »,
  -   l&#39;identifiant de l&#39;unité archivistique de rattachement (champ SystemId inclus dans un bloc UpdateOperation).
</pre></div>
</div>
<p><em>Exemple : enregistrement d’une unité archivistique dans la collection « Unit » de la base « MetadataCollect ».</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxvoaoiaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;RecordGrp&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours du ministre&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_mgt&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span>
   <span class="p">{</span>
   <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00001&quot;</span><span class="p">,</span>
   <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2000-01-01&quot;</span>
   <span class="p">}</span>
   <span class="p">]</span>
   <span class="p">}</span>
   <span class="p">},</span>
   <span class="s2">&quot;_opi&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxnhd6aaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_unitType&quot;</span><span class="p">:</span> <span class="s2">&quot;INGEST&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_up&quot;</span><span class="p">:</span> <span class="p">[],</span>
   <span class="s2">&quot;_us&quot;</span><span class="p">:</span> <span class="p">[],</span>
   <span class="s2">&quot;_graph&quot;</span><span class="p">:</span> <span class="p">[],</span>
   <span class="s2">&quot;_sps&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">],</span>
   <span class="s2">&quot;_sp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">],</span>
   <span class="s2">&quot;_uds&quot;</span><span class="p">:</span> <span class="p">{},</span>
   <span class="s2">&quot;_min&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;_max&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;_glpd&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-06-04T08:52:56.689&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_acd&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-06-04T08:52:56.689&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_aud&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-06-04T08:52:56.689&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_v&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
   <span class="s2">&quot;_av&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
   <span class="s2">&quot;_tenant&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- L’unité archivistique n’a pas été associée à une transaction ; <br>- La transaction associée à l’unité archivistique n’existe pas ; <br> - La transaction associée à l’unité archivistique a été clôturée; <br> - L’unité archivistique n’est pas conforme au profil d’unité archivistique qu’elle déclare.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id16">
<h6><span class="section-number">14.3.2.3.1.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id16" title="Lien vers cette rubrique"></a></h6>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam ne permet pas à l’utilisateur d’utiliser ce mode pour alimenter une transaction.</p>
</section>
</section>
<section id="envoi-des-metadonnees-techniques">
<h5><span class="section-number">14.3.2.3.2. </span>Envoi des métadonnées techniques<a class="headerlink" href="#envoi-des-metadonnees-techniques" title="Lien vers cette rubrique"></a></h5>
<section id="id17">
<h6><span class="section-number">14.3.2.3.2.1. </span>Utilisation des API<a class="headerlink" href="#id17" title="Lien vers cette rubrique"></a></h6>
<p>À une unité archivistique donnée peut être associé un groupe d’objets techniques, dans lequel on peut ajouter unitairement une version d’objet d’un usage particulier.</p>
<p>Il est possible d’associer plusieurs usages à un groupe d’objets techniques :</p>
<ul class="simple">
<li><p>original numérique (BinaryMaster),</p></li>
<li><p>original physique (PhysicalMaster),</p></li>
<li><p>copie numérique (Dissemination),</p></li>
<li><p>vignette (Thumbnail),</p></li>
<li><p>texte brut (TextContent).</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à la création de métadonnées techniques, il faut avoir au préalable créé :</p>
<ul>
<li><p>une transaction et la signaler dans l’API. En outre, la transaction associée doit avoir un statut « OPEN »<a class="footnote-reference brackets" href="#id140" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a> ;</p></li>
<li><p>une unité archivistique et la signaler dans l’API.</p></li>
</ul>
</li>
<li><p>À cette étape, il n’est pas nécessaire d’envoyer les métadonnées correspondant à l’empreinte d’un fichier numérique, à l’identification de son format ou à son poids, dans la mesure où ce type de métadonnées est calculé lors de l’envoi du fichier numérique dans le module de collecte ;</p></li>
<li><p>Au terme de la version 8.1, il n’est pas possible de modifier les informations envoyées dans le module de collecte. De fait, il est fortement recommandé de veiller au bon nommage des éléments (ou vocabulaires internes), tout en respectant leurs caractéristiques (s’il s’agit d’une chaîne de caractères, d’une date, etc.), et à leur insertion dans l’ontologie, s’il s’agit de vocabulaires externes.</p></li>
<li><p>Par ailleurs, certains contrôles, disponibles au moment du transfert dans la solution logicielle Vitam n’ont pas été implémentés. Il est fortement recommandé de ne créer dans le module de collecte que des versions initiales d’objet numérique pour un usage donné.</p></li>
</ul>
<p><em>Exemple : requête d’association d’un groupe d’objets techniques, et plus exactement une version initiale d’un original numérique, à une unité archivistique dont l’identifiant est aeeaaaaaaghiyso4ablmyal74sndwiqaaaaq.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="n">aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq</span>
  <span class="nd">@unit</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">**</span><span class="n">aeeaaaaaaghiyso4ablmyal74sndwiqaaaaq</span><span class="o">**</span>
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">POST</span>  <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">units</span><span class="o">/</span><span class="p">{{</span><span class="n">unit</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">objects</span><span class="o">/**</span><span class="n">BinaryMaster</span><span class="o">/</span><span class="mi">1</span><span class="o">**</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">ContratTNR</span>
  
  <span class="p">{</span>
    <span class="s2">&quot;FileInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;Filename&quot;</span><span class="p">:</span> <span class="s2">&quot;Test01.jpeg&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Cette action provoque la création d’un enregistrement dans la base de données MongoDB, dans la collection « ObjectGroup » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id141" id="id19" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a></em>).
À cet enregistrement, sont associés :</p>
<ul class="simple">
<li><p>l’identifiant de la transaction (_opi),</p></li>
<li><p>l’identifiant du service producteur (_sp).</p></li>
</ul>
<p><em>Exemple : enregistrement des métadonnées techniques dans la collection « ObjectGroup » de la base « MetadataCollect ».</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxzdbviaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_tenant&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;FileInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;Filename&quot;</span><span class="p">:</span> <span class="s2">&quot;Test01.jpeg&quot;</span>
   <span class="p">},</span>
   <span class="s2">&quot;_nbc&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="s2">&quot;_opi&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxnhd6aaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_sp&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_qualifiers&quot;</span><span class="p">:</span> <span class="p">[</span>
   <span class="p">{</span>
   <span class="s2">&quot;qualifier&quot;</span><span class="p">:</span> <span class="s2">&quot;BinaryMaster&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_nbc&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;versions&quot;</span><span class="p">:</span> <span class="p">[</span>
   <span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxzdbvyaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;DataObjectVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;BinaryMaster_1&quot;</span><span class="p">,</span>
   <span class="s2">&quot;FileInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;Filename&quot;</span><span class="p">:</span> <span class="s2">&quot;Test01.jpeg&quot;</span>
   <span class="p">},</span>
   <span class="s2">&quot;Size&quot;</span><span class="p">:</span> <span class="mi">0</span>
   <span class="p">}</span>
   <span class="p">]</span>
   <span class="p">}</span>
   <span class="p">],</span>
   <span class="s2">&quot;_v&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;_av&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;_acd&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-02T12:01:34.629&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_aud&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-02T12:01:34.629&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- L’ unité archivistique n’existe pas ou est erronée ; <br>- L’objet technique n’a pas été associé à une unité archivistique ; <br>- La requête renvoie une deuxième fois une demande de création d’un usage d’objet ayant déjà été versé dans le module de collecte ;<br> - La transaction associée a été clôturée.<br></p></td>
</tr>
</tbody>
</table>
</section>
<section id="id20">
<h6><span class="section-number">14.3.2.3.2.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id20" title="Lien vers cette rubrique"></a></h6>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam ne permet pas à l’utilisateur d’utiliser ce mode pour alimenter une transaction.</p>
</section>
</section>
<section id="envoi-des-objets">
<h5><span class="section-number">14.3.2.3.3. </span>Envoi des objets<a class="headerlink" href="#envoi-des-objets" title="Lien vers cette rubrique"></a></h5>
<section id="id21">
<h6><span class="section-number">14.3.2.3.3.1. </span>Utilisation des API<a class="headerlink" href="#id21" title="Lien vers cette rubrique"></a></h6>
<p>À une unité archivistique associée à un groupe d’objets techniques et pour un usage et une version d’objet donné, on peut ajouter unitairement un objet numérique.</p>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à l’envoi d’un objet, il faut avoir au préalable créé :</p>
<ul>
<li><p>une transaction et la signaler dans l’API. En outre, la transaction associée doit avoir un statut « OPEN »<a class="footnote-reference brackets" href="#id142" id="id22" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a> ;</p></li>
<li><p>une unité archivistique et la signaler dans l’API.</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : requête d’association d’un fichier numérique, et plus exactement une version initiale d’un original numérique, à une unité archivistique dont l’identifiant est aeeaaaaaaghiyso4ablmyal74sndwiqaaaaq.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="n">aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq</span>
  <span class="nd">@unit</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">**</span><span class="n">aeeaaaaaaghiyso4ablmyal74sndwiqaaaaq</span><span class="o">**</span>
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">POST</span>  <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">units</span><span class="o">/</span><span class="p">{{</span><span class="n">unit</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">objects</span><span class="o">/**</span><span class="n">BinaryMaster</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">binary</span><span class="o">**</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">octet</span><span class="o">-</span><span class="n">stream</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">ContratTNR</span>
  
  <span class="o">&lt;</span> <span class="o">/</span><span class="n">MichelMercier</span><span class="o">/</span><span class="n">Discours</span><span class="o">/</span><span class="n">Test01</span><span class="o">.</span><span class="n">jpeg</span>
</pre></div>
</div>
<p>Cette action provoque :</p>
<ul class="simple">
<li><p>l’enregistrement de l’objet numérique sur les offres de stockage.</p></li>
<li><p>la mise à jour des métadonnées techniques de l’objet avec, calculés lors de l’envoi de l’objet numérique :</p>
<ul>
<li><p>ajout de l’empreinte d’un fichier numérique,</p></li>
<li><p>ajout de l’identification de son format,</p></li>
<li><p>mise à jour de son poids exprimé en octets.</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : ajout de l’empreinte du fichier et de son identification de format et mise à jour du poids dans la collection « ObjectGroup » de la base « MetadataCollect ».</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxzdbviaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_tenant&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;FileInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;Filename&quot;</span><span class="p">:</span> <span class="s2">&quot;Test01.jpeg&quot;</span>
   <span class="p">},</span>
   <span class="s2">&quot;_nbc&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="s2">&quot;_opi&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxnhd6aaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_sp&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_qualifiers&quot;</span><span class="p">:</span> <span class="p">[</span>
   <span class="p">{</span>
   <span class="s2">&quot;qualifier&quot;</span><span class="p">:</span> <span class="s2">&quot;BinaryMaster&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_nbc&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;versions&quot;</span><span class="p">:</span> <span class="p">[</span>
   <span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxzdbvyaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;DataObjectVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;BinaryMaster_1&quot;</span><span class="p">,</span>
   <span class="o">**</span><span class="s2">&quot;FormatIdentification&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">**</span>
   <span class="s2">&quot;FormatLitteral&quot;</span><span class="p">:</span> <span class="s2">&quot;JPEG File Interchange Format&quot;</span><span class="p">,</span>
   <span class="s2">&quot;MimeType&quot;</span><span class="p">:</span> <span class="s2">&quot;image/jpeg&quot;</span><span class="p">,</span>
   <span class="s2">&quot;FormatId&quot;</span><span class="p">:</span> <span class="s2">&quot;fmt/43&quot;</span>
  <span class="o">**</span> <span class="p">}</span><span class="o">**</span><span class="p">,</span>
   <span class="s2">&quot;FileInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;Filename&quot;</span><span class="p">:</span> <span class="s2">&quot;Test01.jpeg&quot;</span>
   <span class="p">},</span>
   <span class="o">**</span> <span class="s2">&quot;Size&quot;</span><span class="p">:</span> <span class="mi">7702</span><span class="p">,</span><span class="o">**</span>
   <span class="s2">&quot;Uri&quot;</span><span class="p">:</span> <span class="s2">&quot;Content/Test01.jpeg&quot;</span><span class="p">,</span>
   <span class="s2">&quot;MessageDigest&quot;</span><span class="p">:</span> <span class="s2">&quot;0e0cec05a1d72ee5610eaa5afbc904c012d190037cbc827d08272102cdecf0226efcad122b86e7699f767c661c9f3702379b8c2cb01c4f492f69deb200661bb9&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;SHA-512&quot;</span>
   <span class="p">}</span>
   <span class="p">]</span>
   <span class="p">}</span>
   <span class="p">],</span>
   <span class="s2">&quot;_v&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;_av&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;_acd&quot;</span><span class="p">:</span> <span class="s1">&#39;&quot;023-01-02T12:01:34.629&quot;,</span>
   <span class="s2">&quot;_aud&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-02T12:01:34.965&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- L’ unité archivistique n’existe pas ou est erronée ; <br>- Le groupe d’objets techniques n’existe pas ; <br>- La transaction associée a été clôturée.</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Point d’attention :</strong></em> Certains contrôles, disponibles au moment du transfert dans la solution logicielle Vitam n’ont pas été implémentés. Il est fortement recommandé de ne pas envoyer dans le module de collecte plusieurs objets numériques pour un usage et une version donnée.</p>
</section>
<section id="id23">
<h6><span class="section-number">14.3.2.3.3.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id23" title="Lien vers cette rubrique"></a></h6>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam ne permet pas à l’utilisateur d’utiliser ce mode pour alimenter une transaction.</p>
</section>
</section>
</section>
<section id="alimentation-d-une-transaction-en-mode-lot">
<h4><span class="section-number">14.3.2.4. </span>Alimentation d’une transaction en mode « lot »<a class="headerlink" href="#alimentation-d-une-transaction-en-mode-lot" title="Lien vers cette rubrique"></a></h4>
<p>L’envoi et l’enregistrement des données dans le module de collecte peut s’effectuer en lot au moyen d’une commande pouvant fonctionner de deux façons :</p>
<ul class="simple">
<li><p>envoi sous forme de fichier .zip d’une arborescence bureautique,</p></li>
<li><p>envoi sous forme de fichier .zip d’une arborescence bureautique et d’un fichier annexe intitulé « metadata.csv » ou « metadata.jsonl » référençant des métadonnées descriptives et de gestion.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em> Pour ces deux envois, la commande est unique. Seule l’association d’un fichier annexe « metadata.csv » ou « metadata.jsonl », optionnelle, diffère.</p>
<section id="envoi-dune-arborescence-bureautique">
<h5><span class="section-number">14.3.2.4.1. </span>Envoi d’une arborescence bureautique<a class="headerlink" href="#envoi-dune-arborescence-bureautique" title="Lien vers cette rubrique"></a></h5>
<section id="id24">
<h6><span class="section-number">14.3.2.4.1.1. </span>Utilisation des API<a class="headerlink" href="#id24" title="Lien vers cette rubrique"></a></h6>
<p>Pour une transaction donnée, est envoyée une arborescence bureautique sous forme de fichier .zip.</p>
<p><em><strong>Point d’attention :</strong></em> En prérequis à l’envoi d’une arborescence bureautique, il faut avoir au préalable créé une transaction et le signaler dans l’API.</p>
<p><em>Exemple : requête d’envoi d’une arborescence bureautique stream.zip pour la transaction préalablement créée dont l’identifiant est aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">**</span><span class="n">aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq</span><span class="o">**</span>
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">POST</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">upload</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="nb">zip</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
  
  <span class="o">&lt;</span> <span class="o">/</span><span class="n">path_tozip</span><span class="o">/**</span><span class="n">stream</span><span class="o">.</span><span class="n">zip</span><span class="o">**</span>
</pre></div>
</div>
<p>Cette action provoque :</p>
<ul>
<li><p>la création des unités archivistiques dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id143" id="id25" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></em>). Sont enregistrés automatiquement<a class="footnote-reference brackets" href="#id144" id="id26" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a> :</p>
<ul class="simple">
<li><p>un niveau de description (DescriptionLevel) dont la valeur est :</p>
<ul>
<li><p>« RecordGrp » pour une unité archivistique référençant un répertoire,</p></li>
<li><p>« Item » pour une unité archivistique référençant un objet numérique ;</p></li>
</ul>
</li>
<li><p>un intitulé (Title), correspondant au nom d’un répertoire ou d’un objet binaire présent dans l’arborescence bureautique.</p></li>
</ul>
<p>À chaque enregistrement, est associé :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-   l’identifiant de la transaction (_opi),
-   l&#39;identifiant du service producteur (_sp et _sps);
</pre></div>
</div>
</li>
<li><p>la création de métadonnées techniques dans la base de données MongoDB, dans la collection « ObjectGroup » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id145" id="id27" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a></em>) ;</p>
<p>À chaque enregistrement, est associé :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-   l’identifiant de la transaction (_opi),
-   l&#39;identifiant du service producteur (_sp);
</pre></div>
</div>
</li>
<li><p>l’enregistrement des objets numériques sur les offres de stockage.</p></li>
<li><p>la mise à jour des métadonnées techniques de l’objet avec, calculés lors de l’envoi du fichier numérique :</p>
<ul class="simple">
<li><p>ajout de l’empreinte d’un fichier numérique,</p></li>
<li><p>ajout de l’identification de son format,</p></li>
<li><p>mise à jour de son poids exprimé en octets.</p></li>
</ul>
</li>
<li><p>le cas échéant :</p>
<ul class="simple">
<li><p>si le projet de versement déclarait un rattachement unique, la création d’une unité archivistique dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id143" id="id28" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></em>). Sont enregistrés automatiquement :</p>
<ul>
<li><p>un niveau de description (DescriptionLevel) dont la valeur est « Series »,</p></li>
<li><p>un intitulé (Title) dont la valeur est « STATIC_ATTACHEMENT »,</p></li>
<li><p>l’identifiant de l’unité archivistique de rattachement (champ SystemId inclus dans un bloc UpdateOperation);</p></li>
</ul>
</li>
<li><p>si le projet de versement déclarait un rattachement par clé / valeur, la création d’une unité archivistique dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id143" id="id29" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></em>). Sont enregistrés automatiquement :</p>
<ul>
<li><p>un niveau de description (DescriptionLevel) dont la valeur est « Series »,</p></li>
<li><p>un intitulé (Title) dont la valeur est « DYNAMIC_ATTACHEMENT »,</p></li>
<li><p>l’identifiant de l’unité archivistique de rattachement (champ SystemId inclus dans un bloc UpdateOperation).</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Le fichier .zip n’a pas été téléchargé pour cause de nom erroné ou de chemin introuvable.<br> - La transaction n’existe pas ou est erronée.<br> -</p></td>
</tr>
<tr class="row-even"><td><p>La transaction a été clôturée.</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>Elle n’est pas journalisée dans le journal des opérations.</p>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>Aucun fichier ne doit avoir un poids équivalent à 0 octet.</p></li>
<li><p>Au terme de la V.8.1, il est recommandé que les noms de répertoires et de fichiers ne contiennent ni caractère accentué, ni virgule, ni apostrophe, ni parenthèse, ni espace, ni élément de ponctuation, ou tout autre caractère spécial. Ne sont à privilégier que l’underscore et le tiret comme séparateurs.
Néanmoins, s’ils en contiennent et si l’arborescence bureautique émane d’un environnement Windows, il est recommandé d’utiliser l’outil Winzip pour la zipper, afin d’éviter des problèmes d’encodage.</p></li>
</ul>
</section>
<section id="id30">
<h6><span class="section-number">14.3.2.4.1.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id30" title="Lien vers cette rubrique"></a></h6>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet de verser une arborescence bureautique, le cas échéant accompagnée d’un fichier « metatadata.csv », lors de la création d’un projet de versement manuel au moyen d’un wizard ou boîte de dialogue.</p>
<p>Le détail du projet de versement, ainsi que les archives qui lui sont associées sont par ailleurs accessibles depuis l’APP.</p>
</section>
</section>
<section id="envoi-dune-arborescence-bureautique-avec-fichier-csv">
<h5><span class="section-number">14.3.2.4.2. </span>Envoi d’une arborescence bureautique avec fichier .csv<a class="headerlink" href="#envoi-dune-arborescence-bureautique-avec-fichier-csv" title="Lien vers cette rubrique"></a></h5>
<section id="id31">
<h6><span class="section-number">14.3.2.4.2.1. </span>Utilisation des API<a class="headerlink" href="#id31" title="Lien vers cette rubrique"></a></h6>
<p>Pour une transaction donnée peut être envoyé sous forme de zip en plus d’une arborescence bureautique<a class="footnote-reference brackets" href="#id146" id="id32" role="doc-noteref"><span class="fn-bracket">[</span>13<span class="fn-bracket">]</span></a> un fichier .csv contenant des métadonnées détaillant unitairement les unités archivistiques.</p>
<p>Le fichier .csv, obligatoirement intitulé « metadata.csv », est composé de x colonnes<a class="footnote-reference brackets" href="#id147" id="id33" role="doc-noteref"><span class="fn-bracket">[</span>14<span class="fn-bracket">]</span></a> :</p>
<ul class="simple">
<li><p>File : chemin relatif des fichiers numériques ou des répertoires à partir de l’emplacement où est enregistré le fichier .csv (colonne obligatoire) ;</p></li>
<li><p>ObjectFiles : chemin relatif des fichiers numériques dont certains peuvent être rattachés à des répertoires déclarés dans la colonne File (colonne facultative) ;</p></li>
<li><p>DescriptionLevel : niveau de description de l’unité archivistique (colonne facultative) ;</p></li>
<li><p>Title : intitulé de l’unité archivistique (colonne facultative) ;</p></li>
<li><p>toute colonne correspondant à une métadonnée du standard SEDA (colonnes facultatives) ;</p></li>
<li><p>le cas échéant, toute colonne correspondant à une métadonnée externe du standard SEDA (colonnes facultatives).</p></li>
</ul>
<p><em>Exemple : contenu d’un fichier « metadata.csv ».</em></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>  &quot;File&quot;;&quot;Content.DescriptionLevel&quot;;&quot;Content.Title&quot;;&quot;Content.FilePlanPosition&quot;;&quot;Content.ArchivalAgencyArchiveUnitIdentifier&quot;;&quot;Content.Description&quot;;&quot;Content.CustodialHistory.CustodialHistoryItem.0&quot;;&quot;Content.CustodialHistory.CustodialHistoryItem.1&quot;;&quot;Content.CustodialHistory.CustodialHistoryItem.2&quot;;&quot;Content.DocumentType&quot;;&quot;Content.Language&quot;;&quot;Content.DescriptionLanguage&quot;;&quot;Content.Version&quot;;&quot;Content.Tag.0&quot;;&quot;Content.Tag.1&quot;;&quot;Content.Tag.2&quot;;&quot;Content.Tag.3&quot;;&quot;Content.Tag.4&quot;;&quot;Content.Keyword.0.KeywordContent&quot;;&quot;Content.Keyword.0.KeywordType&quot;;&quot;Content.Keyword.1.KeywordContent&quot;;&quot;Content.Keyword.1.KeywordType&quot;;&quot;Content.Keyword.2.KeywordContent&quot;;&quot;Content.Keyword.2.KeywordType&quot;;&quot;Content.Keyword.3.KeywordContent&quot;;&quot;Content.Keyword.3.KeywordType&quot;;&quot;Content.Keyword.4.KeywordContent&quot;;&quot;Content.Keyword.4.KeywordType&quot;;&quot;Content.Coverage.Spatial.0&quot;;&quot;Content.Coverage.Spatial.1&quot;;&quot;Content.Coverage.Spatial.2&quot;;&quot;Content.Coverage.Spatial.3&quot;;&quot;Content.Coverage.Temporal&quot;;&quot;Content.Coverage.Juridictional.0&quot;;&quot;Content.Coverage.Juridictional.1&quot;;&quot;Content.Coverage.Juridictional.2&quot;;&quot;Content.Coverage.Juridictional.3&quot;;&quot;Content.OriginatingAgency.Identifier&quot;;&quot;Content.SubmissionAgency.Identifier&quot;;&quot;Content.StartDate&quot;;&quot;Content.EndDate&quot;;&quot;Management.AccessRule.Rule&quot;;&quot;Management.AccessRule.StartDate&quot;
  &quot;AU1/27juillet1888/5FI6/_5FI6/_16&quot;;&quot;RecordGrp&quot;;&quot;Brantes. Combe de la Mure.&quot;;&quot;instrument_recherche/5FI6/5FI6_16&quot;;&quot;5 Fi 6/16&quot;;&quot;Dim. 18x24 cm.&quot;;;;;;&quot;fre&quot;;&quot;fre&quot;;&quot;Original&quot;;&quot;Combe de la Mure (Brantes, Vaucluse, France)&quot;;&quot;Brantes (Vaucluse, France)&quot;;;;;&quot;Combe de la Mure (Brantes, Vaucluse, France)&quot;;&quot;geogname&quot;;&quot;Brantes (Vaucluse, France)&quot;;&quot;geogname&quot;;;;;;;;&quot;Combe de la Mure (Brantes, Vaucluse, France)&quot;;&quot;Brantes (Vaucluse, France)&quot;;;;1888;&quot;Combe de la Mure (Brantes, Vaucluse, France)&quot;;&quot;Brantes (Vaucluse, France)&quot;;;;;;;&quot;1888-12-30T00:00:00&quot;;&quot;ACC-00001&quot;;&quot;1888-12-30&quot;
  &quot;AU1/27juillet1888&quot;;&quot;RecordGrp&quot;;&quot;Clichés du 27 juillet 1888&quot;;;;;;;;;&quot;fre&quot;;&quot;fre&quot;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
</pre></div>
</div>
<p><em>Exemple : contenu d’un fichier « metadata.csv » décrivant un contexte de signature détachée.</em></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>  &quot;File&quot;;&quot;ObjectFiles&quot;;&quot;Content.DescriptionLevel&quot;;&quot;Content.Title&quot;;&quot;Content.Description&quot;;&quot;Content.DocumentType&quot;;&quot;Content.Tag&quot;;&quot;Content.EndDate&quot;;&quot;Content.SigningInformation.SigningRole.0&quot;;&quot;Content.SigningInformation.SigningRole.1&quot;;&quot;Content.SigningInformation.SigningRole.2&quot;;&quot;Content.SigningInformation.SignatureDescription.0.Signer.FullName&quot;;&quot;Content.SigningInformation.SignatureDescription.0.Signer.SigningTime&quot;;&quot;Content.SigningInformation.TimestampingInformation.TimeStamp&quot;;&quot;Content.SigningInformation.AdditionalProof.0.AdditionalProofInformation.0&quot;;&quot;Content.SigningInformation.AdditionalProof.0.AdditionalProofInformation.1&quot;;&quot;Management.AppraisalRule.Rule&quot;;&quot;Management.AppraisalRule.StartDate&quot;;&quot;Management.AppraisalRule.FinalAction&quot;;&quot;Management.AccessRule.Rule&quot;;&quot;Management.AccessRule.StartDate&quot;
  &quot;**Parapheur**&quot;;&quot;Parapheur/20230615_note_Vu AB.pdf&quot;;&quot;Item&quot;;&quot;20230615_note_Vu AB.pdf&quot;;&quot;Parapheur créé par Al Capone. Note&quot;;&quot;Document signé&quot;;&quot;Note&quot;;&quot;2023-06-15&quot;;&quot;SignedDocument&quot;;&quot;Signature&quot;;&quot;Timestamp&quot;;&quot;Al Capone&quot;;&quot;2023-06-15T11:18:12&quot;;&quot;2023-06-15T11:18:12&quot;;&quot;EvidenceRecords&quot;;&quot;Report&quot;;&quot;APP-00003&quot;;&quot;2023-06-15&quot;;&quot;Keep&quot;;&quot;ACC-00020&quot;;&quot;2023-06-15&quot;
  &quot;Parapheur/aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq-evidenceRecord.pdf&quot;;&quot;**Parapheur/aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq-evidenceRecord.pdf**&quot;;&quot;Item&quot;;&quot;aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq-evidenceRecord.pdf&quot;;;&quot;Fichier de preuve&quot;;;;&quot;AdditionalProof&quot;;;;;;;;;;;;;
  &quot;Parapheur/report_aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq.pdf&quot;;&quot;**Parapheur/report_aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq.pdf**&quot;;&quot;Item&quot;;&quot;report_aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq.pdf&quot;;;&quot;Rapport&quot;;;;&quot;AdditionalProof&quot;;;;;;;;;;;;;```
</pre></div>
</div>
<p><em>Exemple : contenu d’un fichier « metadata.csv » déclarant un rattachement.</em></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>  &quot;File&quot;;&quot;Content.DescriptionLevel&quot;;&quot;Content.Title&quot;;**&quot;Management.UpdateOperation.ArchiveUnitIdentifierKey.MetadataName**&quot;;&quot;**Management.UpdateOperation.ArchiveUnitIdentifierKey.MetadataValue**&quot;
  &quot;Discours hors parlement&quot;;&quot;RecordGrp&quot;;&quot;Discours hors parlement&quot;;&quot;**ArchivalAgencyArchiveUnitIdentifier**&quot;;&quot;**20130456/3**&quot;
  &quot;Discours hors parlement/Discours d&#39;inauguration&quot;;&quot;RecordGrp&quot;;&quot;Discours d’inauguration&quot;;;
  &quot;Discours hors parlement/Discours d&#39;inauguration/Inauguration de Notre-Dame.odt&quot;;&quot;Item&quot;;&quot;Inauguration de Notre-Dame&quot;;;
</pre></div>
</div>
<p><em><strong>Points d’attention :</strong></em></p>
<ul>
<li><p>la colonne File doit toujours être placée en première position ;</p></li>
<li><p>une première ligne d’en-tête donnant le nom des colonnes doit être présente, chaque ligne décrivant ensuite une unité archivistique ;</p></li>
<li><p>le séparateur entre les colonnes est le <em>point-virgule</em>, le séparateur de texte les guillemets doubles et l’encodage est « <em>UTF-8</em> » ;</p></li>
<li><p>le fichier .csv ne référence que des métadonnées propres aux unités archivistiques (métadonnées descriptives et de gestion). Il ne supporte pas les métadonnées techniques propres aux fichiers numériques ;</p></li>
<li><p>seul un objet peut être associé à un enregistrement. Ce format d’import ne permet pas de facto de gérer l’import de groupe d’objets techniques disposant de plusieurs objets aux usages différents devant être référencés par la même unité archivistique.</p></li>
<li><p>le fichier .csv à importer doit se trouver dans le même répertoire que le répertoire correspondant à la racine de la structure arborescente de fichiers à importer.</p></li>
<li><p>chaque répertoire et objet numérique devant contenir des métadonnées particulières doit être référencé dans le fichier .csv ;</p></li>
<li><p>si le fichier .csv déclare un rattachement à une unité archivistique, il doit matérialiser cette unité archivistique par une ligne dédiée correspondant à un dossier dans l’arborescence bureautique.
Dans cette ligne :</p>
<ul class="simple">
<li><p>Ne devront être renseignées que les informations suivantes :</p>
<ul>
<li><p>DescriptionLevel,</p></li>
<li><p>Title,</p></li>
<li><p>UpdateOperation.ArchiveUnitIdentifierKey.MetadataName et Management.UpdateOperation.ArchiveUnitIdentifierKey.MetadataValue OU UpdateOperation.SystemId.</p></li>
</ul>
</li>
<li><p>Un rattachement ne peut être déclaré que dans un répertoire racine.</p></li>
</ul>
</li>
<li><p>concernant le nommage des colonnes :</p>
<ul class="simple">
<li><p>pour les colonnes correspondant à des champs du standard SEDA, l’intitulé de la colonne doit correspondre à celui du champ dans le standard SEDA, précédé de « Management. » s’il s’agit d’une métadonnée de gestion (ex. « Management.AccessRule.Rule » pour une règle de communicabilité) ou de « Content » s’il s’agit d’une métadonnée descriptive (ex. « Content.DocumentType ») ;</p></li>
<li><p>pour les colonnes correspondant à des métadonnées externes au standard SEDA, l’intitulé de la colonne doit correspondre à celui du champ, précédé de « Content. » ;</p></li>
<li><p>quand le schéma XML du standard SEDA propose une structure complexe de balises (par exemple pour décrire un auteur via l’objet XML &lt;Writer&gt; qui contient plusieurs balises XML comme FullName ou BirthName), il convient d’intituler la colonne de la manière suivante : Content.Writer.FullName ou Content.Writer.BirthName ;</p></li>
<li><p>quand un champ ou un objet XML est multivalué dans le standard SEDA (et qu’il est possible d’en décrire plusieurs dans le bordereau comme c’est le cas pour l’objet Writer par exemple), il convient de numéroter la colonne de la manière suivante : Content.Writer.0.FullName, Content.Writer.1.FullName ;</p></li>
</ul>
</li>
<li><p>concernant le contenu des colonnes :</p>
<ul class="simple">
<li><p>la colonne File :</p>
<ul>
<li><p>ne doit pas comprendre d’espace avant ou après les « / » ;</p></li>
<li><p>doit correspondre à un chemin tel que décrit par l’explorateur de fichiers (avec des « / ») ;</p></li>
</ul>
</li>
<li><p>la colonne DescriptionLevel ne doit comprendre que les valeurs autorisées par le standard SEDA : Collection, Fonds, Series, SubSeries, RecordGrp, File, Item ;</p></li>
<li><p>les colonnes correspondant à des champs Date dans le standard SEDA doivent être formatées conformément à la norme ISO 8601 (AAAA-MM-JJ) ;</p></li>
<li><p>les références à des règles de gestion et à des profils d’unité archivistique doivent se conformer aux identifiants de règles présents dans le SAE.</p></li>
</ul>
</li>
<li><p>Aucun fichier ne doit avoir un poids équivalent à 0 octet.</p></li>
<li><p>Les dates de début (Content.StartDate) doivent être antérieures aux dates de fin (Content.EndDate).</p></li>
<li><p>Au terme de la V.8.1, il est recommandé que les noms de répertoires et de fichiers ne contiennent ni caractère accentué, ni virgule, ni apostrophe, ni parenthèse, ni espace, ni élément de ponctuation, ou tout autre caractère spécial. Ne sont à privilégier que l’underscore et le tiret comme séparateurs.</p>
<p>Néanmoins, s’ils en contiennent et si l’arborescence bureautique émane d’un environnement Windows, il est recommandé d’utiliser l’outil Winzip pour la zipper, afin d’éviter des problèmes d’encodage.</p>
</li>
</ul>
<p>L’import du fichier .zip incluant un fichier .csv et une arborescence bureautique provoque :</p>
<ul>
<li><p>la création des unités archivistiques dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id148" id="id34" role="doc-noteref"><span class="fn-bracket">[</span>15<span class="fn-bracket">]</span></a></em>). Sont enregistrées automatiquement les valeurs portées dans le fichier .csv si l’enregistrement ne contient pas d’erreur.</p>
<p>À chaque enregistrement, est associé :</p>
<ul class="simple">
<li><p>s’il n’a pas été défini dans le fichier .csv, un niveau de description (DescriptionLevel) dont la valeur est :</p>
<ul>
<li><p>« RecordGrp » pour une unité archivistique référençant un répertoire,</p></li>
<li><p>« Item » pour une unité archivistique référençant un objet numérique ;</p></li>
</ul>
</li>
<li><p>l’identifiant de la transaction (_opi) ;</p></li>
<li><p>un identifiant de batch (_batchId) ;</p></li>
<li><p>la localisation initiale du dossier ou du fichier dans l’arborescence (_uploadPath),</p></li>
<li><p>l’identifiant du service producteur (_sp et _sps) ;</p></li>
</ul>
</li>
<li><p>la création de métadonnées techniques dans la base de données MongoDB, dans la collection « ObjectGroup » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id149" id="id35" role="doc-noteref"><span class="fn-bracket">[</span>16<span class="fn-bracket">]</span></a></em>).</p>
<p>À chaque enregistrement, est associé :</p>
<ul class="simple">
<li><p>l’identifiant de la transaction (_opi) ;</p></li>
<li><p>un identifiant de batch (_batchId) ;</p></li>
<li><p>l’identifiant du service producteur (_sp) ;</p></li>
</ul>
</li>
<li><p>l’enregistrement des objets numériques sur les offres de stockage.</p></li>
<li><p>la mise à jour des métadonnées techniques de l’objet avec :</p>
<ul class="simple">
<li><p>ajout de l’empreinte d’un fichier numérique,</p></li>
<li><p>ajout de l’identification de son format,</p></li>
<li><p>mise à jour de son poids exprimé en octets, calculés lors de l’envoi du fichier numérique ;</p></li>
</ul>
</li>
<li><p>le cas échéant :</p>
<ul class="simple">
<li><p>si le projet de versement déclarait un rattachement unique, la création d’une unité archivistique dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id143" id="id36" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></em>). Sont enregistrés automatiquement :</p>
<ul>
<li><p>un niveau de description (DescriptionLevel) dont la valeur est « Series »,</p></li>
<li><p>un intitulé (Title) dont la valeur est « STATIC_ATTACHEMENT »,</p></li>
<li><p>l’identifiant de l’unité archivistique de rattachement (champ SystemId inclus dans un bloc UpdateOperation);</p></li>
</ul>
</li>
<li><p>si le projet de versement déclarait un rattachement par clé / valeur, la création d’une unité archivistique dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id143" id="id37" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></em>). Sont enregistrés automatiquement :</p>
<ul>
<li><p>un niveau de description (DescriptionLevel) dont la valeur est « Series »,</p></li>
<li><p>un intitulé (Title) dont la valeur est « DYNAMIC_ATTACHEMENT »,</p></li>
<li><p>l’identifiant de l’unité archivistique de rattachement (champ SystemId inclus dans un bloc UpdateOperation).</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Le fichier .zip n’a pas été téléchargé pour cause de nom erroné ou de chemin introuvable ;<br>- Le fichier .csv contient au moins une erreur ;<br>- La transaction n’existe pas ou est erronée ;<br>- La transaction est clôturée.</p></td>
</tr>
</tbody>
</table>
<p>Cette action n’est pas journalisée dans le journal des opérations.</p>
<p><em><strong>Point d’attention :</strong></em>**</p>
<ul class="simple">
<li><p>Au terme de la V.8.1, le module de collecte peut :</p>
<ul>
<li><p>bloquer l’import de l’arborescence bureautique accompagnée d’un fichier .csv si ce dernier comporte les erreurs suivantes :</p>
<ul>
<li><p>il ne contient pas au moins la colonne obligatoire File ;</p></li>
<li><p>au moins un fichier référencé dans le fichier .csv n’est pas présent dans l’arborescence bureautique,</p></li>
<li><p>il ne contient aucune information ;</p></li>
<li><p>il ne contient pas de séparateurs de champs ;</p></li>
<li><p>il contient des virgules, des espaces, des pipes comme séparateurs de champs ;</p></li>
<li><p>le fichier contient des simples guillemets comme séparateurs de texte ;</p></li>
<li><p>etc.<br>
L’API peut :</p>
<ul>
<li><p>soit renvoyer une seule erreur, si cette erreur est bloquante,</p></li>
<li><p>soit renvoyer jusqu’à 20 erreurs, si ces erreurs sont cumulables.
L’arborescence bureautique ne sera pas importée.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>ne pas bloquer l’import de l’arborescence bureautique accompagnée d’un fichier CSV si ce dernier comporte les erreurs suivantes :</p>
<ul>
<li><p>il dispose d’un champ dont le contenu est mal formaté (ex. ReceivedDate écrite en chaîne de caractères) ;
Une erreur est alors renvoyée par l’API, le contenu du fichier .csv sera ignoré et seule l’arborescence bureautique sera téléchargée selon le comportement décrit dans la sous-section précédente.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Aucun contrôle n’est effectué entre le nombre de répertoires et d’objets binaires présents dans l’arborescence bureautique et les éléments décrits dans le fichier .csv. Il est recommandé de veiller à ne pas ajouter de niveaux intermédiaires dans l’arborescence bureautique non référencés dans le fichier .csv, car ils seront automatiquement créés dans le module de collecte selon le comportement décrit dans la sous-section précédente.</p></li>
</ul>
</section>
<section id="id38">
<h6><span class="section-number">14.3.2.4.2.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id38" title="Lien vers cette rubrique"></a></h6>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet de verser une arborescence bureautique, le cas échéant accompagnée d’un fichier « metadata.csv », lors de la création d’un projet de versement manuel au moyen d’un wizard ou boîte de dialogue.</p>
<p>Le détail du projet de versement, ainsi que les archives qui lui sont associées sont par ailleurs accessibles depuis l’APP.</p>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>Si un fichier « metadata.csv » est associé à une arborescence bureautique, il faut d’abord télécharger cette dernière dans le wizard ou boîte de dialogue, puis faire de même avec le fichier « metadata.csv » ;</p></li>
<li><p>Si le nom du fichier .csv est erroné, l’interface VitamUI l’interprétera comme un fichier numérique à collecter au même titre que l’arborescence bureautique associée ;</p></li>
<li><p>Au terme de la V.8.1, l’APP « Collecte et préparation des versements » ne renvoie pas d’erreurs lors de l’import de l’arborescence bureautique accompagnée d’un fichier .csv si ce dernier comporte des erreurs.</p></li>
</ul>
</section>
</section>
<section id="envoi-dune-arborescence-bureautique-avec-fichier-jsonl">
<h5><span class="section-number">14.3.2.4.3. </span>Envoi d’une arborescence bureautique avec fichier .jsonl<a class="headerlink" href="#envoi-dune-arborescence-bureautique-avec-fichier-jsonl" title="Lien vers cette rubrique"></a></h5>
<section id="id39">
<h6><span class="section-number">14.3.2.4.3.1. </span>Utilisation des API<a class="headerlink" href="#id39" title="Lien vers cette rubrique"></a></h6>
<p>Pour une transaction donnée peut être envoyé sous forme de zip en plus d’une arborescence bureautique<a class="footnote-reference brackets" href="#id146" id="id40" role="doc-noteref"><span class="fn-bracket">[</span>13<span class="fn-bracket">]</span></a> un fichier .jsonl contenant des métadonnées détaillant unitairement les unités archivistiques.</p>
<p>Le fichier .jsonl, obligatoirement intitulé « metadata.jsonl », est composé des informations suivantes :</p>
<ul class="simple">
<li><p>File : chemin relatif des fichiers numériques ou des répertoires à partir de l’emplacement où est enregistré le fichier .jsonl (champ obligatoire) ;</p></li>
<li><p>Selector : liste de conditions permettant l’enregistrement des métadonnées dans une unité archivistique correspond à ces conditions (champ obligatoire) ;</p></li>
<li><p>ObjectFiles : chemin relatif des fichiers numériques dont certains peuvent être rattachés à des répertoires déclarés dans le champ File (champ facultatif) ;</p></li>
<li><p>UnitContent : bloc dans lequel sont insérées les métadonnées descriptives et de gestion d’une unité archivistique (champ obligatoire), dont :</p>
<ul>
<li><p>DescriptionLevel : niveau de description de l’unité archivistique (champ facultatif) ;</p></li>
<li><p>Title : intitulé de l’unité archivistique (champ facultatif) ;</p></li>
<li><p>tout champ correspondant à un champ du standard SEDA (champs facultatifs) ;</p></li>
<li><p>le cas échéant, tout champ correspondant à une métadonnée externe du standard SEDA (champs facultatifs).</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : contenu d’un fichier « metadata.jsonl ».</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Collection&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;Ceci est un versement de bulletins de paie&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;EndDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Paie&quot;</span><span class="p">,</span> <span class="s2">&quot;Bulletin&quot;</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;File/BP_123456_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;BP_123456_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;OriginatingSystemId&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;BP_123456_20230131&quot;</span> <span class="p">],</span> <span class="s2">&quot;Agent&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;DUPONT&quot;</span><span class="p">,</span> <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;Charles&quot;</span><span class="p">,</span> <span class="s2">&quot;Identifier&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;123456&quot;</span> <span class="p">]</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;SentDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;AcquiredDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Salaire&quot;</span> <span class="p">],</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00001&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span> <span class="p">},</span> <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00016&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;File/BP_123463_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;BP_123463_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;OriginatingSystemId&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;BP_123463_20230131&quot;</span> <span class="p">],</span> <span class="s2">&quot;Agent&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;DUPOND&quot;</span><span class="p">,</span> <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;Victor&quot;</span><span class="p">,</span> <span class="s2">&quot;Identifier&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;123463&quot;</span> <span class="p">]</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;SentDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;AcquiredDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Salaire&quot;</span> <span class="p">],</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00002&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span> <span class="p">},</span> <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00016&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;File/BP_123464_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;BP_123464_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;OriginatingSystemId&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;BP_123464_20230131&quot;</span> <span class="p">],</span> <span class="s2">&quot;Agent&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;CHARLES&quot;</span><span class="p">,</span> <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;Ray&quot;</span><span class="p">,</span> <span class="s2">&quot;Identifier&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;123464&quot;</span> <span class="p">]</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;SentDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;AcquiredDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Salaire&quot;</span> <span class="p">],</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00002&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span> <span class="p">},</span> <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00016&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> 
</pre></div>
</div>
<p><em>Exemple : contenu d’un fichier « metadata.jsonl » décrivant un contexte de signature détachée.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;File&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Root Folder&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="s2">&quot;SomeFile.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder (with attached SomeFile.xml)&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile1.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile1.txt&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile2.txt&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Root Folder/SubFolder&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/SubFolder/MyFile3.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/SubFolder (with attached MyFile3.txt)&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;Selector&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;#uploadPath&quot;</span> <span class="p">:</span> <span class="s2">&quot;Yet Another Folder&quot;</span> <span class="p">},</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/SubFolder/MyFile4.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Yet Another Folder (with attached MyFile4.txt)&quot;</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
<p><em>Exemple : contenu d’un fichier « metadata.jsonl » déclarant un rattachement.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours hors parlement&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;RecordGrp&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours hors parlement&quot;</span><span class="p">,</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;UpdateOperation&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;ArchiveUnitIdentifierKey&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;MetadataName&quot;</span> <span class="p">:</span> <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span><span class="p">,</span> <span class="s2">&quot;MetadataValue&quot;</span> <span class="p">:</span> <span class="s2">&quot;20130456/3&quot;</span><span class="p">}</span> <span class="p">}</span>  <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours hors parlement/Discours d&#39;inauguration&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;RecordGrp&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours d’inauguration&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours hors parlement/Discours d&#39;inauguration/Inauguration de Notre-Dame.odt&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Inauguration de Notre-Dame&quot;</span> <span class="p">}</span> <span class="p">}</span>
 
</pre></div>
</div>
<p><em><strong>Points d’attention :</strong></em></p>
<ul>
<li><p>le fichier .jsonl doit toujours contenir un champ File <em>ou</em> un champ Selector. Celui-ci doit toujours être placée en première position ;</p></li>
<li><p>les métadonnées pouvant être utilisées comme conditions dans le champ Selector doivent des éléments simples de type string, boolean, long ou double.</p></li>
<li><p>le fichier .jsonl ne référence que des métadonnées propres aux unités archivistiques (métadonnées descriptives et de gestion). Il ne supporte pas les métadonnées techniques propres aux fichiers numériques ;</p></li>
<li><p>seul un objet peut être associé à un enregistrement. Ce format d’import ne permet pas de facto de gérer l’import de groupe d’objets techniques disposant de plusieurs objets aux usages différents devant être référencés par la même unité archivistique.</p></li>
<li><p>le fichier .jsonl à importer doit se trouver dans le même répertoire que le répertoire correspondant à la racine de la structure arborescente de fichiers à importer.</p></li>
<li><p>chaque répertoire et objet numérique devant contenir des métadonnées particulières doit être référencé dans le fichier .jsonl ;</p></li>
<li><p>si le fichier .jsonl déclare un rattachement à une unité archivistique, il doit matérialiser cette unité archivistique par une ligne dédiée correspondant à un dossier dans l’arborescence bureautique.
Dans cette ligne :</p>
<ul class="simple">
<li><p>Ne devront être renseignées que les informations suivantes :</p>
<ul>
<li><p>DescriptionLevel,</p></li>
<li><p>Title,</p></li>
<li><p>UpdateOperation.ArchiveUnitIdentifierKey.MetadataName et Management.UpdateOperation.ArchiveUnitIdentifierKey.MetadataValue OU UpdateOperation.SystemId.</p></li>
</ul>
</li>
<li><p>Un rattachement ne peut être déclaré que dans un répertoire racine.</p></li>
</ul>
</li>
<li><p>le nommage des champs et leur structuration en JSON doivent se conformer au modèle de données de la solution logicielle Vitam.</p></li>
<li><p>concernant le contenu des champs :</p>
<ul class="simple">
<li><p>la colonne File :</p>
<ul>
<li><p>ne doit pas comprendre d’espace avant ou après les « / » ;</p></li>
<li><p>doit correspondre à un chemin tel que décrit par l’explorateur de fichiers (avec des « / ») ;</p></li>
</ul>
</li>
<li><p>le champ DescriptionLevel ne doit comprendre que les valeurs autorisées par le standard SEDA : Collection, Fonds, Series, SubSeries, RecordGrp, File, Item ;</p></li>
<li><p>les champs correspondant à des champs Date dans le standard SEDA doivent être formatés conformément à la norme ISO 8601 (AAAA-MM-JJ) ;</p></li>
<li><p>les références à des règles de gestion et à des profils d’unité archivistique doivent se conformer aux identifiants de règles présents dans le SAE</p></li>
</ul>
</li>
<li><p>Aucun fichier ne doit avoir un poids équivalent à 0 octet.</p></li>
<li><p>Les dates de début (Content.StartDate) doivent être antérieures aux dates de fin (Content.EndDate).</p></li>
<li><p>Au terme de la V.8.1, il est recommandé que les noms de répertoires et de fichiers ne contiennent ni caractère accentué, ni virgule, ni apostrophe, ni parenthèse, ni espace, ni élément de ponctuation, ou tout autre caractère spécial. Ne sont à privilégier que l’underscore et le tiret comme séparateurs.</p>
<p>Néanmoins, s’ils en contiennent et si l’arborescence bureautique émane d’un environnement Windows, il est recommandé d’utiliser l’outil Winzip pour la zipper, afin d’éviter des problèmes d’encodage.</p>
</li>
</ul>
<p>L’import du fichier .zip incluant un fichier .jsonl et une arborescence bureautique provoque :</p>
<ul>
<li><p>la création des unités archivistiques dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id148" id="id41" role="doc-noteref"><span class="fn-bracket">[</span>15<span class="fn-bracket">]</span></a></em>). Sont enregistrées automatiquement les valeurs portées dans le fichier .jsonl si l’enregistrement ne contient pas d’erreur.</p>
<p>À chaque enregistrement, est associé :</p>
<ul class="simple">
<li><p>s’il n’a pas été défini dans le fichier .csv, un niveau de description (DescriptionLevel) dont la valeur est :</p>
<ul>
<li><p>« RecordGrp » pour une unité archivistique référençant un répertoire,</p></li>
<li><p>« Item » pour une unité archivistique référençant un objet numérique ;</p></li>
</ul>
</li>
<li><p>l’identifiant de la transaction (_opi) ;</p></li>
<li><p>un identifiant de batch (_batchId) ;</p></li>
<li><p>la localisation initiale du dossier ou du fichier dans l’arborescence (_uploadPath),</p></li>
<li><p>l’identifiant du service producteur (_sp et _sps) ;</p></li>
</ul>
</li>
<li><p>la création de métadonnées techniques dans la base de données MongoDB, dans la collection « ObjectGroup » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id149" id="id42" role="doc-noteref"><span class="fn-bracket">[</span>16<span class="fn-bracket">]</span></a></em>).</p>
<p>À chaque enregistrement, est associé :</p>
<ul class="simple">
<li><p>l’identifiant de la transaction (_opi) ;</p></li>
<li><p>un identifiant de batch (_batchId) ;</p></li>
<li><p>l’identifiant du service producteur (_sp) ;</p></li>
</ul>
</li>
<li><p>l’enregistrement des objets numériques sur les offres de stockage.</p></li>
<li><p>la mise à jour des métadonnées techniques de l’objet avec :</p>
<ul class="simple">
<li><p>ajout de l’empreinte d’un fichier numérique,</p></li>
<li><p>ajout de l’identification de son format,</p></li>
<li><p>mise à jour de son poids exprimé en octets, calculés lors de l’envoi du fichier numérique ;</p></li>
</ul>
</li>
<li><p>le cas échéant :</p>
<ul class="simple">
<li><p>si le projet de versement déclarait un rattachement unique, la création d’une unité archivistique dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id143" id="id43" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></em>). Sont enregistrés automatiquement :</p>
<ul>
<li><p>un niveau de description (DescriptionLevel) dont la valeur est « Series »,</p></li>
<li><p>un intitulé (Title) dont la valeur est « STATIC_ATTACHEMENT »,</p></li>
<li><p>l’identifiant de l’unité archivistique de rattachement (champ SystemId inclus dans un bloc UpdateOperation);</p></li>
</ul>
</li>
<li><p>si le projet de versement déclarait un rattachement par clé / valeur, la création d’une unité archivistique dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id143" id="id44" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></em>). Sont enregistrés automatiquement :</p>
<ul>
<li><p>un niveau de description (DescriptionLevel) dont la valeur est « Series »,</p></li>
<li><p>un intitulé (Title) dont la valeur est « DYNAMIC_ATTACHEMENT »,</p></li>
<li><p>l’identifiant de l’unité archivistique de rattachement (champ SystemId inclus dans un bloc UpdateOperation).</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Le fichier .zip n’a pas été téléchargé pour cause de nom erroné ou de chemin introuvable ;<br>- Le fichier .jsonl contient au moins une erreur ;<br>- La transaction n’existe pas ou est erronée ;<br>- La transaction est clôturée.</p></td>
</tr>
</tbody>
</table>
<p>Cette action n’est pas journalisée dans le journal des opérations.</p>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>Au terme de la V.8.1, le module de collecte peut :</p>
<ul>
<li><p>bloquer l’import de l’arborescence bureautique accompagnée d’un fichier .jsonl si ce dernier comporte les erreurs suivantes :</p>
<ul>
<li><p>il ne contient pas au moins le champ obligatoire File ;</p></li>
<li><p>au moins un bloc UnitContent ne contient aucune information ;</p></li>
<li><p>au moins un fichier référencé dans le fichier .jsonl n’est pas présent dans l’arborescence bureautique,</p></li>
<li><p>il ne contient aucune information ;</p></li>
<li><p>une date de fin de règle a été intégrée dans le fichier .jsonl ;</p></li>
<li><p>il dispose d’un champ dont le contenu est mal formaté (ex. ReceivedDate écrite en chaîne de caractères) ;</p></li>
<li><p>etc.<br>
L’API peut :</p>
<ul>
<li><p>soit renvoyer une seule erreur, si cette erreur est bloquante,</p></li>
<li><p>soit renvoyer jusqu’à 20 erreurs, si ces erreurs sont cumulables.
L’arborescence bureautique ne sera pas importée.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Aucun contrôle n’est effectué entre le nombre de répertoires et d’objets binaires présents dans l’arborescence bureautique et les éléments décrits dans le fichier .jsonl. Il est recommandé de veiller à ne pas ajouter de niveaux intermédiaires dans l’arborescence bureautique non référencés dans le fichier .jsonl, car ils seront automatiquement créés dans le module de collecte selon le comportement décrit dans la sous-section précédente.</p></li>
</ul>
</section>
<section id="id45">
<h6><span class="section-number">14.3.2.4.3.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id45" title="Lien vers cette rubrique"></a></h6>
<p>Il n’est pas possible d’envoyer une arborescence bureautique avec un fichier .jsonl de métadonnées depuis l’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam.</p>
</section>
</section>
</section>
</section>
<section id="id46">
<h3><span class="section-number">14.3.3. </span>Accès<a class="headerlink" href="#id46" title="Lien vers cette rubrique"></a></h3>
<section id="id47">
<h4><span class="section-number">14.3.3.1. </span>Définitions<a class="headerlink" href="#id47" title="Lien vers cette rubrique"></a></h4>
<p>Après versement d’archives dans le module de collecte, il est possible de rechercher et de consulter :</p>
<ul class="simple">
<li><p>les informations ayant trait au versement,</p></li>
<li><p>les archives associées à un versement.</p></li>
</ul>
<p>Cette recherche et consultation est propre à chaque tenant de la solution logicielle Vitam.</p>
</section>
<section id="acces-aux-informations-du-versement">
<h4><span class="section-number">14.3.3.2. </span>Accès aux informations du versement<a class="headerlink" href="#acces-aux-informations-du-versement" title="Lien vers cette rubrique"></a></h4>
<section id="id48">
<h5><span class="section-number">14.3.3.2.1. </span>Utilisation des API<a class="headerlink" href="#id48" title="Lien vers cette rubrique"></a></h5>
<p>Pour un projet donné, la solution logicielle Vitam permet de :</p>
<ul class="simple">
<li><p>accéder à la liste des transactions associées créées sur un tenant donné,</p></li>
<li><p>consulter les informations d’une transaction en particulier sur un tenant donné.</p></li>
</ul>
<p><em>Exemple : requête en vue d’obtenir l’ensemble des transactions d’un projet de versement disponibles sur un tenant donné</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="nd">@project</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="n">aeeaaaaaaghpmborabjyyambxjekiyyaaaaq</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="p">{{</span><span class="n">project</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">transactions</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
</pre></div>
</div>
<p>Cette action peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Un paramètre (identifiant du projet) contient une mauvais valeur.<br> - Le projet associé à la transaction n’existe pas.</p></td>
</tr>
</tbody>
</table>
<p><em>Exemple : requête en vue d’obtenir les informations relatives à une transaction donnée dont l’identifiant est « aeeaaaaaaghpmborabjyyambxjekiyyaaabcdef » sur un tenant donné</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaaghpmborabjyyambxjekiyyaaabcdef</span><span class="o">*</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  
  <span class="p">{</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Cette action peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Un paramètre (identifiant de la transaction) contient une mauvais valeur.<br> - La transaction n’existe pas.</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>En résultats, la solution logicielle renvoie systématiquement l’ensemble des métadonnées relatives au(x) transaction(s). Au terme de la version 8.1, il n’est pas possible de récupérer une sélection de métadonnées.</p></li>
<li><p>Si la transaction a été envoyée dans la solution logicielle Vitam, l’API renverra également l’identifiant de l’opération de versement (champ « VitamOperationId »).</p></li>
</ul>
</section>
<section id="id49">
<h5><span class="section-number">14.3.3.2.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id49" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet à l’utilisateur de consulter :</p>
<ul class="simple">
<li><p>la liste des transactions associées à un projet de versement.
Au terme de la version 8.1, elle ne permet pas de consulter le détail des informations d’une transaction.</p></li>
<li><p>les archives associées à une transaction donnée.</p></li>
</ul>
<p>L’accès aux transactions d’un projet de versement peut être restreint via l’utilisation d’un contrat d’accès. Ainsi, un utilisateur du front-office VitamUI devant accéder aux projets de versement
d’un service en particulier, et à ses transactions, pourra ne voir que ceux-là si son profil utilisateur est associé à un contrat d’accès lui permettant d’accéder uniquement aux archives de ce service.</p>
<p><em><strong>Point d’attention :</strong></em>
Au terme de la version 8.1, ce filtre n’est disponible que depuis le front-office VitamUI.</p>
</section>
</section>
<section id="acces-aux-unites-archivistiques">
<h4><span class="section-number">14.3.3.3. </span>Accès aux unités archivistiques<a class="headerlink" href="#acces-aux-unites-archivistiques" title="Lien vers cette rubrique"></a></h4>
<section id="id50">
<h5><span class="section-number">14.3.3.3.1. </span>Utilisation des API<a class="headerlink" href="#id50" title="Lien vers cette rubrique"></a></h5>
<p>L’utilisateur peut rechercher :</p>
<ul class="simple">
<li><p>une unité archivistique en particulier et accéder à son détail,</p></li>
<li><p>une unité archivistique pour une transaction donnée.</p></li>
</ul>
<p>Il est possible de :</p>
<ul class="simple">
<li><p>limiter le nombre de résultats retournés au moyen d’un seuil de requête ;</p></li>
<li><p>obtenir :</p>
<ul>
<li><p>une liste de résultats, incluant l’ensemble des métadonnées des unités archivistiques ou une sélection,</p></li>
<li><p>le nombre exact de résultats, s’il dépasse les 10 000 unités d’archives, au moyen d’un paramétrage de la plate-forme.</p></li>
<li><p>un résultat par facettes (nombre d’occurrences pour une métadonnée donnée).</p></li>
</ul>
</li>
</ul>
<p><em><strong>Point d’attention :</strong></em>
le seuil de résultats supporté par le moteur d’indexation Elastic Search est de 10 000 unités archivistiques. Il est de fait recommandé d’utiliser des requêtes ne dépassant pas les 10 000 résultats.</p>
<p><em>Exemple : requête en vue d’obtenir l’unité archivistique dont l’identifiant est « aeeaaaaaaceezldyaamscambcvdf6zyaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="nd">@unit</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">***</span><span class="n">aeeaaaaaaceezldyaamscambcvdf6zyaaaaq</span><span class="o">***</span>
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">units</span><span class="o">/</span><span class="p">{{</span><span class="n">unit</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span>
  
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">143</span>
  
  <span class="p">{</span>
  <span class="p">}</span>
</pre></div>
</div>
<p><em>Exemple : requête en vue d’obtenir les unités archivistiques de la transaction dont l’identifiant est « aeeaaaaaaceezldyaamscambcvdf6zyaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=*</span> <span class="o">**</span><span class="n">aeeaaaaaaceezldyaamscambcvdf6zyaaaaq</span><span class="o">***</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">units</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">143</span>
  <span class="p">{</span>
   <span class="s2">&quot;$roots&quot;</span><span class="p">:</span> <span class="p">[],</span>
   <span class="s2">&quot;$query&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
   <span class="s2">&quot;$eq&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;#unitType&quot;</span><span class="p">:</span> <span class="s2">&quot;INGEST&quot;</span>
   <span class="p">}</span>
   <span class="p">}],</span>
   <span class="s2">&quot;$filter&quot;</span><span class="p">:</span> <span class="p">{},</span>
   <span class="s2">&quot;$projection&quot;</span><span class="p">:</span> <span class="p">{}</span>
  <span class="p">}</span>
</pre></div>
</div>
<p><em>Exemple : requête en vue d’obtenir les unités archivistiques de la transaction dont l’identifiant est « aeeaaaaaaceezldyaamscambcvdf6zyaaaaq » et ayant pour tout ou partie du champ Title la valeur « Bulletin »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=*</span> <span class="o">**</span><span class="n">aeeaaaaaaceezldyaamscambcvdf6zyaaaaq</span><span class="o">***</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">units</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">143</span>
  
  <span class="p">{</span>
   <span class="s2">&quot;$roots&quot;</span><span class="p">:</span> <span class="p">[],</span>
   <span class="s2">&quot;$query&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;$match&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Bulletin&quot;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">],</span>
   <span class="s2">&quot;$filter&quot;</span><span class="p">:</span> <span class="p">{},</span>
   <span class="s2">&quot;$projection&quot;</span><span class="p">:</span> <span class="p">{}</span>
  <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id51">
<h5><span class="section-number">14.3.3.3.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id51" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet d’accéder aux unités archivistiques d’une transaction.</p>
<p>Ce service est disponible :</p>
<ul class="simple">
<li><p>depuis la page permettant de visualiser l’ensemble des projets de versement,</p></li>
<li><p>depuis la page permettant de visualiser l’ensemble des transactions (ou versements)</p></li>
</ul>
<p>Ces deux accès mènent à une page permettant de :</p>
<ul class="simple">
<li><p>visualiser l’ensemble des unités archivistiques d’une transaction,</p></li>
<li><p>rechercher dans cette liste selon de nombreux critères de recherche,</p></li>
<li><p>consulter les métadonnées d’une unité archivistique en particulier.</p></li>
</ul>
</section>
</section>
<section id="acces-aux-groupes-d-objets-techniques">
<h4><span class="section-number">14.3.3.4. </span>Accès aux groupes d’objets techniques<a class="headerlink" href="#acces-aux-groupes-d-objets-techniques" title="Lien vers cette rubrique"></a></h4>
<section id="id52">
<h5><span class="section-number">14.3.3.4.1. </span>Utilisation des API<a class="headerlink" href="#id52" title="Lien vers cette rubrique"></a></h5>
<p>L’utilisateur peut récupérer :</p>
<ul class="simple">
<li><p>les métadonnées techniques d’un groupe d’objets techniques donné,</p></li>
<li><p>l’objet numérique associé à une unité archivistique donnée.</p></li>
</ul>
<p><em>Exemple : requête en vue d’obtenir le groupe d’objets techniques dont l’identifiant est « aeeaaaaaaceezldyaamscambcvdf6zyaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="nd">@got</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">***</span><span class="n">aeeaaaaaaceezldyaamscambcvdf6zyaaaaq</span><span class="o">***</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">objects</span><span class="o">/</span><span class="p">{{</span><span class="n">got</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">143</span>
  
  <span class="p">{</span>
  <span class="p">}</span>
</pre></div>
</div>
<p><em>Exemple : requête en vue d’obtenir l’objet technique d’usage « BinaryMaster » et de version « 1 » associé à l’unité archivistique dont l’identifiant est « aeeaaaaaaceezldyaamscambcvdf6zyaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="nd">@unit</span><span class="o">-</span><span class="nb">id</span><span class="o">=*</span> <span class="o">**</span><span class="n">aeeaaaaaaceezldyaamscambcvdf6zyaaaaq</span><span class="o">***</span>
  
  <span class="n">GET</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">units</span><span class="o">/</span><span class="p">{{</span><span class="n">unit</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">objects</span><span class="o">/</span><span class="n">BinaryMaster</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">binary</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">octet</span><span class="o">-</span><span class="n">stream</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  
  <span class="p">{</span>
  <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id53">
<h5><span class="section-number">14.3.3.4.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id53" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office Vitam UI fournie avec la solution logicielle Vitam permet d’accéder aux métadonnées techniques d’un groupe d’objets techniques ainsi qu’aux différents usages et versions d’un objet technique.</p>
<p>Ce service est disponible depuis la page permettant de visualiser l’ensemble des unités archivistiques d’une transaction au sein de l’onglet « Objet » du panneau latéral d’une unité archivistique. Il est également possible d’y télécharger les différents objets techniques.</p>
</section>
</section>
</section>
<section id="gestion-des-transactions">
<h3><span class="section-number">14.3.4. </span>Gestion des transactions<a class="headerlink" href="#gestion-des-transactions" title="Lien vers cette rubrique"></a></h3>
<section id="id54">
<h4><span class="section-number">14.3.4.1. </span>Définitions<a class="headerlink" href="#id54" title="Lien vers cette rubrique"></a></h4>
<p>Le module de collecte a vocation à permettre d’effectuer un certain nombre de traitement en amont du versement au niveau de la transaction.</p>
<p>Au terme de la V8.1, il est possible de réaliser les actions suivantes :</p>
<ul class="simple">
<li><p>modification des informations relatives à l’en-tête du versement,</p></li>
<li><p>suppression d’une transaction et de son contenu,</p></li>
<li><p>abandon d’une transaction et de son contenu,</p></li>
<li><p>réouverture d’une transaction (ou versement),</p></li>
<li><p>clôture et validation de la transaction (ou versement),</p></li>
<li><p>transfert de la transaction (ou versement) depuis le module de collecte vers le back-office de la solution logicielle Vitam sous la forme d’un SIP conforme au SEDA 2.2.,</p></li>
<li><p>si le transfert est en succès ou en avertissement, suppression automatique des archives qui sont associées à la transaction.</p></li>
</ul>
<p>Ces actions sont propres à chaque tenant de la solution logicielle Vitam.</p>
<p>Elles ne sont pas journalisées dans le journal des opérations.
Seule l’opération de transfert des archives sous la forme d’un SIP, envoyée par le module de collecte, est tracée dans le journal des opérations (opération de type « INGEST »).</p>
<p><em><strong>Point d’attention :</strong></em>
L’ordre d’utilisation des API doit être respecté, notamment en vue de transférer avec succès l’ensemble des métadonnées et objets constituant un versement vers la solution logicielle Vitam pour conservation.</p>
</section>
<section id="modification-d-une-transaction">
<h4><span class="section-number">14.3.4.2. </span>Modification d’une transaction<a class="headerlink" href="#modification-d-une-transaction" title="Lien vers cette rubrique"></a></h4>
<section id="id55">
<h5><span class="section-number">14.3.4.2.1. </span>Utilisation des API<a class="headerlink" href="#id55" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet de modifier une transaction, et plus précisément de :</p>
<ul class="simple">
<li><p>modifier ses métadonnées,</p></li>
<li><p>lui ajouter des métadonnées,</p></li>
<li><p>supprimer des métadonnées.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em> En prérequis à cette action, il faut avoir au préalable créé :</p>
<ul class="simple">
<li><p>un projet de versement ;</p></li>
<li><p>une transaction.</p></li>
</ul>
<p><em>Exemple : requête en vue de modifier des métadonnées d’une transaction dont l’identifiant est « aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq » et dont le projet de versement associé a l’identifiant « aeaaaaaaaaecafogaeyu2amw2sbvtmaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">PUT</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">401</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  
  <span class="p">{</span>
   <span class="s2">&quot;#id&quot;</span><span class="p">:</span> <span class="s2">&quot;**aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq**&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ArchivalAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Vitam&quot;</span><span class="p">,</span>
   <span class="s2">&quot;TransferringAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
   <span class="s2">&quot;OriginatingAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
   <span class="s2">&quot;SubmissionAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;RATP&quot;</span><span class="p">,</span>
   <span class="s2">&quot;MessageIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;20200131-000001&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ArchivalAgreement&quot;</span><span class="p">:</span><span class="s2">&quot;IC-000001&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Comment&quot;</span><span class="p">:</span> <span class="s2">&quot;RH - bulletins de salaire (février 2020)&quot;</span><span class="p">,</span>
   <span class="s2">&quot;AcquisitionInformation&quot;</span><span class="p">:</span><span class="s2">&quot;Versement&quot;</span><span class="p">,</span>
   <span class="s2">&quot;LegalStatus&quot;</span><span class="p">:</span><span class="s2">&quot;Public Archive&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ProjectId&quot;</span><span class="p">:</span><span class="s2">&quot;**aeaaaaaaaaecafogaeyu2amw2sbvtmaaaaaq**&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>Le service de mise à jour d’une transaction fonctionne en mode « annule et remplace ».</p></li>
<li><p>La plupart des champs d’une transaction étant facultatifs, il est recommandé d’indiquer les éléments obligatoires à la génération d’un SIP :</p>
<ul>
<li><p>le contrat d’entrée (champ « ArchivalAgreement »),</p></li>
<li><p>l’identifiant du message (champ « MessageIdentifier),</p></li>
<li><p>le service producteur (champ « OriginatingAgencyIdentifier »),</p></li>
<li><p>le service d’archivage (champ « ArchivalAgencyIdentifier »),</p></li>
<li><p>le service responsable du transfert (« TransferringAgencyIdentifier »)</p></li>
</ul>
</li>
<li><p>Au terme de la version 8.1 :</p>
<ul>
<li><p>ce service ne vérifie pas le caractère obligatoire d’un champ. Il est fortement recommandé de veiller à ne pas supprimer un champ obligatoire, de manière à éviter de possibles échecs lors des étapes de contrôles des données référentielles du processus d’entrée (opération « INGEST ») ;</p></li>
<li><p>on ne peut pas ajouter de règles de gestion dans une transaction ;</p></li>
<li><p>aucun contrôle n’est effectué avec les référentiels et unités archivistiques de rattachement présents dans la solution logicielle Vitam. De fait, il est fortement recommandé de :</p>
<ul>
<li><p>veiller à inclure des références (ex. service producteur, contrat d’entrée, etc.) existant dans la solution, de manière à éviter de possibles échecs lors des étapes de contrôles des données référentielles du processus d’entrée (opération « INGEST ») ;</p></li>
<li><p>ne pas envoyer dans le module de collecte des éléments sans valeurs, en particulier ceux qui sont obligatoires et doivent nécessairement être renseignés.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Cette action provoque la mise à jour de la transaction.</p>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Présence d’un champ inconnu dans la requête ;<br>- La transaction n’existe pas.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id56">
<h5><span class="section-number">14.3.4.2.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id56" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet de modifier uniquement les informations de description et de contexte d’une transaction.</p>
<p>Ce service est disponible depuis la modification d’un projet de versement dans son panneau latéral uniquement si le choix est fait dans la pop-in s’affichant lors de l’enregistrement des modifications de les appliquer à la transaction en cours (ou versement en édition).</p>
</section>
</section>
<section id="suppression-d-une-transaction">
<h4><span class="section-number">14.3.4.3. </span>Suppression d’une transaction<a class="headerlink" href="#suppression-d-une-transaction" title="Lien vers cette rubrique"></a></h4>
<section id="id57">
<h5><span class="section-number">14.3.4.3.1. </span>Utilisation des API<a class="headerlink" href="#id57" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet de supprimer une transaction.</p>
<p><em><strong>Point d’attention :</strong></em> En prérequis à cette action, il faut avoir au préalable créé une transaction et le signaler dans l’API.</p>
<p><em>Exemple : requête en vue de supprimer une transaction dont l’identifiant est «  aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span><span class="o">*</span>
  
  <span class="n">DELETE</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span>
  <span class="n">accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
 
</pre></div>
</div>
<p>Ces actions provoquent :</p>
<ul class="simple">
<li><p>la suppression de l’enregistrement dans la base de données MongoDB, dans la collection « Transaction » (base <em>Collect</em>).</p></li>
<li><p>si la transaction contient des archives (unités archivistiques, objets techniques), la suppression de l’ensemble des données associées à cette transaction de la base de données et des offres de stockage :</p>
<ul>
<li><p>les unités archivistiques sont supprimées de la collection « Unit » (base <em>MetadataCollect</em>) ;</p></li>
<li><p>les groupes d’objets techniques sont supprimés de la collection « ObjectGroup » (base <em>MetadataCollect</em>).</p></li>
<li><p>les objets sont supprimés des offres de stockage.</p></li>
</ul>
</li>
</ul>
<p>Mais le projet de versement ne sera pas supprimé.</p>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- La transaction n’existe pas.<br>- La transaction n’est pas reconnue dans la requête.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id58">
<h5><span class="section-number">14.3.4.3.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id58" title="Lien vers cette rubrique"></a></h5>
<p>Il n’est pas possible de supprimer une transaction depuis l’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam.</p>
</section>
</section>
<section id="abandon-d-une-transaction">
<h4><span class="section-number">14.3.4.4. </span>Abandon d’une transaction<a class="headerlink" href="#abandon-d-une-transaction" title="Lien vers cette rubrique"></a></h4>
<section id="id59">
<h5><span class="section-number">14.3.4.4.1. </span>Utilisation des API<a class="headerlink" href="#id59" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet également d’abandonner une transaction<a class="footnote-reference brackets" href="#id150" id="id60" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>.</p>
<p><em><strong>Point d’attention :</strong></em>
En prérequis à cette action, il faut avoir au préalable créé une transaction et le signaler dans l’API.</p>
<p><em>Exemple : requête en vue d’abandonner une transaction dont l’identifiant est «  aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span><span class="o">*</span>
  
  <span class="n">PUT</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">abort</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  
  <span class="p">{}</span>
</pre></div>
</div>
<p>Cette action provoque :</p>
<ul class="simple">
<li><p>la modification de l’enregistrement dans la base de données MongoDB, dans la collection « Transaction » (base <em>Collect</em>) : la valeur du champ « Status » devient « ABORTED » ;</p></li>
<li><p>la purge des données associées à la transaction, enregistrées dans les collections « Unit » et « ObjectGroup » (base <em>MetadataCollect</em>) et sur les offres de stockage, passé un certain délai configurable par tenant (60 minutes par défaut)<a class="footnote-reference brackets" href="#id151" id="id61" role="doc-noteref"><span class="fn-bracket">[</span>19<span class="fn-bracket">]</span></a>.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em></p>
<ul>
<li><p>Une transaction peut être abandonnée uniquement lorsque son statut est égal à « OPEN », « READY », « ACK_KO », « KO ».</p>
<p>Si elle a un statut égal à « SENDING », « SENT », « ACK_OK », « ACK_WARNING », elle ne peut pas l’être<a class="footnote-reference brackets" href="#id150" id="id62" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>.</p>
</li>
<li><p>La différence avec l’action de suppression est que l’abandon :</p>
<ul class="simple">
<li><p>ne purge pas les archives directement, mais de manière automatisée, passé un certain délai ;</p></li>
<li><p>ne supprime pas la transaction ;</p></li>
<li><p>donne lieu à une mise à jour du statut de la transaction.</p></li>
</ul>
</li>
</ul>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- La transaction n’existe pas.<br>- La transaction n’est pas reconnue dans la requête.<br>- La transaction a un statut égal à « SENDING », « SENT », « ACK_OK », « ACK_WARNING ».</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id63">
<h5><span class="section-number">14.3.4.4.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id63" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet d’abandonner une transaction. Son statut passe alors à « Abandonné »<a class="footnote-reference brackets" href="#id150" id="id64" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>.</p>
<p>Ce service est disponible depuis la page permettant de visualiser l’ensemble des transactions (ou versements) via un bouton « Abandonner » présent dans les boutons d’actions secondaires.</p>
<p><em><strong>Point d’attention:</strong></em> Le bouton est inactif quand la transaction a un statut « Préparation et envoi du SIP » (« SENDING »), « Envoyé, en cours de traitement du SAE » (« SENT »), « Versé avec succès » (« ACK_OK »), « Versé en avertissement » (« ACK_WARNING »).</p>
<p>Des droits utilisateurs sont par ailleurs définis :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Profil utilisateur</p></th>
<th class="head"><p>Abandon d’une transaction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Administrateur</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Archiviste</p></td>
<td><p>non</p></td>
</tr>
<tr class="row-even"><td><p>Service producteur</p></td>
<td><p>non</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="reouverture-d-une-transaction">
<h4><span class="section-number">14.3.4.5. </span>Réouverture d’une transaction<a class="headerlink" href="#reouverture-d-une-transaction" title="Lien vers cette rubrique"></a></h4>
<section id="id65">
<h5><span class="section-number">14.3.4.5.1. </span>Utilisation des API<a class="headerlink" href="#id65" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet également de rouvrir (ou rééditer) une transaction<a class="footnote-reference brackets" href="#id150" id="id66" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>.</p>
<p><em><strong>Point d’attention :</strong></em> En prérequis à cette action, il faut avoir au préalable créé une transaction et le signaler dans l’API.</p>
<p><em>Exemple : requête en vue de réouvrir une transaction dont l’identifiant est «  aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span><span class="o">*</span>
  
  <span class="n">PUT</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="n">aeeaaaaabohhxsvcaaxnqamfooffxkqaaaaq</span><span class="o">/</span><span class="n">reopen</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
  
  <span class="p">{}</span>
</pre></div>
</div>
<p>Cette action provoque la modification de l’enregistrement dans la base de données MongoDB, dans la collection « Transaction » (base <em>Collect</em>) : la valeur du champ « Status » devient « OPEN ».</p>
<p>Dès lors, il est à nouveau possible de :</p>
<ul class="simple">
<li><p>associer à la transaction rouverte des unités archivistiques, ainsi que des groupes d’objets techniques et des objets numériques ;</p></li>
<li><p>modifier, réorganiser et supprimer des unités archivistiques.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>Une transaction peut être rouverte uniquement lorsque son statut est égal à « READY », « ACK_KO », « KO ».</p></li>
<li><p>Si elle a un statut égal à « OPEN », « SENDING », « SENT », « ACK_OK », « ACK_WARNING », « ABORTED », elle ne peut pas l’être.</p></li>
</ul>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- La transaction n’existe pas.<br>- La transaction n’est pas reconnue dans la requête.<br>- La transaction a un statut égal à « OPEN », « SENDING », « SENT », « ACK_OK », « ACK_WARNING », « ABORTED ».</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id67">
<h5><span class="section-number">14.3.4.5.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id67" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet de rouvrir ou éditer une transaction<a class="footnote-reference brackets" href="#id150" id="id68" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>. Son statut passe alors à « Ouvert en édition ».</p>
<p>Ce service est disponible depuis la page permettant de visualiser l’ensemble des transactions (ou versements) d’un projet via un bouton « Editer » présent dans les boutons d’actions secondaires.</p>
<p><em><strong>Point d’attention</strong></em>: Le bouton est inactif quand la transaction a un statut « Ouvert en édition » (« OPEN »), « Préparation et envoi du SIP » (« SENDING »), « Envoyé, en cours de traitement du SAE » (« SENT »), « Versé avec succès » (« ACK_OK »), « Versé en avertissement » (« ACK_WARNING »), « Abandonné » (« ABORTED »).</p>
<p>Des droits utilisateurs sont par ailleurs définis :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Profil utilisateur</p></th>
<th class="head"><p>Réouverture de transaction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Administrateur</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Archiviste</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-even"><td><p>Service producteur</p></td>
<td><p>non</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="validation-d-une-transaction">
<h4><span class="section-number">14.3.4.6. </span>Validation d’une transaction<a class="headerlink" href="#validation-d-une-transaction" title="Lien vers cette rubrique"></a></h4>
<section id="id69">
<h5><span class="section-number">14.3.4.6.1. </span>Utilisation des API<a class="headerlink" href="#id69" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle permet de clôturer une transaction<a class="footnote-reference brackets" href="#id150" id="id70" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>, une fois l’ensemble des archives liées à cette transaction envoyées dans cette dernière et ne nécessitant plus de traitements.</p>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>Cette action est un prérequis à l’envoi d’un SIP depuis le module de collecte vers la solution logicielle Vitam.</p></li>
<li><p>Il faut avoir au préalable créé une transaction et la signaler dans l’API.</p></li>
</ul>
<p><em>Exemple : requête de clôture</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">**</span><span class="n">aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq</span><span class="o">**</span>
  <span class="nd">@unit</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="n">aeeaaaaaaghiyso4ablmyal74sndwiqaaaaq</span>
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">POST</span>  <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/**</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">**/</span><span class="n">close</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">ContratTNR</span>
  
  <span class="p">{}</span>
</pre></div>
</div>
<p>Cette action provoque la modification de l’enregistrement dans la base de données MongoDB, dans la collection « Transaction » (base <em>Collect</em>) :</p>
<ul class="simple">
<li><p>la valeur du champ « Status » est désormais « READY » ;</p></li>
<li><p>si le paramètre « AutomaticIngest » présent dans le projet de versement associé à la transaction a une valeur « true », la valeur du champ « Status » est désormais « SENDING » et/ou « SENT », car la transaction est directement clôturée et envoyée dans la solution logicielle Vitam.</p></li>
</ul>
<p><em>Exemple : enregistrement de la transaction dans la collection « Transaction »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaaghdvam4abgoyambfxnhd6aaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="s2">&quot;READY&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Context&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;ArchivalAgreement&quot;</span><span class="p">:</span> <span class="s2">&quot;IC-000001&quot;</span><span class="p">,</span>
   <span class="s2">&quot;MessageIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;20220302-000005&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ArchivalAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Vitam&quot;</span><span class="p">,</span>
   <span class="s2">&quot;TransferringAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;AN&quot;</span><span class="p">,</span>
   <span class="s2">&quot;OriginatingAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
   <span class="s2">&quot;SubmissionAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Versement du service producteur : Cabinet de Michel Mercier&quot;</span>
   <span class="p">},</span>
   <span class="s2">&quot;CreationDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-10-15T15:50:06.153&quot;</span><span class="p">,</span>
   <span class="s2">&quot;LastUpdate&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-15T15:50:06.153&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ProjectId&quot;</span><span class="p">:</span> <span class="s2">&quot;aeaaaaaaaaha7iacabzrsamepp45blyaaaaq&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_tenant&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Dès lors, si la transaction a un statut « READY », il n’est plus possible de :</p>
<ul class="simple">
<li><p>associer à cette transaction des unités archivistiques, ainsi que des groupes d’objets techniques et des objets numériques ;</p></li>
<li><p>modifier, réorganiser et supprimer des unités archivistiques.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>Une transaction peut être validée uniquement lorsque son statut est égal à « OPEN ».</p></li>
<li><p>Si elle a un statut égal à « SENDING », « SENT », « ACK_OK », « ACK_WARNING », « ACK_KO », « ABORTED », « KO », elle ne peut pas l’être.</p></li>
</ul>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- La transaction associée n’existe pas ;<br>- La transaction associée a déjà été clôturée.</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Point d’attention :</strong></em>
S’il s’avère nécessaire de modifier le contenu d’une transaction ayant un statut « READY », il est toujours possible à ce stade la rouvrir<a class="footnote-reference brackets" href="#id152" id="id71" role="doc-noteref"><span class="fn-bracket">[</span>21<span class="fn-bracket">]</span></a>.</p>
</section>
<section id="id72">
<h5><span class="section-number">14.3.4.6.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id72" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam utilise l’API de clôture pour valider une transaction (ou versement).</p>
<p>Ce service est disponible :</p>
<ul class="simple">
<li><p>depuis la page permettant de visualiser l’ensemble des archives d’un projet de versement, où il est possible de :</p>
<ul>
<li><p>« Valider » un versement, action correspondant à la clôture du versement ;</p></li>
</ul>
</li>
<li><p>depuis la page permettant de visualiser l’ensemble des transactions (ou versements) associées à un projet de versement, où il est possible de :</p>
<ul>
<li><p>« Valider » un versement, action correspondant à la clôture du versement<a class="footnote-reference brackets" href="#id150" id="id73" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>.</p></li>
</ul>
</li>
</ul>
<p><em><strong>Point d’attention :</strong></em> Le bouton est :</p>
<ul class="simple">
<li><p>actif quand la transaction a un statut « Ouvert en édition » (« OPEN »),</p></li>
<li><p>inactif quand la transaction a un statut « Préparation et envoi du SIP » (« SENDING »), « Envoyé, en cours de traitement du SAE » (« SENT »), « Versé avec succès » (« ACK_OK »), « Versé en avertissement » (« ACK_WARNING »), « Echec du versement » (« ACK_KO »), « Erreur technique » (« KO »), « Abandonné » (« ABORTED »).</p></li>
</ul>
<p>Des droits utilisateurs sont par ailleurs définis :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Profil utilisateur</p></th>
<th class="head"><p>Validation d’une transaction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Administrateur</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Archiviste</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-even"><td><p>Service producteur</p></td>
<td><p>oui</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="envoi-d-une-transaction">
<h4><span class="section-number">14.3.4.7. </span>Envoi d’une transaction<a class="headerlink" href="#envoi-d-une-transaction" title="Lien vers cette rubrique"></a></h4>
<section id="id74">
<h5><span class="section-number">14.3.4.7.1. </span>Utilisation des API<a class="headerlink" href="#id74" title="Lien vers cette rubrique"></a></h5>
<p>Pour une transaction donnée, une fois celle-ci clôturée, le module de collecte permet de générer un SIP et de le transférer au moyen d’une opération de type « INGEST »<a class="footnote-reference brackets" href="#id150" id="id75" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>.</p>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à l’envoi du SIP, il faut avoir au préalable clôturé la transaction (son statut doit être égal à « READY ») et signaler cette dernière dans l’API.</p></li>
<li><p>Cette action peut être automatisée si le paramètre « AutomaticIngest » présent dans le projet de versement associé à la transaction a une valeur « true ». Dès lors, dès validation de la transaction, la transaction est directement clôturée et envoyée dans la solution logicielle Vitam.</p></li>
</ul>
<p><em>Exemple : requête d’envoi du SIP vers la solution logicielle Vitam pour conservation</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="o">**</span><span class="n">aeeaaaaaaghiyso4ablmyal74slqwtqaaaaq</span><span class="o">**</span>
  <span class="nd">@unit</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="n">aeeaaaaaaghiyso4ablmyal74sndwiqaaaaq</span>
  <span class="nd">@tenant</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="n">POST</span>  <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="o">**</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">**</span><span class="p">}}</span><span class="o">/</span><span class="n">send</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">ContratTNR</span>
  
  <span class="p">{</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Cette action provoque<a class="footnote-reference brackets" href="#id150" id="id76" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a> :</p>
<ul class="simple">
<li><p>si elle est en erreur technique :</p>
<ul>
<li><p>la modification de l’enregistrement dans la base de données MongoDB, dans la collection « Transaction » (base <em>Collect</em>) : la valeur du champ « Status » est « KO » ;</p></li>
</ul>
</li>
<li><p>si elle est conforme :</p>
<ul>
<li><p>l’initialisation d’une opération de type « INGEST »,</p></li>
<li><p>la modification de l’enregistrement dans la base de données MongoDB, dans la collection « Transaction » (base <em>Collect</em>) :</p>
<ul>
<li><p>la valeur du champ « Status » est :</p>
<ul>
<li><p>« SENDING » tant que l’opération de type « INGEST » n’a pas été initialisée par la solution logicielle Vitam,</p></li>
<li><p>« SENT » quand l’opération de type « INGEST » est en cours ;</p></li>
</ul>
</li>
<li><p>un champ correspondant à l’identifiant de l’opération d’entrée est ajouté (VitamOperationId).Une fois l’opération de type « INGEST » terminée, le statut est :</p>
<ul>
<li><p>si l’opération est en succès, la valeur du champ « Status » est désormais « ACK_OK » ; si l’opération est en avertissement, la valeur du champ « Status » est « ACK_WARNING » ;</p></li>
<li><p>si l’opération est en erreur, la valeur du champ « Status » est « ACK_KO ».</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- La transaction associée n’existe pas ;<br>- La transaction associée n’a pas été clôturée ;<br>- La transaction ne contient pas d’archives associées (unités archivistiques et groupes d’objets techniques).</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Point d’attention :</strong></em>
Au terme de la version 8.1, les archives transférées avec succès ou en avertissement (statut égal à « ACK_OK » et « ACK_WARNING ») pour archivage sont purgées du module de collecte passé un certain délai configurable par tenant (60 minutes par défaut)<a class="footnote-reference brackets" href="#id153" id="id77" role="doc-noteref"><span class="fn-bracket">[</span>22<span class="fn-bracket">]</span></a>.</p>
</section>
<section id="id78">
<h5><span class="section-number">14.3.4.7.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id78" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam utilise l’API de génération d’un SIP pour envoi dans la solution logicielle Vitam.</p>
<p>Ce service est disponible :</p>
<ul class="simple">
<li><p>depuis la page permettant de visualiser l’ensemble des archives d’un projet de versement, où il est possible de :</p>
<ul>
<li><p>« Verser » un versement, action correspondant à l’envoi du SIP.</p></li>
</ul>
</li>
<li><p>depuis la page permettant de visualiser l’ensemble des transactions (ou versements) associées à un projet de versement, où il est possible de :</p>
<ul>
<li><p>« Verser » un versement, action correspondant à l’envoi du SIP<a class="footnote-reference brackets" href="#id150" id="id79" role="doc-noteref"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></a>.</p></li>
</ul>
</li>
</ul>
<p><em><strong>Point d’attention :</strong></em> Le bouton est :</p>
<ul class="simple">
<li><p>actif quand la transaction a un statut « Validé » (« READY »),</p></li>
<li><p>inactif quand la transaction a un statut « Ouvert en édition » (« OPEN »), « Préparation et envoi du SIP » (« SENDING »), « Envoyé, en cours de traitement du SAE » (« SENT »), « Versé avec succès » (« ACK_OK »), « Versé en avertissement » (« ACK_WARNING »), « Echec du versement » (« ACK_KO »), « Erreur technique » (« KO »), « Abandonné » (« ABORTED »).</p></li>
</ul>
<p>Cette action entraîne la purge des archives passé un certain délai, si le résultat est un versement en succès ou en avertissement.</p>
<p>Des droits utilisateurs sont par ailleurs définis :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Profil utilisateur</p></th>
<th class="head"><p>Validation d’une transaction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Administrateur</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Archiviste</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-even"><td><p>Service producteur</p></td>
<td><p>non</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="gestion-des-archives">
<h3><span class="section-number">14.3.5. </span>Gestion des archives<a class="headerlink" href="#gestion-des-archives" title="Lien vers cette rubrique"></a></h3>
<section id="id80">
<h4><span class="section-number">14.3.5.1. </span>Définitions<a class="headerlink" href="#id80" title="Lien vers cette rubrique"></a></h4>
<p>Le module de collecte a vocation à permettre d’effectuer un certain nombre de traitements sur les archives en amont du versement.</p>
<p>Au terme de la V8.1, il est possible de réaliser les actions suivantes :</p>
<ul class="simple">
<li><p>modification,</p></li>
<li><p>ajout d’une à plusieurs unités archivistiques sous une unité archivistique,</p></li>
<li><p>réorganisation d’arborescences,</p></li>
<li><p>suppression.</p></li>
</ul>
<p>Ces actions sont propres à chaque tenant de la solution logicielle Vitam.</p>
<p>Sont journalisées dans le journal des opérations :</p>
<ul class="simple">
<li><p>réorganisation d’arborescences,</p></li>
<li><p>suppression.
Ne sont pas journalisées dans le journal des opérations :</p></li>
<li><p>modification,</p></li>
<li><p>ajout d’une à plusieurs unités archivistiques sous une unité archivistique.</p></li>
</ul>
</section>
<section id="modification-des-metadonnees">
<h4><span class="section-number">14.3.5.2. </span>Modification des métadonnées<a class="headerlink" href="#modification-des-metadonnees" title="Lien vers cette rubrique"></a></h4>
<p>La solution logicielle Vitam permet de modifier des unités archivistiques par :</p>
<ul class="simple">
<li><p>une mise à jour unitaire en masse de métadonnées,</p></li>
<li><p>import d’un fichier au format .csv,</p></li>
<li><p>import d’un fichier au format .jsonl.</p></li>
</ul>
<section id="modification-unitaire-en-masse">
<h5><span class="section-number">14.3.5.2.1. </span>Modification unitaire en masse<a class="headerlink" href="#modification-unitaire-en-masse" title="Lien vers cette rubrique"></a></h5>
<section id="id81">
<h6><span class="section-number">14.3.5.2.1.1. </span>Utilisation des API<a class="headerlink" href="#id81" title="Lien vers cette rubrique"></a></h6>
<p>La solution logicielle Vitam permet de mettre à jour unitairement plusieurs unités archivistiques. Pour chacune d’entre elles, elle permet plus précisément de :</p>
<ul class="simple">
<li><p>modifier des métadonnées descriptives,</p></li>
<li><p>ajouter des métadonnées descriptives,</p></li>
<li><p>supprimer des métadonnées descriptives.</p></li>
</ul>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à la mise à jour unitaire en masse des unités archivistiques, il faut avoir au préalable créé une transaction et le signaler dans l’API ;</p></li>
<li><p>Il n’est pas possible d’ajouter une unité archivistique lors de cette action de mise à jour ;</p></li>
<li><p>Il n’est pas possible de mettre à jour des règles de gestion lors de cette action de mise à jour.</p></li>
</ul>
<p><em>Exemple : requête en vue de modifier un titre pour une unité archivistique dont l’identifiant d’agent est « 123456 », de supprimer une date d’envoi et d’ajouter une description pour une unité archivistique dont l’identifiant d’agent est « 123457 »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span><span class="o">*</span>

<span class="n">POST</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">units</span><span class="o">/</span><span class="n">bulk</span>
<span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>

<span class="p">{</span>
  <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="s2">&quot;queries&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;$query&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;$eq&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Agent.Identifier&quot;</span><span class="p">:</span> <span class="s2">&quot;123456&quot;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;$action&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;$set&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Nouveau titre&quot;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;$query&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;$eq&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Agent.Identifier&quot;</span><span class="p">:</span> <span class="s2">&quot;123457&quot;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;$action&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;$unset&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;SentDate&quot;</span> <span class="p">]</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;$set&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;Description mise à jour&quot;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cette action provoque la mise à jour des unités archivistiques dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id154" id="id82" role="doc-noteref"><span class="fn-bracket">[</span>18<span class="fn-bracket">]</span></a></em>).</p>
<p><em><strong>Points d’attention :</strong></em>
L’API est synchrone et bloquante. L’action de mise à jour peut donc prendre quelques instants avant d’être effective.</p>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Le seuil de requête est dépassé. <br>- Plusieurs unités archivistiques ont été trouvées. <br>- Aucune unité archivistique n’a été trouvée. <br>- Le format de la métadonnées à modifier n’est pas conforme au type d’indexation défini dans l’ontologie.</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>L’échec ne concerne pas l’action en général, mais est spécifique à une unité archivistique en particulier.</p></li>
<li><p>La requête utilise le langage de requête DSL de type mise à jour unitaire de masse (BULK UPDATE) de la solution logicielle Vitam en entrée.</p></li>
<li><p>Le nombre de requêtes unitaires doit rester raisonnable, idéalement pas plus de 1000 par appel. Il est limité à un seuil maximum de 100 000 unités archivistiques par défaut. Ce seuil peut être redéfini dans la requête via le paramètre de seuil (threshold).</p></li>
</ul>
<p>Elle n’est pas journalisée dans le journal des opérations.</p>
</section>
<section id="id83">
<h6><span class="section-number">14.3.5.2.1.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id83" title="Lien vers cette rubrique"></a></h6>
<p>Depuis l’APP « Collecte et préparation des versements », le service de « modification unitaire en masse » est utilisé pour une modification unitaire.
Il n’est pas disponible pour effectuer une modification de masse depuis cette APP.</p>
</section>
</section>
<section id="modification-par-import-de-fichier-csv">
<h5><span class="section-number">14.3.5.2.2. </span>Modification par import de fichier .csv<a class="headerlink" href="#modification-par-import-de-fichier-csv" title="Lien vers cette rubrique"></a></h5>
<section id="id84">
<h6><span class="section-number">14.3.5.2.2.1. </span>Utilisation des API<a class="headerlink" href="#id84" title="Lien vers cette rubrique"></a></h6>
<p>La solution logicielle permet de modifier des métadonnées descriptives et de gestion au moyen de l’import d’un fichier au format .csv. Il est plus précisement possible de :</p>
<ul class="simple">
<li><p>modifier des métadonnées descriptives et/ou de gestion,</p></li>
<li><p>ajouter des métadonnées descriptives et/ou de gestion.</p></li>
</ul>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à la mise à jour des unités archivistiques, il faut avoir au préalable créé :</p>
<ul>
<li><p>une transaction et le signaler dans l’API ;</p></li>
<li><p>les unités archivistiques qui sont référencées dans le fichier .csv ;</p></li>
</ul>
</li>
<li><p>Il n’est pas possible de :</p>
<ul>
<li><p>supprimer une métadonnée avec ce mode ;</p></li>
<li><p>ajouter une unité archivistique lors de cette action de mise à jour.</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : requête en vue de modifier des métadonnées d’unités archivistiques associées à une transaction dont l’identifiant est «  aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span>
  
  <span class="n">PUT</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="o">**</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">**</span><span class="p">}}</span><span class="o">/</span><span class="n">units</span><span class="o">/</span><span class="n">metadata</span><span class="o">/</span><span class="n">csv</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">octet</span><span class="o">-</span><span class="n">stream</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
  
  <span class="o">&lt;</span> <span class="o">/</span><span class="n">path_tozip</span><span class="o">/</span><span class="n">stream</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
<p>Pour une transaction donnée, peut être envoyé un fichier .csv contenant des métadonnées détaillant unitairement tout ou partie des unités archivistiques préalablement envoyées.</p>
<p>Le fichier .csv est composé de x colonnes<a class="footnote-reference brackets" href="#id155" id="id85" role="doc-noteref"><span class="fn-bracket">[</span>17<span class="fn-bracket">]</span></a> :</p>
<ul class="simple">
<li><p>File : chemin relatif à partir de l’emplacement où est positionnée l’unité archivistique faisant l’objet de la modification. Il s’agit d’une concaténation des intitulés des différentes unités archivistiques (colonne obligatoire) ;</p></li>
<li><p>toute colonne correspondant à un champ du standard SEDA et nécessitant une modification et/ou un ajout de métadonnées (colonnes facultatives) ;</p></li>
<li><p>le cas échéant, toute colonne correspondant à une métadonnée externe du standard SEDA  et nécessitant une modification et/ou un ajout de métadonnées (colonnes facultatives).</p></li>
</ul>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>le fichier .csv n’est pas obligatoirement intitulé « metadata.csv » ;</p></li>
<li><p>l’ordre des premières colonnes ne doit pas être modifié ;</p></li>
<li><p>une première ligne d’en-tête donnant le nom des colonnes doit être présente, chaque ligne décrivant ensuite une unité archivistique ;</p></li>
<li><p>le séparateur entre les colonnes est le point-virgule, le séparateur de texte les guillemets doubles et l’encodage est « UTF-8 » ;</p></li>
<li><p>le fichier .csv ne référence que des métadonnées propres aux unités archivistiques (métadonnées descriptives et de gestion).</p></li>
<li><p>concernant le nommage des colonnes :</p>
<ul>
<li><p>pour les colonnes correspondant à des champs du standard SEDA, l’intitulé de la colonne doit correspondre à celui du champ dans le standard SEDA, précédé de « Management. » s’il s’agit d’une métadonnée de gestion (ex. « Management.AccessRule.Rule » pour une règle de communicabilité) ou de « Content. » s’il s’agit d’une métadonnée descriptive (ex. « Content.DocumentType ») ;</p></li>
<li><p>pour les colonnes correspondant à des métadonnées externes au standard SEDA, l’intitulé de la colonne doit correspondre à celui du champ, précédé de « Content. » ;</p></li>
<li><p>quand le schéma XML du standard SEDA propose une structure complexe de balises (par exemple pour décrire un auteur via l’objet XML Writer; qui contient plusieurs balises XML comme FullName ou BirthName), il convient d’intituler la colonne de la manière suivante : Content.Writer.FullName ou Content.Writer.BirthName ;</p></li>
<li><p>quand un champ ou un objet XML est multivalué dans le standard SEDA (et qu’il est possible d’en décrire plusieurs dans le bordereau comme c’est le cas pour l’objet Writer par exemple), il convient de numéroter la colonne de la manière suivante : Content.Writer.0.FullName, Content.Writer.1.FullName ;</p></li>
</ul>
</li>
<li><p>concernant le contenu des colonnes :</p>
<ul>
<li><p>la colonne File :</p>
<ul>
<li><p>indique la position de l’unité archivistique dans l’arborescence de la transaction, depuis l’unité archivistique racine jusqu’à l’unité archivistique décrite. Il s’agit là d’une <strong>concaténation des intitulés des différentes unités archivistiques</strong>.</p></li>
<li><p>ne doit pas comprendre d’espace avant ou après les « / » ;</p></li>
<li><p>doit correspondre à un chemin tel que décrit par l’explorateur de fichiers (avec des « / ») ;</p></li>
</ul>
</li>
<li><p>la colonne DescriptionLevel, si elle est présente, ne doit comprendre que les valeurs autorisées par le standard SEDA : Collection, Fonds, Series, SubSeries, RecordGrp, File, Item ;</p></li>
<li><p>les colonnes correspondant à des champs Date dans le standard SEDA doivent être formatées conformément à la norme ISO 8601 (AAAA-MM-JJ) ;</p></li>
<li><p>les références à des règles de gestion doivent se conformer aux identifiants de règles présents dans le SAE ;</p></li>
<li><p>les dates de début (Content.StartDate) doivent être antérieures aux dates de fin (Content.EndDate).</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : fichier .csv de mise à jour des métadonnées (ajout ou modification des dates de début et de fin pour les unités archivistiques intitulées « AU1 » et « AU2 »)</em></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>  File;Content.DescriptionLevel;Content.Title;Content.StartDate;Content.EndDate
  &quot;content/AU1&quot;;&quot;Item&quot;;&quot;AU1&quot;;&quot;1970-06-03&quot;;&quot;1980-06-03&quot;
  &quot;content/AU2&quot;;&quot;Item&quot;;&quot;AU2&quot;;&quot;1970-06-03&quot;;&quot;1980-06-03&quot;
  &quot;content/AU3&quot;;&quot;Item&quot;;&quot;AU3&quot;;&quot;&quot;;&quot;&quot;
  &quot;content/AU4&quot;;&quot;Item&quot;;&quot;AU4&quot;;&quot;&quot;;&quot;&quot;
</pre></div>
</div>
<p>Cette action provoque la mise à jour des unités archivistiques dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id154" id="id86" role="doc-noteref"><span class="fn-bracket">[</span>18<span class="fn-bracket">]</span></a></em>).
Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Avertissement</p></td>
<td><p>Le formatage du fichier .csv contient au moins une erreur (ex. date mal formatée, valeur attendue erronée, date de début postérieure à la date de fin, etc.)</p></td>
</tr>
<tr class="row-even"><td><p>Échec</p></td>
<td><p>- Le fichier .csv n’est pas au format .csv. <br>- Le fichier .csv contient des erreurs dans la colonne File. <br>- Action non réalisée pour cause de nom erroné ou de chemin introuvable dans la requête.<br>- La transaction n’existe pas ou est erronée.<br>- La transaction a un statut « READY », « SENDING », « SEND », « ACK_OK », « ACK_WARNING », « ACK_KO », « KO », « ABORTED ».</p></td>
</tr>
</tbody>
</table>
<p>Elle n’est pas journalisée dans le journal des opérations.</p>
<p><em><strong>Point d’attention :</strong></em> Au terme de la V.8.1, le module de collecte peut :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-  bloquer la mise à jour si le fichier .csv dernier comporte les erreurs suivantes :
   -   il ne contient pas au moins la colonne obligatoire File ;
   -   au moins un fichier référencé dans le fichier .csv n&#39;est pas présent dans l&#39;arborescence bureautique,
   -   il ne contient aucune information ;
   -   il ne contient pas de séparateurs de champs ;
   -   il contient des virgules, des espaces, des pipes comme séparateurs de champs ;
   -   le fichier contient des simples guillemets comme séparateurs de texte ;
   -   etc.
   L&#39;API peut :
       - soit renvoyer une seule erreur, si cette erreur est bloquante,
	   - soit renvoyer jusqu&#39;à 20 erreurs, si ces erreurs sont cumulables.

-  ne pas bloquer la mise à jour si le fichier .csv dernier comporte les erreurs suivantes :
   -   il dispose d’un champ dont le contenu est mal formaté (ex. ReceivedDate écrite en chaîne de caractères) ;
Une erreur est alors renvoyée par l’API, le contenu du fichier .csv sera ignoré.
</pre></div>
</div>
<ul class="simple">
<li><p>Il ne permet pas de :</p>
<ul>
<li><p>supprimer une métadonnée avec ce mode de mise à jour par envoi de fichier .csv ;</p></li>
<li><p>ajouter un rattachement à une unité archivistique (UpdateOperation).</p></li>
</ul>
</li>
</ul>
</section>
<section id="id87">
<h6><span class="section-number">14.3.5.2.2.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id87" title="Lien vers cette rubrique"></a></h6>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet de modifier tout ou partie des unités archivistiques d’une transaction au moyen de l’import d’un fichier .csv.</p>
<p>Ce service est disponible depuis la page permettant de visualiser l’ensemble des archives d’un projet de versement, où il est possible de « Mettre à jour les métadonnées ».</p>
<p><em><strong>Point d’attention</strong></em>: Le bouton est :</p>
<ul class="simple">
<li><p>actif quand la transaction a un statut « Ouvert en édition » (« OPEN »),</p></li>
<li><p>inactif quand la transaction a un statut « Validé » (« READY »), « Préparation et envoi du SIP » (« SENDING »), « Envoyé, en cours de traitement du SAE » (« SENT »), « Versé avec succès » (« ACK_OK »), « Versé en avertissement » (« ACK_WARNING »), « Echec du versement » (« ACK_KO »), « Erreur technique » (« KO »), « Abandonné » (« ABORTED »).</p></li>
</ul>
<p>Des droits utilisateurs sont par ailleurs définis :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Profil utilisateur</p></th>
<th class="head"><p>Validation d’une transaction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Administrateur</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Archiviste</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-even"><td><p>Service producteur</p></td>
<td><p>non</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="modification-par-import-de-fichier-jsonl">
<h5><span class="section-number">14.3.5.2.3. </span>Modification par import de fichier .jsonl<a class="headerlink" href="#modification-par-import-de-fichier-jsonl" title="Lien vers cette rubrique"></a></h5>
<section id="id88">
<h6><span class="section-number">14.3.5.2.3.1. </span>Utilisation des API<a class="headerlink" href="#id88" title="Lien vers cette rubrique"></a></h6>
<p>La solution logicielle permet de modifier des métadonnées descriptives et de gestion au moyen de l’import d’un fichier au format .jsonl. Il est plus précisement possible de :</p>
<ul class="simple">
<li><p>modifier des métadonnées descriptives et/ou de gestion,</p></li>
<li><p>ajouter des métadonnées descriptives et/ou de gestion.</p></li>
</ul>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à la mise à jour des unités archivistiques, il faut avoir au préalable créé :</p>
<ul>
<li><p>une transaction et le signaler dans l’API ;</p></li>
<li><p>les unités archivistiques qui sont référencées dans le fichier .jsonl ;</p></li>
</ul>
</li>
<li><p>Il n’est pas possible de :</p>
<ul>
<li><p>supprimer une métadonnée avec ce mode ;</p></li>
<li><p>ajouter une unité archivistique lors de cette action de mise à jour.</p></li>
</ul>
</li>
</ul>
<p><em>Exemple : requête en vue de modifier des métadonnées d’unités archivistiques associées à une transaction dont l’identifiant est «  aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span>
  
  <span class="n">PUT</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="o">**</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">**</span><span class="p">}}</span><span class="o">/</span><span class="n">units</span><span class="o">/</span><span class="n">metadata</span><span class="o">/</span><span class="n">jsonl</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">octet</span><span class="o">-</span><span class="n">stream</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
  
  <span class="o">&lt;</span> <span class="o">/</span><span class="n">path_tozip</span><span class="o">/</span><span class="n">stream</span><span class="o">.</span><span class="n">jsonl</span>
</pre></div>
</div>
<p>Pour une transaction donnée, peut être envoyé un fichier .jsonl contenant des métadonnées détaillant unitairement tout ou partie des unités archivistiques préalablement envoyées.</p>
<p>Le fichier .jsonl, obligatoirement intitulé « metadata.jsonl », est composé de :</p>
<ul class="simple">
<li><p>File : chemin relatif à partir de l’emplacement où est positionnée l’unité archivistique faisant l’objet de la modification. Il s’agit d’une concaténation des intitulés des différentes unités archivistiques (champ obligatoire) ;</p></li>
<li><p>Selector : liste de conditions permettant l’enregistrement des métadonnées dans une unité archivistique correspond à ces conditions (champ obligatoire) ;</p></li>
<li><p>UnitContent : bloc dans lequel sont insérées les métadonnées descriptives et de gestion d’une unité archivistique nécessitant d’être modifiée (champ obligatoire), dont :</p>
<ul>
<li><p>DescriptionLevel : niveau de description de l’unité archivistique (champ facultatif) ;</p></li>
<li><p>Title : intitulé de l’unité archivistique (champ facultatif) ;</p></li>
<li><p>tout champ correspondant à un champ du standard SEDA   et nécessitant une modification et/ou un ajout de métadonnées (champs facultatifs) ;</p></li>
<li><p>le cas échéant, tout champ correspondant à un champ externe au standard SEDA   et nécessitant une modification et/ou un ajout de métadonnées (champs facultatifs).</p></li>
</ul>
</li>
</ul>
<p><em><strong>Points d’attention :</strong></em></p>
<ul class="simple">
<li><p>le fichier .jsonl n’est pas obligatoirement intitulé « metadata.jsonl » ;</p></li>
<li><p>le fichier .jsonl doit toujours contenir un champ File <em>ou</em> un champ Selector. Celui-ci doit toujours être placée en première position ;</p></li>
<li><p>les métadonnées pouvant être utilisées comme conditions dans le champ Selector doivent des éléments simples de type string, boolean, long ou double.</p></li>
<li><p>le fichier .jsonl ne référence que des métadonnées propres aux unités archivistiques (métadonnées descriptives et de gestion). Il ne supporte pas les métadonnées techniques propres aux fichiers numériques ;</p></li>
<li><p>le nommage des champs et leur structuration en JSON doivent se conformer au modèle de données de la solution logicielle Vitam.</p></li>
<li><p>concernant le contenu des champs :</p>
<ul>
<li><p>le champ File :</p>
<ul>
<li><p>ne doit pas comprendre d’espace avant ou après les « / » ;</p></li>
<li><p>doit correspondre à un chemin tel que décrit par l’explorateur de fichiers (avec des « / ») ;</p></li>
</ul>
</li>
<li><p>le champ DescriptionLevel ne doit comprendre que les valeurs autorisées par le standard SEDA : Collection, Fonds, Series, SubSeries, RecordGrp, File, Item ;</p></li>
<li><p>les champs correspondant à des champs Date dans le standard SEDA doivent être formatés conformément à la norme ISO 8601 (AAAA-MM-JJ) ;</p></li>
<li><p>les références à des règles de gestion et à des profils d’unité archivistique doivent se conformer aux identifiants de règles présents dans le SAE</p></li>
</ul>
</li>
<li><p>Les dates de début (Content.StartDate) doivent être antérieures aux dates de fin (Content.EndDate).</p></li>
</ul>
<p><em>Exemple : fichier .jsonl de mise à jour des métadonnées</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Selector&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;#uploadPath&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span><span class="s2">&quot;#tenant&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span><span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Series&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;Modification de la description&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;EndDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Paie&quot;</span><span class="p">]</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;Selector&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span><span class="s2">&quot;Item&quot;</span><span class="p">,</span><span class="s2">&quot;OriginatingSystemId&quot;</span><span class="p">:</span><span class="s2">&quot;BP_123456_20230131&quot;</span><span class="p">,</span><span class="s2">&quot;#tenant&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span><span class="s2">&quot;UnitContent&quot;</span><span class="p">:{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;BP_123456_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;OriginatingSystemId&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;BP_123456_20230131&quot;</span><span class="p">],</span> <span class="s2">&quot;SentDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;AcquiredDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Salaire&quot;</span><span class="p">,</span><span class="s2">&quot;Bulletin de paie&quot;</span><span class="p">,</span> <span class="s2">&quot;tot&quot;</span><span class="p">],</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00001&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span> <span class="p">},</span> <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00016&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}}</span>
</pre></div>
</div>
<p>Cette action provoque la mise à jour des unités archivistiques dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id154" id="id89" role="doc-noteref"><span class="fn-bracket">[</span>18<span class="fn-bracket">]</span></a></em>).
Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Avertissement</p></td>
<td><p>Le formatage du fichier .jsonl contient au moins une erreur (ex. date mal formatée, valeur attendue erronée, date de début postérieure à la date de fin, etc.)</p></td>
</tr>
<tr class="row-even"><td><p>Échec</p></td>
<td><p>- Le fichier .jsonl n’est pas au format .jsonl.<br>- Le fichier .jsonl contient des erreurs dans la colonne File ou Selector.<br>- Action non réalisée pour cause de nom erroné ou de chemin introuvable dans la requête.<br>- La transaction n’existe pas ou est erronée.<br>La transaction a un statut « READY », « SENDING », « SEND », « ACK_OK », « ACK_WARNING », « ACK_KO », « KO », « ABORTED ».</p></td>
</tr>
</tbody>
</table>
<p>Elle n’est pas journalisée dans le journal des opérations.</p>
<p><em><strong>Point d’attention :</strong></em> Au terme de la V.8.1, le module de collecte peut :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-  bloquer la mise à jour si le fichier .jsonl dernier comporte les erreurs suivantes :
   -   il ne contient pas au moins le champ obligatoire File ou Selector ;
   -   au moins un bloc UnitContent ne contient aucune information ;
   -   au moins un fichier référencé dans le fichier .jsonl n&#39;est pas présent dans l&#39;arborescence bureautique,
   -   il ne contient aucune information ;
   -   une date de fin de règle a été intégrée dans le fichier .jsonl ;
   -   il dispose d’un champ dont le contenu est mal formaté (ex. ReceivedDate écrite en chaîne de caractères) ;
   -   etc.
   L&#39;API peut :
       - soit renvoyer une seule erreur, si cette erreur est bloquante,
	   - soit renvoyer jusqu&#39;à 20 erreurs, si ces erreurs sont cumulables.

-  ne pas bloquer la mise à jour si le fichier .jsonl dernier comporte les erreurs suivantes :
   -   il dispose d’un champ dont le contenu est mal formaté (ex. ReceivedDate écrite en chaîne de caractères) ;
Une erreur est alors renvoyée par l’API, le contenu du fichier .jsonl sera ignoré partiellement.
</pre></div>
</div>
<ul class="simple">
<li><p>Il ne permet pas de :</p>
<ul>
<li><p>supprimer une métadonnée avec ce mode de mise à jour par envoi de fichier .jsonl ;</p></li>
<li><p>ajouter un rattachement à une unité archivistique (UpdateOperation).</p></li>
</ul>
</li>
</ul>
</section>
<section id="id90">
<h6><span class="section-number">14.3.5.2.3.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id90" title="Lien vers cette rubrique"></a></h6>
<p>Il n’est pas possible de mettre à jour des unités archivistiques au moyen d’un import de fichier .jsonl depuis l’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam.</p>
</section>
</section>
</section>
<section id="reorganisation-des-arborescences">
<h4><span class="section-number">14.3.5.3. </span>Réorganisation des arborescences<a class="headerlink" href="#reorganisation-des-arborescences" title="Lien vers cette rubrique"></a></h4>
<section id="id91">
<h5><span class="section-number">14.3.5.3.1. </span>Utilisation des API<a class="headerlink" href="#id91" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet de modifier l’organisation de l’arborescence des unités archivistiques d’une transaction. Il est possible de :</p>
<ul class="simple">
<li><p>rattacher une unité archivistique à une unité archivistique, en respectant l’organisation hiérarchique de l’information,</p></li>
<li><p>modifier un rattachement préexistant,</p></li>
<li><p>ajouter un rattachement,</p></li>
<li><p>supprimer un lien hiérarchique entre une unité archivistique et une autre, ce qui signifie qu’on peut supprimer un sous-niveau d’un niveau de description parent.</p></li>
</ul>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à cette action, il faut avoir au préalable créé une transaction et le signaler dans l’API.</p></li>
<li><p>A noter qu’au terme de la version 8.1, il n’est pas possible de modifier la(les) position(s) de rattachement de la transaction, qu’elle(s) soi(en)t statique ou dynamique(s).</p></li>
</ul>
<p><em>Exemple : requête en vue de déplacer l’unité d’archives dont l’identifiant est «  aeaqaaaaaeecohy6ab4heamu7jl5epqaaaba »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span><span class="o">*</span>
  
<span class="n">POST</span> <span class="p">{{</span><span class="n">url</span><span class="o">-</span><span class="n">collect</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">reclassification</span>
<span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>

<span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;$roots&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;$query&quot;</span><span class="p">:</span> <span class="p">[{</span> <span class="s2">&quot;$eq&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;#id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeaqaaaaaeecohy6ab4heamu7jl5epqaaaba&quot;</span> <span class="p">}</span> <span class="p">}],</span>
    <span class="s2">&quot;$action&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;$pull&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;#unitups&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;aeaqaaaaaeecohy6ab4heamu7jl5epqaaaaq&quot;</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;$add&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;#unitups&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;aeaqaaaaaeecohy6ab4heamu7jl5ejqaaaaq&quot;</span> <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>Action non réalisée :<br>- L’unité archivistique de destination semble inexistante ou inaccessible,<br>- L’unité archivistique à déplacer semble inexistante dans la transaction.</p></td>
</tr>
</tbody>
</table>
<p>Elle est journalisée dans le journal des opérations (COLLECT_RECLASSIFICATION).</p>
</section>
<section id="id92">
<h5><span class="section-number">14.3.5.3.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id92" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet dans la page de consultation des archives d’un projet de versement de :</p>
<ul class="simple">
<li><p>modifier un rattachement préexistant,</p></li>
<li><p>ajouter un rattachement,</p></li>
<li><p>supprimer un lien hiérarchique entre une unité archivistique et une autre.</p></li>
</ul>
<p>Des droits utilisateurs sont par ailleurs définis :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Profil utilisateur</p></th>
<th class="head"><p>Suppression d’archives</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Administrateur</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Archiviste</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-even"><td><p>Service producteur</p></td>
<td><p>non</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ajout-d-archives">
<h4><span class="section-number">14.3.5.4. </span>Ajout d’archives<a class="headerlink" href="#ajout-d-archives" title="Lien vers cette rubrique"></a></h4>
<section id="id93">
<h5><span class="section-number">14.3.5.4.1. </span>Utilisation des API<a class="headerlink" href="#id93" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet d’ajouter des unités archivistiques à une transaction donnée.</p>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>En prérequis à cette action, il faut avoir au préalable créé une transaction et le signaler dans l’API.</p></li>
<li><p>Le(s) document(s) ajouté(s) doivent être compressé(s) au format .zip.</p></li>
</ul>
<p><em>Exemple : requête en vue d’ajouter une ou plusieurs unité(s) archivistique(s) à une transaction dont l’identifiant est «  aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span><span class="o">*</span>
  
<span class="n">POST</span> <span class="p">{{</span><span class="n">url</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">upload</span>
<span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="nb">zip</span>
<span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
<span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>
<span class="o">*</span><span class="n">X</span><span class="o">-</span><span class="n">Attachement</span><span class="o">-</span><span class="n">Id</span> <span class="p">:</span> <span class="n">guid</span><span class="o">-</span><span class="n">de</span><span class="o">-</span><span class="n">au</span><span class="o">-</span><span class="n">cible</span><span class="o">*</span>

<span class="o">&lt;</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">doc_a_ajouter</span><span class="o">.</span><span class="n">zip</span>
</pre></div>
</div>
<p>Cette action provoque :</p>
<ul class="simple">
<li><p>la création des unités archivistiques dans la base de données MongoDB, dans la collection « Unit » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id143" id="id94" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></em>). Sont enregistrés automatiquement<a class="footnote-reference brackets" href="#id144" id="id95" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a> :</p></li>
</ul>
<p>-   un niveau de description (DescriptionLevel) dont la valeur est :</p>
<p>-   « RecordGrp » pour une unité archivistique référençant un répertoire,
        -   « Item » pour une unité archivistique référençant un objet numérique ;</p>
<p>-   un intitulé (Title), correspondant au nom d’un répertoire ou d’un objet binaire présent dans l’arborescence bureautique.</p>
<p>À chaque enregistrement, sont associés :
-   l’identifiant de la transaction (_opi) ;
-   un identifiant de batch (_batchId) ;
-   la localisation initiale du dossier ou du fichier dans l’arborescence (_uploadPath),
-   l’identifiant du service producteur (_sp et _sps) ;</p>
<ul class="simple">
<li><p>la création de métadonnées techniques dans la base de données MongoDB, dans la collection « ObjectGroup » (base <em>MetadataCollect<a class="footnote-reference brackets" href="#id145" id="id96" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a></em>) ;</p></li>
</ul>
<p>À chaque enregistrement, sont associés :
-   l’identifiant de la transaction (_opi) ;
-   un identifiant de batch (_batchId) ;
-   l’identifiant du service producteur (_sp) ;</p>
<ul class="simple">
<li><p>l’enregistrement des objets numériques sur les offres de stockage.</p></li>
<li><p>la mise à jour des métadonnées techniques de l’objet avec, calculés lors de l’envoi du fichier numérique :</p></li>
</ul>
<p>-   ajout de l’empreinte d’un fichier numérique,
    -   ajout de l’identification de son format,
    -   mise à jour de son poids exprimé en octets.</p>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Échec</p></td>
<td><p>- Le fichier .zip n’a pas été téléchargé pour cause de nom erroné ou de chemin introuvable.<br>- La transaction n’existe pas ou est erronée.<br>- La transaction a été clôturée.<br>- L’identifiant technique de la position cible est erroné.</p></td>
</tr>
</tbody>
</table>
<p>Elle n’est pas journalisée dans le journal des opérations.</p>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>Aucun fichier ne doit avoir un poids équivalent à 0 octet.</p></li>
<li><p>Au terme de la V.8.1, il est recommandé que les noms de répertoires et de fichiers ne contiennent ni caractère accentué, ni virgule, ni apostrophe, ni parenthèse, ni espace, ni élément de ponctuation, ou tout autre caractère spécial. Ne sont à privilégier que l’underscore et le tiret comme séparateurs.
    Néanmoins, s’ils en contiennent et si l’arborescence bureautique émane d’un environnement Windows, il est recommandé d’utiliser l’outil Winzip pour la zipper, afin d’éviter des problèmes d’encodage.</p></li>
</ul>
</section>
<section id="id97">
<h5><span class="section-number">14.3.5.4.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id97" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet d’ajouter des archives supplémentaires dans une transaction, en choisissant sa position cible dans l’arborescence, au moyen d’un wizard ou boîte de dialogue contenant une fenêtre d’upload.</p>
</section>
</section>
<section id="suppression-d-archives">
<h4><span class="section-number">14.3.5.5. </span>Suppression d’archives<a class="headerlink" href="#suppression-d-archives" title="Lien vers cette rubrique"></a></h4>
<section id="id98">
<h5><span class="section-number">14.3.5.5.1. </span>Utilisation des API<a class="headerlink" href="#id98" title="Lien vers cette rubrique"></a></h5>
<p>La solution logicielle Vitam permet de supprimer une à plusieurs unités archivistiques d’une transaction donnée.</p>
<p><em><strong>Point d’attention :</strong></em> En prérequis à cette action, il faut avoir au préalable créé une transaction et le signaler dans l’API, pour une suppression d’unités archivistiques.</p>
<p><em>Exemple : requête en vue de supprimer l’unité d’archives dont l’identifiant est «  aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="nd">@transaction</span><span class="o">-</span><span class="nb">id</span><span class="o">=</span> <span class="o">*</span><span class="n">aeeaaaaaachj3m7nabjocamcdqr2rqaaaaaq</span><span class="o">*</span>
  
  <span class="n">POST</span> <span class="p">{{</span><span class="n">url</span><span class="o">-</span><span class="n">collect</span><span class="p">}}</span><span class="o">/</span><span class="n">collect</span><span class="o">-</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">transactions</span><span class="o">/</span><span class="p">{{</span><span class="n">transaction</span><span class="o">-</span><span class="nb">id</span><span class="p">}}</span><span class="o">/</span><span class="n">deletion</span><span class="o">/</span><span class="n">action</span>
  <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Tenant</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">tenant</span><span class="p">}}</span>
  <span class="n">X</span><span class="o">-</span><span class="n">Access</span><span class="o">-</span><span class="n">Contract</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="p">{{</span><span class="n">access</span><span class="o">-</span><span class="n">contract</span><span class="p">}}</span>

<span class="p">{</span>
  <span class="s2">&quot;dslRequest&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;$roots&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;$query&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
      <span class="s2">&quot;$eq&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;#id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeeaaaaaagecohy6ab4heamu6wrl5hiaaaaq&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;$threshold&quot;</span><span class="p">:</span> <span class="mi">10</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cette action provoque la suppression :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-   des unités archivistiques de la collection « Unit » (base *MetadataCollect*) ;
-   des groupes d’objets techniques de la collection « ObjectGroup » (base *MetadataCollect*).
-   des objets des offres de stockage ;
</pre></div>
</div>
<p>Lors de cette action, l’opération peut aboutir aux résultats suivants :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Statut</p></th>
<th class="head"><p>Motifs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Succès</p></td>
<td><p>Action réalisée sans rencontrer de problèmes particuliers.</p></td>
</tr>
<tr class="row-odd"><td><p>Avertissement</p></td>
<td><p>Au moins une des unités archivistiques ne peut pas être supprimée car elle(s) a(ont) des enfants (NON_DESTROYABLE_HAS_CHILD_UNITS).</p></td>
</tr>
<tr class="row-even"><td><p>Échec</p></td>
<td><p>Le seuil de requête est dépassé.</p></td>
</tr>
</tbody>
</table>
<p>Elle est journalisée dans le journal des opérations (COLLECT_DELETION).</p>
</section>
<section id="id99">
<h5><span class="section-number">14.3.5.5.2. </span>Utilisation dans VitamUI<a class="headerlink" href="#id99" title="Lien vers cette rubrique"></a></h5>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam permet de supprimer une à plusieurs unités archivistiques d’une transaction et, de fait, les objets numériques associés.</p>
<p>Des droits utilisateurs sont par ailleurs définis :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Profil utilisateur</p></th>
<th class="head"><p>Suppression d’archives</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Administrateur</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Archiviste</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-even"><td><p>Service producteur</p></td>
<td><p>non</p></td>
</tr>
</tbody>
</table>
<p>Les opérations de suppression sont journalisées et leur résultat accessible depuis l’APP « Journal des opérations ».</p>
</section>
</section>
</section>
</section>
<section id="conseils-de-mise-en-oeuvre">
<h2><span class="section-number">14.4. </span>Conseils de mise en œuvre<a class="headerlink" href="#conseils-de-mise-en-oeuvre" title="Lien vers cette rubrique"></a></h2>
<p>À l’issue de cette phase de réalisation de fonctionnalités concernant le module de collecte, l’équipe du programme Vitam est en mesure de fournir plusieurs recommandations de mise en œuvre.</p>
<section id="comment-formaliser-les-donnees-dans-les-api-du-module-de-collecte">
<h3><span class="section-number">14.4.1. </span>Comment formaliser les données dans les API du module de collecte ?<a class="headerlink" href="#comment-formaliser-les-donnees-dans-les-api-du-module-de-collecte" title="Lien vers cette rubrique"></a></h3>
<p>Il est possible de verser séparément dans le module de collecte selon un formalisme spécifique au format JSON :</p>
<ul class="simple">
<li><p>les métadonnées correspondant à l’en-tête du message ArchiveTransfer,</p></li>
<li><p>les métadonnées décrivant les unités archivistiques,</p></li>
<li><p>les métadonnées techniques.</p></li>
</ul>
<p>Chaque appel API<a class="footnote-reference brackets" href="#id156" id="id100" role="doc-noteref"><span class="fn-bracket">[</span>23<span class="fn-bracket">]</span></a> permettant de verser ces métadonnées inclut une liste d’éléments, clés ou vocabulaires que l’on souhaite intégrer dans le module de collecte.</p>
<p>Si ces éléments doivent respecter le formalisme attendu par le SEDA et l’ontologie de la solution logicielle Vitam (s’il s’agit d’une chaîne de caractères, d’une date, d’un élément répétable, etc.), il n’est pas nécessaire de les ordonnancer comme le demande le SEDA.</p>
<p>Si certains éléments, issus du SEDA et/ou du système externe, ne doivent pas être envoyés, il n’est pas nécessaire de les référencer dans les différents appels API<a class="footnote-reference brackets" href="#id157" id="id101" role="doc-noteref"><span class="fn-bracket">[</span>24<span class="fn-bracket">]</span></a>.</p>
<p>Certains contrôles, disponibles au moment du transfert dans la solution logicielle Vitam n’ont pas été implémentés. Il est fortement recommandé de ne pas envoyer dans le module de collecte des éléments sans valeurs, en particulier ceux qui sont obligatoires et doivent nécessairement être renseignés.</p>
<section id="generalites">
<h4><span class="section-number">14.4.1.1. </span>Généralités<a class="headerlink" href="#generalites" title="Lien vers cette rubrique"></a></h4>
<p>Dans un enregistrement JSON, un élément (ou vocabulaire) est désigné par son <strong>nom</strong>.</p>
<p><em>Exemple : l’élément suivant se nomme Description.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;Ceci est une description&quot;</span>
</pre></div>
</div>
<p><em><strong>Point d’attention :</strong></em></p>
<ul class="simple">
<li><p>Si un élément (ou vocabulaire), présent dans un enregistrement, n’existe pas dans l’ontologie, Il est fortement recommandé de l’avoir préalablement créé dans le référentiel<a class="footnote-reference brackets" href="#id158" id="id102" role="doc-noteref"><span class="fn-bracket">[</span>25<span class="fn-bracket">]</span></a>.</p></li>
<li><p>Les vocabulaires issus du SEDA sont nommés de la même manière qu’ils le sont dans le standard (ex. l’élément « Tag » défini dans le SEDA est référencé sous ce nom dans l’ontologie et doit être indiqué comme tel).</p></li>
<li><p>Il existe néanmoins quelques exceptions à cette règle :</p>
<ul>
<li><p>le bloc Management doit être déclaré sous le nom #management. La modélisation des catégories de règle de gestion attend :</p>
<ul>
<li><p>un sous-bloc « Rules » pouvant contenir 0 à n règles de gestion, non défini par le SEDA,</p></li>
<li><p>un sous-bloc « Inheritance » pouvant bloquer des règles de gestion, non défini par le SEDA. Ce sous-bloc peut également contenir l’élément « PreventRulesId » correspondant au champ « RefNonRuleId » du SEDA.</p></li>
</ul>
</li>
<li><p>si le bloc Event porte le nom « Event », ses sous-blocs doivent être renommés pour se conformer à l’ontologie :</p>
<ul>
<li><p>« EventIdentifier » en « evId »,</p></li>
<li><p>« EventTypeCode » en « evTypeProc »,</p></li>
<li><p>« EventType » en « evType »,</p></li>
<li><p>« EventDateTime » en « evDateTime »,</p></li>
<li><p>« EventDetail » en « evTypeDetail »,</p></li>
<li><p>« Outcome » en « outcome »,</p></li>
<li><p>« OutcomeDetail » en « outDetail »,</p></li>
<li><p>« OutcomeDetailMessage » en « outMessg »,</p></li>
<li><p>« EventDetailData » en « evDetData ».</p></li>
</ul>
</li>
<li><p>les éléments Title et Description, s’ils contiennent des attributs, seront intitulés « Title_ » et « Description_ » et devront définir des propriétés<a class="footnote-reference brackets" href="#id159" id="id103" role="doc-noteref"><span class="fn-bracket">[</span>26<span class="fn-bracket">]</span></a>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="types">
<h4><span class="section-number">14.4.1.2. </span>Types<a class="headerlink" href="#types" title="Lien vers cette rubrique"></a></h4>
<p>L’élément (ou vocabulaire) est associé à un <strong>type</strong> particulier<a class="footnote-reference brackets" href="#id160" id="id104" role="doc-noteref"><span class="fn-bracket">[</span>27<span class="fn-bracket">]</span></a>. On distingue plusieurs types JSON possibles :</p>
<ul class="simple">
<li><p>« string » : texte ;</p></li>
<li><p>« number » : nombre, entier ou décimal ;</p></li>
<li><p>« integer » : nombre entier ;</p></li>
<li><p>« boolean » : booléen dont la valeur est « true » ou false ;</p></li>
<li><p>« object » : objet ;</p></li>
<li><p>« array » : liste ou tableau de valeurs textuelles.</p></li>
</ul>
<p>Il doit alors être cohérent avec celui du vocabulaire tel qu’il est déclaré dans l’ontologie<a class="footnote-reference brackets" href="#id161" id="id105" role="doc-noteref"><span class="fn-bracket">[</span>28<span class="fn-bracket">]</span></a> :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type d’indexation dans l’ontologie</p></th>
<th class="head"><p>Type correspondant<br>dans un profil d’unité archivistique<br>Vocabulaire interne</p></th>
<th class="head"><p>Type correspondant<br>dans un profil d’unité archivistique<br>Vocabulaire externe</p></th>
<th class="head"><p>Commentaires</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TEXT</p></td>
<td><p>string ou [string]</p></td>
<td><p>[string]</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>KEYWORD</p></td>
<td><p>string ou [string]</p></td>
<td><p>[string]</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>DATE</p></td>
<td><p>string ou [string] + pattern date</p></td>
<td><p>[string] + pattern date</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>LONG</p></td>
<td><p>number ou integer <br> [number] ou [integer]</p></td>
<td><p>[number] ou [integer]</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>DOUBLE</p></td>
<td><p>number ou [number]</p></td>
<td><p>[number]</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>BOOLEAN</p></td>
<td><p>boolean ou [boolean]</p></td>
<td><p>[boolean]</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>GEO_POINT</p></td>
<td><p>string</p></td>
<td><p>[string]</p></td>
<td><p><em>L’équipe Vitam n’a pas investigué sur les usages de ce type d’indexation</em></p></td>
</tr>
<tr class="row-odd"><td><p>ENUM</p></td>
<td><p>[string] + pattern énumératif</p></td>
<td><p>[string] + pattern énumératif</p></td>
<td><p><em>L’équipe Vitam n’a pas investigué sur les usages de ce type d’indexation</em></p></td>
</tr>
</tbody>
</table>
<p>Par analogie au SEDA et au langage XML, il convient de prêter attention aux éléments suivants :</p>
<ul class="simple">
<li><p>sera qualifié en objet (« object ») un élément contenant des sous-éléments, par exemple : Management, Writer, Keyword ;</p></li>
<li><p>sera qualifié en tableau (ou « array ») :</p>
<ul>
<li><p>un élément répétable, tel que Tag ou OriginatingAgencyArchiveUnitIdentifier,</p></li>
<li><p>un vocabulaire externe ;</p></li>
</ul>
</li>
<li><p>certains éléments du SEDA (PreventInheritance, NeedAuthorization, NeedReassessingAuthorization) doivent contenir un booléen.</p></li>
</ul>
<p>On trouvera essentiellement les types suivants :</p>
<ul class="simple">
<li><p>pour les <strong>informations d’en-tête</strong> : les éléments sont uniquement de type « string » ou « array » ;</p></li>
<li><p>pour une <strong>unité archivistique</strong> :</p>
<ul>
<li><p>pour les <em>vocabulaires internes</em>, propres au SEDA, les principaux types rencontrés sont : « string », « array » et « object », auxquels s’ajoute un unique « boolean » et un unique « integer »<a class="footnote-reference brackets" href="#id162" id="id106" role="doc-noteref"><span class="fn-bracket">[</span>29<span class="fn-bracket">]</span></a>.</p></li>
<li><p>quant aux <em>vocabulaires externes</em>, ajoutés pour répondre à des besoins et transferts spécifiques, il faut les identifier systématiquement comme des « array » (ou tableaux), c’est-à-dire des éléments répétables. Ces tableaux peuvent inclure ensuite un type particulier de chaînes : texte, entier, décimal ou booléen.</p></li>
</ul>
</li>
<li><p>Pour un <strong>groupe d’objets techniques</strong>:</p>
<ul>
<li><p>pour les <em>vocabulaires internes</em>, propres au SEDA, les principaux types rencontrés sont : « string », « array » et « object », auxquels s’ajoutent quelques « integer » ou « number ».</p></li>
</ul>
</li>
</ul>
<p>Les éléments de type « array » et « object » ont une structuration plus complexe qu’un type simple :</p>
<ul class="simple">
<li><p>un type simple se définit par un nom, auquel est associé une seule valeur. Ce type est associé à un élément dont la cardinalité est 0-1 ou 1-1.</p></li>
</ul>
<p><em>Exemple : les vocabulaires Description, GpsAltitude et NeedAuthorization sont des éléments simples. Attendant un entier, Size est caractérisé par un item de type « integer », tandis que NeedAuthorization est de type « boolean ».</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;Ceci est une description&quot;</span>
  <span class="s2">&quot;GpsAltitude&quot;</span><span class="p">:</span> <span class="mi">390</span>
  <span class="s2">&quot;NeedAuthorization&quot;</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
<ul class="simple">
<li><p>un élément de type « array » peut contenir une liste ou un tableau de valeurs ou d’objets. Ce type est associé à un élément dont la cardinalité est 0-n ou 1-n.</p></li>
</ul>
<p><em>Exemple : les vocabulaires externes NomDuCapitaine, AgeDuCapitaine et le vocabulaire interne Tag sont dotés d’un type « array » dans l’enregistrement d’une unité archivistique. Attendant un entier, AgeDuCapitaine est caractérisé par un item de type « integer ».</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="s2">&quot;NomDuCapitaine&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Capitaine Fracasse&quot;</span><span class="p">],</span>
  <span class="s2">&quot;AgeDuCapitaine&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
  <span class="s2">&quot;Tag&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Marine&quot;</span><span class="p">,</span> <span class="s2">&quot;Capitaine Fracasse&quot;</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>un élément de type « object » définit des sous-éléments. Ce type peut être associé à un tableau de sous-éléments (ex. « RegisteredAgent »).</p></li>
</ul>
<p><em>Exemple :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="s2">&quot;RegisteredAgent&quot;</span><span class="p">:</span> <span class="p">[{</span>
   <span class="o">**</span><span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span><span class="o">**</span>
   <span class="s2">&quot;FullName&quot;</span><span class="p">:</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span>
   <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;description&quot;</span>
   <span class="p">}]</span>
  <span class="s2">&quot;BirthPlace&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="o">**</span><span class="s2">&quot;Geogname&quot;</span><span class="p">:</span> <span class="s2">&quot;Toronto [Ontario]&quot;</span><span class="p">,</span><span class="o">**</span>
   <span class="s2">&quot;Address&quot;</span><span class="p">:</span> <span class="s2">&quot;123 my Street&quot;</span><span class="p">,</span>
   <span class="s2">&quot;PostalCode&quot;</span><span class="p">:</span> <span class="s2">&quot;CD255&quot;</span><span class="p">,</span>
   <span class="s2">&quot;City&quot;</span><span class="p">:</span> <span class="s2">&quot;Toronto&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="s2">&quot;Ontario&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Country&quot;</span><span class="p">:</span> <span class="s2">&quot;Canada&quot;</span>
   <span class="p">}</span>
</pre></div>
</div>
<p>Enfin, en fonction du type d’indexation, les valeurs doivent être enregistrées</p>
<ul class="simple">
<li><p>soit entre guillemets (string)</p></li>
<li><p>soit sans guillemets (integer, number, boolean).</p></li>
</ul>
<p><em>Exemple : les vocabulaires Title, Size et NeedReassessingAuthorization sont des éléments simples : le premier est un string, le second un integer et le dernier un boolean.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Ceci est une description&quot;</span>
  <span class="s2">&quot;Size&quot;</span><span class="p">:</span> <span class="mi">390</span>
  <span class="s2">&quot;NeedReassessingAuthorization&quot;</span><span class="p">:</span> <span class="n">false</span>
</pre></div>
</div>
</section>
<section id="cas-particulier">
<h4><span class="section-number">14.4.1.3. </span>Cas particulier<a class="headerlink" href="#cas-particulier" title="Lien vers cette rubrique"></a></h4>
<p>Les éléments <strong>« Title » et « Description »</strong>, s’ils définissent un attribut ou sont répétables, doivent prendre la forme d’objet.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Title_&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="s2">&quot;Ceci est un titre en français&quot;</span><span class="p">,</span>
     <span class="s2">&quot;en&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a title in English&quot;</span>
<span class="p">}</span>
<span class="s2">&quot;Description_&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="s2">&quot;Ceci est une description en français&quot;</span><span class="p">,</span>
     <span class="s2">&quot;en&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a content in English&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Le bloc définissant les <strong>règles de gestion</strong> contient également des particularités. Il doit être déclaré sous le nom #management. La modélisation des catégories de règle de gestion attend :</p>
<ul class="simple">
<li><p>un sous-bloc « Rules » pouvant contenir 0 à n règles de gestion,</p></li>
<li><p>un sous-bloc « Inheritance » pouvant bloquer des règles de gestion<a class="footnote-reference brackets" href="#id163" id="id107" role="doc-noteref"><span class="fn-bracket">[</span>30<span class="fn-bracket">]</span></a>.</p></li>
</ul>
<p><em>Exemple : Le bloc AppraisalRule déclare deux règles différentes dans le sous-bloc Rules, « APP-00001 » et « APP-00002 », et définit un blocage sur la catégorie de règle avec le sous-bloc PreventInheritance.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
   <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00001&quot;</span><span class="p">,</span>
   <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-01-01&quot;</span><span class="p">,</span>
   <span class="s2">&quot;EndDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2095-01-01&quot;</span>
   <span class="p">},</span>
   <span class="p">{</span>
   <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00002&quot;</span>
   <span class="p">}</span> <span class="p">],</span>
   <span class="s2">&quot;Inheritance&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;PreventInheritance&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
   <span class="s2">&quot;PreventRulesId&quot;</span><span class="p">:</span> <span class="p">[]</span>
   <span class="p">},</span>
   <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Keep&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="comment-sont-geres-les-statuts-dune-transaction">
<h3><span class="section-number">14.4.2. </span>Comment sont gérés les statuts d’une transaction ?<a class="headerlink" href="#comment-sont-geres-les-statuts-dune-transaction" title="Lien vers cette rubrique"></a></h3>
<p><img alt="" src="../_images/statuts.png" /></p>
<p>Le module de collecte attribue un certain nombre de statuts à une transaction. Ces statuts sont générés à la suite d’une action :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Actions disponibles</p></th>
<th class="head"><p>Statut correspondant<br>dans le front-office</p></th>
<th class="head"><p>Statut correspondant<br>dans le back-office</p></th>
<th class="head"><p>Modification possible ?</p></th>
<th class="head"><p>Abandon possible ?</p></th>
<th class="head"><p>Purge automatique ?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Créer la transaction</p></td>
<td><p>Ouvert en édition</p></td>
<td><p>OPEN</p></td>
<td><p>OUI</p></td>
<td><p>OUI</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Clôturer / Valider</p></td>
<td><p>Validé</p></td>
<td><p>READY</p></td>
<td><p></p></td>
<td><p>OUI</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Verser / Envoyer</p></td>
<td><p>Préparation et envoi du SIP</p></td>
<td><p>SENDING</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Verser / Envoyer</p></td>
<td><p>Envoyé, en cours de traitement du SAE</p></td>
<td><p>SENT</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Verser / Envoyer</p></td>
<td><p>Versé en succès</p></td>
<td><p>ACK_OK</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>OUI</p></td>
</tr>
<tr class="row-odd"><td><p>Verser / Envoyer</p></td>
<td><p>Versé</p></td>
<td><p>ACK_WARNING</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>OUI</p></td>
</tr>
<tr class="row-even"><td><p>Verser / Envoyer</p></td>
<td><p>Échec du versement</p></td>
<td><p>ACK_KO</p></td>
<td><p></p></td>
<td><p>OUI</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Verser / Envoyer</p></td>
<td><p>Erreur technique</p></td>
<td><p>KO</p></td>
<td><p></p></td>
<td><p>OUI</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Éditer / Rouvrir</p></td>
<td><p>Ouvert en édition</p></td>
<td><p>OPEN</p></td>
<td><p>OUI</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Abandonner</p></td>
<td><p>Abandonné</p></td>
<td><p>ABORTED</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>OUI</p></td>
</tr>
</tbody>
</table>
<p>Ces services sont disponibles depuis l’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam  :</p>
<ul class="simple">
<li><p>depuis la page permettant de visualiser l’ensemble des archives d’un projet de versement, où il est possible de :</p>
<ul>
<li><p>« Valider » un versement, action correspondant à la clôture du versement,</p></li>
<li><p>« Verser » un versement, action correspondant à l’envoi du SIP.</p></li>
</ul>
</li>
<li><p>depuis la page permettant de visualiser l’ensemble des transactions (ou versements) associées à un projet de versement, où il est possible de :</p>
<ul>
<li><p>« Accéder aux archives »,</p></li>
<li><p>« Valider » un versement, action correspondant à la clôture du versement,</p></li>
<li><p>« Verser » un versement, action correspondant à l’envoi du SIP,</p></li>
<li><p>« Editer » un versement, action correspondant à la réouverture du versement en vue, notamment, de le modifier,</p></li>
<li><p>« Abandonner » un versement, action correspondant à l’abandon du versement,</p></li>
</ul>
</li>
</ul>
<p>Certaines de ces actions entraînent la purge des archives passé un certain délai. Il s’agit des actions suivantes :</p>
<ul class="simple">
<li><p>« Abandonner »</p></li>
<li><p>« Verser », si le résultat de cette action est un versement en succès ou en avertissement.</p></li>
</ul>
</section>
<section id="comment-parametrer-un-versement">
<h3><span class="section-number">14.4.3. </span>Comment paramétrer un versement ?<a class="headerlink" href="#comment-parametrer-un-versement" title="Lien vers cette rubrique"></a></h3>
<p>La solution logicielle Vitam permet de paramétrer des versements au moyen de la définition d’un projet de versement. Dans ce dernier, il est possible de :</p>
<ul class="simple">
<li><p>définir des métadonnées d’en-tête qui seront héritées dans chacune des transactions qui seront associées au projet de versement et qui, de fait, ne nécessiteront pas d’être envoyées lors de la création d’une transaction. Peuvent être héritées les métadonnées suivantes :</p>
<ul>
<li><p>un intitulé (Name) ;</p></li>
<li><p>des éléments obligatoires à la génération d’un SIP :</p>
<ul>
<li><p>le contrat d’entrée (champ « ArchivalAgreement »),</p></li>
<li><p>l’identifiant du message (champ « MessageIdentifier),</p></li>
<li><p>le service producteur (champ « OriginatingAgencyIdentifier »),</p></li>
<li><p>le service d’archivage (champ « ArchivalAgencyIdentifier »),</p></li>
<li><p>le service responsable du transfert (« TransferringAgencyIdentifier »)</p></li>
</ul>
</li>
<li><p>des éléments facultatifs à la génération d’un SIP :</p>
<ul>
<li><p>les modalités d’acquisition (« AcquisitionInformation »),</p></li>
<li><p>le statut légal des archives (« LegalStatus »),</p></li>
<li><p>le profil d’archivage (« ArchivalProfile »).</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em><strong>Points d’attention :</strong></em>
Dans le cas d’un flux automatisé, à l’exception de l’intitulé (« Name ») et de l’identifiant du message (« MessageIdentifier »), qui seront la plupart du temps spécifiques à chaque transaction, il est recommandé de spécifier dans le projet de versement les autres métadonnées, qui ont un caractère plus générique.</p>
<ul>
<li><p>définir des rattachements automatiques pour la(les) transaction(s) associée(s) au projet de versement :</p>
<ul class="simple">
<li><p>rattachement à une unité archivistique déjà conservée dans la solution logicielle Vitam (« UnitUp ») ;</p></li>
<li><p>rattachement à des unités archivistiques déjà conservées dans la solution par la définition de conditions (« UnitUps »), à savoir une métadonnée (« MetadataKey »), une valeur (« MetadataValue ») et une position de rattachement (« UnitUp »). Si l’(les) unité(s) archivistique(s) racine(s) comporte(nt) la métadonnée et la valeur définies, alors elle(s) ira(ont) se rattacher à l’unité archivistique de rattachement associée ;</p></li>
</ul>
<p>Ces deux paramètres peuvent être utilisés séparément ou ensemble. S’ils sont utilisés ensemble, alors, le module de collecte proposera un rattachement automatique des unités archivistiques racines suivant les conditions définies dans le projet de versement. Si elles ne remplissent pas les conditions, alors elles seront rattachées à l’unité archivistique de rattachement par défaut (« UnitUp »)<a class="footnote-reference brackets" href="#id164" id="id108" role="doc-noteref"><span class="fn-bracket">[</span>53<span class="fn-bracket">]</span></a>.</p>
</li>
<li><p>paramétrer l’envoi automatique du SIP dans la solution logicielle Vitam dès la validation de la transaction (AutomaticIngest).</p></li>
<li><p>ajouter des règles de transformation exprimées dans un format JSLT<a class="footnote-reference brackets" href="#id165" id="id109" role="doc-noteref"><span class="fn-bracket">[</span>54<span class="fn-bracket">]</span></a>.</p></li>
</ul>
</section>
<section id="quels-sont-les-rattachements-possibles">
<h3><span class="section-number">14.4.4. </span>Quels sont les rattachements possibles ?<a class="headerlink" href="#quels-sont-les-rattachements-possibles" title="Lien vers cette rubrique"></a></h3>
<p>On peut déclarer des règles de rattachement de plusieurs manières dans le module de collecte. Ces règles peuvent être cumulables en fonction de leur utilisation.</p>
<p>Dans un <strong>projet de versement</strong>, il est possible de déclarer :</p>
<ul class="simple">
<li><p>une position unique de rattachement (champ UnitUp) ou « rattachement statique »,</p></li>
<li><p>une à plusieurs position(s) de rattachement en fonction de la définition de conditions à respecter dans le versement (champ UnitUps) ou « rattachement dynamique ».
Ces deux paramètres sont cumulables.</p></li>
</ul>
<p>Les règles appliquées sont les suivantes :</p>
<ul class="simple">
<li><p>si un projet définit ces deux paramètres et si une unité archivistique entrante répond à une condition par clé/valeur,</p></li>
<li><p>elle sera rattachée à la position déclarée dans la condition de rattachement dynamique,</p></li>
<li><p>la règle de rattachement statique ne sera pas pris en compte, car ce sont les règles de rattachement dynamique qui l’emportent ;</p></li>
<li><p>si un projet définit ces deux paramètres et si une unité archivistique entrante ne répond à aucune condition par clé/valeur,</p></li>
<li><p>elle sera rattachée à la position de rattachement statique,</p></li>
<li><p>elle ne sera rattachée à aucune position de rattachement dynamique.</p></li>
<li><p>si un projet définit plusieurs conditions de rattachement dynamique et si une unité archivistique entrante a des correspondances avec plusieurs conditions,</p></li>
<li><p>elle sera rattachée à plusieurs positions de rattachement.</p></li>
<li><p>si un projet définit plusieurs conditions de rattachement dynamique mais pas de rattachement statique et si une unité archivistique entrante n’a aucune correspondance avec ces conditions,</p></li>
<li><p>elle ne sera rattachée à aucune position de rattachement.</p></li>
</ul>
<p><em><strong>Point d’attention</strong></em>: Les règles de rattachement statique et dynamique ne sont pas cumulables dans l’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam.</p>
<ul class="simple">
<li><p>Pour un projet de versement manuel, on ne peut définir qu’un rattachement statique,</p></li>
<li><p>Pour un projet de versement automatique, on peut :</p></li>
<li><p>soit définir un rattachement statique,</p></li>
<li><p>soit définir un rattachement dynamique.
Mais on ne peut pas définir les deux paramètres dans un même projet de versement.</p></li>
</ul>
<p>Il est également possible de déclarer des rattachements lors de l”<strong>import d’une arborescence bureautique</strong> associée à un fichier .jsonl ou .csv.
Il est alors nécessaire de :</p>
<ul class="simple">
<li><p>ajouter un répertoire matérialisant l’unité archivistique dans laquelle on souhaite rattacher l’arborescence bureautique,</p></li>
<li><p>déclarer ce répertoire dans le fichier .jsonl ou .csv accompagnant l’arborescence bureautique.
Ne devront être renseignées que les informations suivantes :
-   File,
-   DescriptionLevel,
-   Title,
-   UpdateOperation.ArchiveUnitIdentifierKey.MetadataName et Management.UpdateOperation.ArchiveUnitIdentifierKey.MetadataValue OU UpdateOperation.SystemId.</p></li>
</ul>
<p><em><strong>Point d’attention</strong></em> :</p>
<ul class="simple">
<li><p>Un rattachement ne peut être déclaré que dans un répertoire racine.</p></li>
<li><p>UpdateOperation.ArchiveUnitIdentifierKey.MetadataName et UpdateOperation.SystemId ne sont pas cumulables. Pour une unité archivistique, on ne peut renseigner que l’un ou l’autre, mais pas les deux en même temps.</p></li>
<li><p>Si on a employé UpdateOperation.ArchiveUnitIdentifierKey.MetadataName, il faut nécessairement déclarer UpdateOperation.ArchiveUnitIdentifierKey.MetadataValue et inversement.</p></li>
<li><p>Si le projet de versement associé à la transaction déclare un rattachement statique et/ou un rattachement dynamique et
et si le fichier .jsonl ou .csv associé à l’arborescence bureautique déclare un rattachement, alors les règles de rattachement déclarées dans le projet de versement ne seront pas appliquées.
Dans cette arborescence, si une unité archivistique racine ne déclare pas de rattachement, alors le rattachement statique et/ou dynamique s’appliquera.</p></li>
<li><p>Un rattachement ne peut être ajouté lors d’une mise à jour des métadonnées, notamment par envoi de fichier .jsonl ou .csv.</p></li>
</ul>
<p>Par ailleurs, un rattachement peut être :</p>
<ul class="simple">
<li><p>ajouté suite à l’utilisation d’une <strong>transformation paramétrée dans un projet de versement via des commandes JSLT</strong>.
Si le projet déclare en plus un rattachement statique et/ou dynamique, ce dernier ne sera pas appliqué.
Le module de collecte exécute en priorité les transformations de rattachement exprimées en JSLT.</p></li>
<li><p>supprimé suite à l’utilisation d’une transformation paramétrée dans un projet de versement.</p>
<ul>
<li><p>Si le projet déclare un rattachement statique et/ou dynamique, ce dernier pourra être appliqué, suivant les règles définies plus haut.</p></li>
<li><p>Si les conditions de rattachement définies dans les ordres de transformation JSLT ne sont pas réunies et si le projet déclare un rattachement statique et/ou dynamique, ce dernier pourra être appliqué, suivant les règles définies plus haut.</p></li>
</ul>
</li>
</ul>
<p>Enfin, il est possible d”<strong>ajouter des répertoires dans une transaction</strong>.</p>
<ul class="simple">
<li><p>Si ces répertoires sont accompagnés d’un fichier .jsonl ou .csv, celui-ci ne peut contenir des informations de rattachement.</p></li>
<li><p>S’il en contient, l’ajout des répertoires sera en échec.</p></li>
</ul>
</section>
<section id="comment-parametrer-des-regles-de-transformation">
<h3><span class="section-number">14.4.5. </span>Comment paramétrer des règles de transformation ?<a class="headerlink" href="#comment-parametrer-des-regles-de-transformation" title="Lien vers cette rubrique"></a></h3>
<p>La solution logicielle Vitam permet d’agir sur les métadonnées des archives versées au moyen d’une configuration au format JSLT paramétrée dans un projet de versement (TransformationRules).
Dans cette configuration, il est possible de demander :</p>
<ul class="simple">
<li><p>l’ajout de métadonnées descriptives ou de gestion de manière systématique, le cas échéant en fonction de critères à définir ;</p></li>
<li><p>la suppression de métadonnées,</p></li>
<li><p>la modification de métadonnées en fonction de critères à définir ;</p></li>
<li><p>la transformation de métadonnées en des métadonnées conformes au SEDA ;</p></li>
<li><p>la modification de valeurs renseignées dans les métadonnées afin de les nettoyer (ex. ajout de majuscule, suppression d’espaces, etc.).</p></li>
</ul>
<p>Le but d’un fichier au format JSLT est de transformer du JSON<a class="footnote-reference brackets" href="#id166" id="id110" role="doc-noteref"><span class="fn-bracket">[</span>55<span class="fn-bracket">]</span></a>. Son application est toujours évaluée par rapport à une entrée, appelée « le nœud de contexte ». Le résultat peut être un objet, un nombre, une chaîne de caractères, une valeur nulle (« null »), etc., exprimé au format JSON, format dans lequel sont transformées les métadonnées une fois importées dans le module de collecte<a class="footnote-reference brackets" href="#id167" id="id111" role="doc-noteref"><span class="fn-bracket">[</span>56<span class="fn-bracket">]</span></a>.</p>
<p>Prenons l’entrée suivante :</p>
<p><em>Exemple : Fiche matricule d’Albert Dupont (enregistrement JSON)</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;Title&quot;</span> <span class="p">:</span> <span class="s2">&quot;Albert Dupont&quot;</span><span class="p">,</span>
 <span class="s2">&quot;DocumentType&quot;</span> <span class="p">:</span> <span class="s2">&quot;Fiche matricule&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Coverage&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Temporal&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;XXème siècle&quot;</span><span class="p">,</span><span class="s2">&quot;1ère guerre mondiale&quot;</span><span class="p">,</span><span class="s2">&quot;1914-1918&quot;</span><span class="p">],</span><span class="s2">&quot;Spatial&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;France&quot;</span><span class="p">,</span><span class="s2">&quot;Verdun&quot;</span><span class="p">},</span>
  <span class="s2">&quot;ID-ARK&quot;</span> <span class="p">:</span> <span class="s2">&quot;mon-domaine/12345/eaferzebn13bac&quot;</span>
  <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00001&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2007-09-25&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p><em>Exemple : Fiche matricule d’Albert Dupont (fichier .csv)</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;File&quot;</span><span class="p">,</span><span class="s2">&quot;Content.Title&quot;</span><span class="p">;</span><span class="s2">&quot;Content.DocumentType&quot;</span><span class="p">;</span><span class="s2">&quot;Content.Coverage.Temporal.0&quot;</span><span class="p">;</span><span class="s2">&quot;Content.Coverage.Temporal.1&quot;</span><span class="p">;</span><span class="s2">&quot;Content.Coverage.Temporal.2&quot;</span><span class="p">;</span><span class="s2">&quot;Content.Coverage.Spatial.0&quot;</span><span class="p">;</span><span class="s2">&quot;Content.Coverage.Spatial.1&quot;</span><span class="p">;</span><span class="s2">&quot;Content.ID-ARK&quot;</span><span class="p">;</span><span class="s2">&quot;Management.AccessRule.Rule&quot;</span><span class="p">;</span><span class="s2">&quot;Management.StartDate.Rule&quot;</span>
<span class="s2">&quot;eaferzebn13bac.pf&quot;</span><span class="p">,</span><span class="s2">&quot;Albert Dupont&quot;</span><span class="p">;</span><span class="s2">&quot;Fiche matricule&quot;</span><span class="p">;</span><span class="s2">&quot;XXème siècle&quot;</span><span class="p">;</span><span class="s2">&quot;1ère guerre mondiale&quot;</span><span class="p">;</span><span class="s2">&quot;1914-1918&quot;</span><span class="p">;</span><span class="s2">&quot;France&quot;</span><span class="p">;</span><span class="s2">&quot;Verdun&quot;</span><span class="p">;</span><span class="s2">&quot;Content.ID-ARK&quot;</span><span class="p">;</span><span class="s2">&quot;ACC-00001&quot;</span><span class="p">;</span><span class="s2">&quot;2007-09-25&quot;</span>
</pre></div>
</div>
<section id="absence-d-actions-sur-les-donnees-entrantes">
<h4><span class="section-number">14.4.5.1. </span>Absence d’actions sur les données entrantes<a class="headerlink" href="#absence-d-actions-sur-les-donnees-entrantes" title="Lien vers cette rubrique"></a></h4>
<p>Si l’on souhaite uniquement ajouter des métadonnées, sans agir sur les données entrantes, il faudra déclarer les métadonnées et les valeurs à ajouter, suivies de l’expression « * : . ».</p>
<p>*Exemple : Ajout d’un Tag dont la valeur est « Fiche matricule » en plus des autres métadonnées entrantes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="s2">&quot;Fiche matricule&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Exemple : Ajout d’une règle de diffusion dont la règle est DISS-00001 et la date de début 2007-09-25 en plus de la règle de communicabilité déjà présente dans les données entrantes.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;DisseminaRule&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;DISS-00001&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2007-09-25&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">},</span>
        <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
    <span class="p">},</span>
    <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em><strong>Point d’attention :</strong></em> L’expression « * : . » est présente à deux endroits :</p>
<ul class="simple">
<li><p>dans le bloc #management car il peut y avoir d’autres règles de gestion dans les données entrantes,</p></li>
<li><p>dans le nœud courant afin de récupérer la globalité des informations.</p></li>
</ul>
</section>
<section id="actions-sur-les-donnees-entrantes">
<h4><span class="section-number">14.4.5.2. </span>Actions sur les données entrantes<a class="headerlink" href="#actions-sur-les-donnees-entrantes" title="Lien vers cette rubrique"></a></h4>
<p>Si l’on souhaite agir sur les données entrantes, il faudra <strong>nommer</strong> la métadonnée en la préfixant d’un point (ex. .DocumentType). On parlera alors de « clé ».
Voici quelques règles en fonction de la métadonnée concernée :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Type d’élément</strong></p></th>
<th class="head text-center"><p><strong>Nommage possible de la clé</strong></p></th>
<th class="head text-center"><p><strong>Résultat obtenu en sortie</strong></p></th>
<th class="head text-center"><p><strong>Commentaires</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Élément « feuille »</p></td>
<td class="text-center"><p>.DocumentType</p></td>
<td class="text-center"><p>« Fiche matricule »<br>Soit la(les) valeur(s) de la métadonnée DocumentType</p></td>
<td class="text-center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Élément englobant</p></td>
<td class="text-center"><p>.Coverage</p></td>
<td class="text-center"><p>« Temporal » : [« XXème siècle », »1ère guerre mondiale », »1914-1918 »], »Spatial » : [« France », »Verdun »].<br>Soit la(les) métadonnée(s) englobée(s) et leur(s) valeur(s)</p></td>
<td class="text-center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Élément englobé</p></td>
<td class="text-center"><p>.Coverage.Temporal</p></td>
<td class="text-center"><p>[« XXème siècle », »1ère guerre mondiale », »1914-1918 »]<br>Soit la(les) valeur(s) de la métadonnée Temporal.</p></td>
<td class="text-center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Élément avec caractères spéciaux</p></td>
<td class="text-center"><p>. »ID-ARK »</p></td>
<td class="text-center"><p>« mon-domaine/12345/eaferzebn13bac »<br>Soit la(les) valeur(s) de la métadonnée ID-ARK</p></td>
<td class="text-center"><p>Si une des clés à utiliser contient des caractères spéciaux, il est nécessaire de mettre son nom entre guillemets, sans quoi la clé ne fonctionnera pas.</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Éléments factorisés</p></td>
<td class="text-center"><p>.Coverage</p></td>
<td class="text-center"><p>[.Temporal, .Spatial]</p></td>
<td class="text-center"><p>[ « XXème siècle », « 1ère guerre mondiale », « 1914-1918 » ], [ « France » ]</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Elément variabilisé</p></td>
<td class="text-center"><p>let varDocumentType = .DocumentType<br>Usage : $varDocumentType</p></td>
<td class="text-center"><p>« Fiche matricule »</p></td>
<td class="text-center"><p>Il est possible de définir des variables pour découper des expressions complexes ou éviter de recalculer plusieurs fois la même chose.</p></td>
</tr>
</tbody>
</table>
<p>On pourra <strong>insérer des expressions dans un nouvel objet</strong> au moyen de l’appel à ces clés. En d’autres termes, on peut, par exemple, ajouter une métadonnée dans laquelle on insérera les valeurs d’une clé passée en paramètre.</p>
<p><strong>Point d’attention :</strong> Si une expression produit null, {} ou [], la clé est omise.</p>
<p><em>Exemple : Ajout d’un Tag dont la valeur sera égale à la valeur de la métadonnée DocumentType en plus des autres métadonnées entrantes.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="o">.</span><span class="n">DocumentType</span><span class="p">,</span>
    <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Il est également possible de vouloir conserver l’ensemble des valeurs du fichier à l’exception de certaines, dans ce cas on utilisera l’expression « * - ValeurExclue : . ».</p>
<p><em>Exemple : Ajout d’un Tag dont la valeur sera égale à la valeur de la métadonnée DocumentType et exclusion de la métadonnée DocumentType.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="o">.</span><span class="n">DocumentType</span><span class="p">,</span>
     <span class="o">*</span> <span class="o">-</span> <span class="n">DocumentType</span> <span class="p">:</span> <span class="o">.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Il est possible d’intervenir sur les données entrantes de manière à agir sur la sortie via :</p>
<ul class="simple">
<li><p>l”<strong>indexation en tableau</strong> avec le paramètre [index].
Ainsi, .Coverage.Temporal[0] donnerait « XXème siècle » en utilisant l’exemple général d’entrée du début de ce document.
On peut également découper des tableaux. Par exemple, .Coverage.Temporal[1 : 3] donnera [« XXème siècle », « 1914-1918 »]. Le premier indice est donc inclusif et que le dernier est exclusif. Par ailleurs, le compte de l’index commence toujours à 0.
Les indices négatifs sont autorisés pour référencer les éléments en partant de la fin du tableau. Ainsi, [-1] renverrait le dernier élément du tableau.
Cela fonctionne aussi avec le découpage : pour supprimer le premier et le dernier élément, il faut écrire [1 : -1].
Ce mode permet de sélectionner les données à extraire.</p></li>
<li><p>les <strong>fonctions intégrées</strong> proposées par JSLT qui permettent de transformer les données<a class="footnote-reference brackets" href="#id168" id="id112" role="doc-noteref"><span class="fn-bracket">[</span>57<span class="fn-bracket">]</span></a>.</p></li>
</ul>
<p><em>Exemple : Passage en majuscules des valeurs de la métadonnée Title et remplacement de la valeur de la métadonnée DocumentType (« Registre matricule » devient « Fiche matricule »).</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;Title&quot;</span><span class="p">:</span><span class="n">trim</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="o">.</span><span class="n">Title</span><span class="p">)),</span>
<span class="s2">&quot;DocumenType&quot;</span><span class="p">:</span> <span class="n">replace</span><span class="p">(</span><span class="o">.</span><span class="n">DocumentType</span><span class="p">,</span><span class="s2">&quot;Registre matricule&quot;</span><span class="p">,</span><span class="s2">&quot;Fiche matricule&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>de <strong>nouvelles fonctions</strong>, qu’il faut déclarer en amont des expressions de transformation du fichier JSLT.
La syntaxe est la suivante :
def Nomfonction(paramètre(s))
<expression>
Il est possible d’utiliser des variables préalablement définies au sein de la définition d’une fonction. Les fonctions peuvent également s’appeler elles-mêmes et appeler d’autres fonctions déjà définies.</p></li>
</ul>
<p><strong>Point d’attention :</strong> Si deux fonctions différentes utilisent le même nom, seule la dernière fonction définie sera prise en compte.</p>
<ul class="simple">
<li><p>des <strong>opérateurs</strong>.</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Type</strong></p></th>
<th class="head text-center"><p><strong>Opérateur</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Mathématiques</p></td>
<td class="text-center"><p>+ : addition.<br>Il sert également à la concaténation de chaînes de caractères, tableaux et objets.</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Comparaisons</p></td>
<td class="text-center"><p>&gt; : supérieur à<br>&lt; : inférieur à<br>≥ : supérieur ou égal à<br>≤ : inférieur ou égal à<br>!= : différent de<br>== : égal à</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Boléens</p></td>
<td class="text-center"><p>and, or, not(etc.)</p></td>
</tr>
</tbody>
</table>
<p>Dans le fichier .jslt, on peut introduire :</p>
<ul class="simple">
<li><p>des <strong>expressions conditionnelles</strong> telles que : if (<expr>) <expr> else <expr>.
L’expression if retourne toujours une valeur et ne fait rien d’autre.
La partie else peut être omise, auquel cas l’expression if retournera null si la condition est fausse.
Les valeurs false, null, {} et [] sont évaluées comme false.</p></li>
</ul>
<p><em>Exemple : Ajout d’un champ Tag récupérant la valeur du champ DocumenType si le champ DocumentType est présent et contient une valeur dans les données entrantes.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="o">.</span><span class="n">DocumentType</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="s2">&quot;Tag&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="n">DocumentType</span><span class="p">]</span>
  <span class="p">}</span>
<span class="k">else</span>
  <span class="p">{</span> 
    <span class="s2">&quot;Tag&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Registre matricule&quot;</span><span class="p">]</span>
  <span class="p">}</span>

<span class="o">*</span><span class="n">Résultat</span> <span class="p">:</span><span class="o">*</span>
<span class="o">-</span>   <span class="n">Si</span> <span class="n">le</span> <span class="n">champ</span> <span class="n">DocumentType</span> <span class="n">est</span> <span class="n">présent</span> <span class="n">et</span> <span class="n">contient</span> <span class="n">une</span> <span class="n">valeur</span> <span class="n">dans</span> <span class="n">les</span> <span class="n">données</span> <span class="n">entrantes</span> <span class="p">:</span>

<span class="p">{</span>
  <span class="s2">&quot;Tag&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Registre matricule&quot;</span> <span class="p">]</span>
<span class="p">}</span>

<span class="o">-</span>   <span class="n">S</span><span class="s1">&#39;il n&#39;</span><span class="n">y</span> <span class="n">a</span> <span class="n">aucun</span> <span class="n">résultat</span><span class="p">,</span> <span class="n">la</span> <span class="n">transformation</span> <span class="n">ajoutera</span> <span class="n">le</span> <span class="n">champ</span> <span class="n">Tag</span> <span class="n">et</span> <span class="n">la</span> <span class="n">valeur</span> <span class="s2">&quot;Registre matricule&quot;</span> <span class="p">:</span>

<span class="p">{</span>
  <span class="s2">&quot;Tag&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Registre matricule&quot;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Points d’attention :</strong></p>
<ul class="simple">
<li><p>Ecrire if(.DocumentType!=null) est équivalent à utiliser if(.DocumentType).</p></li>
<li><p>Dans l’exemple ci-dessus, utiliser des conditions permet non seulement de transformer les métadonnées entrantes (DocumentType devient Tag), mais aussi d’uniformiser les saisies de valeurs quand on sait que certaines métadonnées ne sont pas systématiquement renseignées.</p></li>
<li><p>des <strong>boucles</strong> telles que : [for (<expr>) <expr>].
L’expression for permet de parcourir un tableau et de transformer chaque élément en appliquant une expression.
L’expression entre parenthèses est comprise comme un tableau sur lequel on boucle. Pour chaque élément du tableau, la seconde expression est évaluée.</p></li>
</ul>
<p><em>Exemple : Ajout d’un champ Tag récupérant les valeurs du champ Temporal que l’on souhaite transformer en majuscules.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Tag&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="k">for</span> <span class="p">(</span><span class="o">.</span><span class="n">Coverage</span><span class="o">.</span><span class="n">Temporal</span><span class="p">)</span> <span class="n">trim</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="o">.</span><span class="p">))]}</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Une boucle peut être aussi utilisée pour : 
-   transformer les valeurs d’un tableau de nombres à chaînes de caractères en utilisant la fonction string(.), 
-   transformer un tableau en objet.
</pre></div>
</div>
</section>
</section>
<section id="quels-sont-les-profils-utilisateurs-possibles">
<h3><span class="section-number">14.4.6. </span>Quels sont les profils utilisateurs possibles ?<a class="headerlink" href="#quels-sont-les-profils-utilisateurs-possibles" title="Lien vers cette rubrique"></a></h3>
<p>L’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam
propose trois profils utilisateurs :</p>
<ul class="simple">
<li><p>administrateur,</p></li>
<li><p>archiviste,</p></li>
<li><p>service producteur.</p></li>
</ul>
<p>Chacun d’eux a la possibilité d’agir sur cette APP à des degrés différents :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Profil utilisateur</p></th>
<th class="head"><p>Administrateur</p></th>
<th class="head"><p>Archiviste</p></th>
<th class="head"><p>Service producteur</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Créer une transaction</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Valider une transaction</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-even"><td><p>Verser une transaction</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
<td><p>non</p></td>
</tr>
<tr class="row-odd"><td><p>Ajouter des archives</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-even"><td><p>Réorganiser des arborescences</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
<td><p>non</p></td>
</tr>
<tr class="row-odd"><td><p>Supprimer des archives</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
<td><p>non</p></td>
</tr>
<tr class="row-even"><td><p>Modifier unitairement des archives</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
</tr>
<tr class="row-odd"><td><p>Modifier des archives par import de fichier .csv</p></td>
<td><p>oui</p></td>
<td><p>oui</p></td>
<td><p>non</p></td>
</tr>
</tbody>
</table>
<p>Par ailleurs, il est possible de restreintre d’accès aux projets et aux transactions via l’utilisation d’un contrat d’accès.
Ainsi, un utilisateur du front-office VitamUI devant accéder aux projets de versement d’un service en particulier, et à ses transactions, pourra ne voir que ceux-là si son profil utilisateur est associé à un contrat d’accès lui permettant d’accéder uniquement aux archives de ce service.</p>
</section>
<section id="quels-sont-les-services-disponibles">
<h3><span class="section-number">14.4.7. </span>Quels sont les services disponibles ?<a class="headerlink" href="#quels-sont-les-services-disponibles" title="Lien vers cette rubrique"></a></h3>
<p>Le module de collecte met à disposition des services :</p>
<ul class="simple">
<li><p>via les API</p></li>
<li><p>depuis l’APP « Collecte et préparation des versements » du front-office VitamUI fournie avec la solution logicielle Vitam.</p></li>
</ul>
<p>Voici un tableau récapitulatif des services disponibles, mettant en évidence les nouveautés des deux dernières versions publiées de la solution logicielle Vitam :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>—</p></th>
<th class="head"><p>APP Collecte</p></th>
<th class="head"><p>Back module de collecte</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Configurer des versements</p></td>
<td><p>Crée N projets de versement :<br/>- Pour des versements manuels<br/>- Pour des versements de flux automatisés</p></td>
<td><p>Crée N projets de versement :<br/>- Pour des versements manuels<br/>- Pour des versements de flux automatisés</p></td>
</tr>
<tr class="row-odd"><td><p>(Pré-)Verser les archives</p></td>
<td><p>- Crée automatiquement 1 transaction associée (mode lot ou unitaire) pour 1 projet de versement manuel préalablement créé.<br/>- Ne crée pas de transaction associée à un projet de versement automatique.<br/>- <strong>Ajouts a posteriori possibles d’archives (mode lot) - version 8.1</strong></p></td>
<td><p>- Crée N transactions associées avec ses archives (mode lot ou <em>unitaire</em>).<br/>- Ajouts a posteriori possibles d’archives (<strong>mode lot - version 8.1</strong> - ou unitaire)</p></td>
</tr>
<tr class="row-even"><td><p>Consulter les (pré-)versement(s)</p></td>
<td><p>- Liste les projets de versement<br/>- Recherche dans les projets de versement<br/>- Affichage du détail d’un projet de versement<br/>- Liste les transactions associées à un projet<br/>- Liste les archives d’une transaction<br/>- Recherche simple / avancée / arborescence dans les archives d’une transaction<br/>- Affichage du détail d’une unité (métadonnées descriptives et de gestion, métadonnées techniques)<br/>- Téléchargement de l’objet numérique<br/></p></td>
<td><p>- Liste les projets de versement<br/>- Recherche dans les projets de versement<br/>- Affichage du détail d’un projet de versement<br/>- Liste les transactions associées à un projet<br/>- <em>Affichage du détail d’une transaction</em><br/>- Liste les archives d’une transaction<br/>- Recherche simple / avancée / arborescence dans les archives d’une transaction<br/>- Affichage du détail d’une unité (métadonnées descriptives et de gestion, métadonnées techniques)<br/>- Téléchargement de l’objet numérique</p></td>
</tr>
<tr class="row-odd"><td><p>Traiter les archives</p></td>
<td><p>- définition et mise à jour de métadonnées contextuelles,<br/>- identification de format,<br/>- calcul d’empreintes,<br/>- calcul du poids de l’objet numérique,<br/>- mise à jour de métadonnées descriptives et de gestion (par import de fichier .csv),<br/>- mise à jour unitaire de métadonnées descriptives,<br/>- <strong>suppression d’archives - version 8.1</strong>,<br/>- <strong>réorganisation d’archives - version 8.1</strong>,<br/>- gestion de statuts (ex. réouverture ou abandon d’un (pré-)versement)</p></td>
<td><p>- définition et mise à jour de métadonnées contextuelles,<br/>- identification de format,<br/>- calcul d’empreintes,<br/>- calcul du poids de l’objet numérique,<br/>- mise à jour de métadonnées descriptives et de gestion (par import de fichier .csv et <em>.jsonl</em>),<br/>- mise à jour unitaire en masse de métadonnées descriptives et de gestion,<br/>- <strong>suppression d’archives - version 8.1</strong>,<br/>- <strong>réorganisation d’archives - version 8.1</strong>,<br/>- gestion de statuts (ex. réouverture ou abandon d’un (pré-)versement),<br/>- <em>suppression unitaire d’un (pré-versement) et d’un projet de versement</em></p></td>
</tr>
<tr class="row-even"><td><p>Transférer les archives</p></td>
<td><p>- Générer un SIP<br/>- Suppression automatique</p></td>
<td><p>- Générer un SIP<br/>- Suppression automatique</p></td>
</tr>
<tr class="row-odd"><td><p>Gestion des droits</p></td>
<td><p>- <strong>Trois groupes de profils : administrateur, archiviste, service producteur - version 8.0</strong>,<br/>- <strong>Possibilité de filtrage des accès aux projets par service producteur - version 8.0</strong>.</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="annexe-1-exemples-de-donnees-entrantes">
<h2><span class="section-number">14.5. </span>Annexe 1 : Exemples de données entrantes<a class="headerlink" href="#annexe-1-exemples-de-donnees-entrantes" title="Lien vers cette rubrique"></a></h2>
<p>*Nota bene *: les cas présentés ci-dessous sont des exemples fictifs.</p>
<section id="metadonnees-d-en-tete">
<h3><span class="section-number">14.5.1. </span>Métadonnées d’en-tête<a class="headerlink" href="#metadonnees-d-en-tete" title="Lien vers cette rubrique"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;ArchivalAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Vitam&quot;</span><span class="p">,</span>
  <span class="s2">&quot;TransferringAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;AN&quot;</span><span class="p">,</span>
  <span class="s2">&quot;OriginatingAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
  <span class="s2">&quot;SubmissionAgencyIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;MICHEL_MERCIER&quot;</span><span class="p">,</span>
  <span class="s2">&quot;MessageIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;20220302-000005&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ArchivalAgreement&quot;</span><span class="p">:</span><span class="s2">&quot;IC-000001&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Versement du service producteur : Cabinet de Michel Mercier&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="creation-unitaire-d-archives">
<h3><span class="section-number">14.5.2. </span>Création unitaire d’archives<a class="headerlink" href="#creation-unitaire-d-archives" title="Lien vers cette rubrique"></a></h3>
<section id="unites-archivistiques">
<h4><span class="section-number">14.5.2.1. </span>Unités archivistiques<a class="headerlink" href="#unites-archivistiques" title="Lien vers cette rubrique"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;RecordGrp&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours de Michel Mercier&quot;</span><span class="p">,</span>
    <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00001&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2000-01-01&quot;</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="objets">
<h4><span class="section-number">14.5.2.2. </span>Objets<a class="headerlink" href="#objets" title="Lien vers cette rubrique"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;FileInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;Filename&quot;</span><span class="p">:</span> <span class="s2">&quot;MonFichier.txt&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="creation-d-archives-en-lot-avec-fichier-jsonl">
<h3><span class="section-number">14.5.3. </span>Création d’archives en lot avec fichier .jsonl<a class="headerlink" href="#creation-d-archives-en-lot-avec-fichier-jsonl" title="Lien vers cette rubrique"></a></h3>
<p><em>Exemple 1 : contenu d’un fichier « metadata.jsonl ».</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Collection&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;Ceci est un versement de bulletins de paie&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;EndDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Paie&quot;</span><span class="p">,</span> <span class="s2">&quot;Bulletin&quot;</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;File/BP_123456_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;BP_123456_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;OriginatingSystemId&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;BP_123456_20230131&quot;</span> <span class="p">],</span> <span class="s2">&quot;Agent&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;DUPONT&quot;</span><span class="p">,</span> <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;Charles&quot;</span><span class="p">,</span> <span class="s2">&quot;Identifier&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;123456&quot;</span> <span class="p">]</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;SentDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;AcquiredDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Salaire&quot;</span> <span class="p">],</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00001&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span> <span class="p">},</span> <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00016&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;File/BP_123463_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;BP_123463_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;OriginatingSystemId&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;BP_123463_20230131&quot;</span> <span class="p">],</span> <span class="s2">&quot;Agent&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;DUPOND&quot;</span><span class="p">,</span> <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;Victor&quot;</span><span class="p">,</span> <span class="s2">&quot;Identifier&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;123463&quot;</span> <span class="p">]</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;SentDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;AcquiredDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Salaire&quot;</span> <span class="p">],</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00002&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span> <span class="p">},</span> <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00016&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;File/BP_123464_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;BP_123464_20230131.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;OriginatingSystemId&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;BP_123464_20230131&quot;</span> <span class="p">],</span> <span class="s2">&quot;Agent&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;CHARLES&quot;</span><span class="p">,</span> <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;Ray&quot;</span><span class="p">,</span> <span class="s2">&quot;Identifier&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;123464&quot;</span> <span class="p">]</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;SentDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-31&quot;</span><span class="p">,</span> <span class="s2">&quot;AcquiredDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Salaire&quot;</span> <span class="p">],</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00002&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">],</span> <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span> <span class="p">},</span> <span class="s2">&quot;AccessRule&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;ACC-00016&quot;</span><span class="p">,</span> <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-20&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> 
</pre></div>
</div>
<p><em>Exemple 2 : contenu d’un fichier « metadata.jsonl » décrivant un contexte de signature détachée.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;File&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Root Folder&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="s2">&quot;SomeFile.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder (with attached SomeFile.xml)&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile1.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile1.txt&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/MyFile2.txt&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Root Folder/SubFolder&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/SubFolder/MyFile3.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/SubFolder (with attached MyFile3.txt)&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;Selector&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;#uploadPath&quot;</span> <span class="p">:</span> <span class="s2">&quot;Yet Another Folder&quot;</span> <span class="p">},</span> <span class="s2">&quot;ObjectFiles&quot;</span><span class="p">:</span> <span class="s2">&quot;My Root Folder/SubFolder/MyFile4.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Yet Another Folder (with attached MyFile4.txt)&quot;</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
<p><em>Exemple 3 : contenu d’un fichier « metadata.jsonl » déclarant un rattachement.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours hors parlement&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;RecordGrp&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours hors parlement&quot;</span><span class="p">,</span> <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;UpdateOperation&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;ArchiveUnitIdentifierKey&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;MetadataName&quot;</span> <span class="p">:</span> <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span><span class="p">,</span> <span class="s2">&quot;MetadataValue&quot;</span> <span class="p">:</span> <span class="s2">&quot;20130456/3&quot;</span><span class="p">}</span> <span class="p">}</span>  <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours hors parlement/Discours d&#39;inauguration&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;RecordGrp&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours d’inauguration&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="s2">&quot;Discours hors parlement/Discours d&#39;inauguration/Inauguration de Notre-Dame.odt&quot;</span><span class="p">,</span> <span class="s2">&quot;UnitContent&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Inauguration de Notre-Dame&quot;</span> <span class="p">}</span> <span class="p">}</span>
 
</pre></div>
</div>
</section>
<section id="creation-d-archives-en-lot-avec-fichier-csv">
<h3><span class="section-number">14.5.4. </span>Création d’archives en lot avec fichier .csv<a class="headerlink" href="#creation-d-archives-en-lot-avec-fichier-csv" title="Lien vers cette rubrique"></a></h3>
<p><em>Exemple 1 : contenu d’un fichier « metadata.csv ».</em></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>  &quot;File&quot;;&quot;Content.DescriptionLevel&quot;;&quot;Content.Title&quot;;&quot;Content.FilePlanPosition&quot;;&quot;Content.ArchivalAgencyArchiveUnitIdentifier&quot;;&quot;Content.Description&quot;;&quot;Content.CustodialHistory.CustodialHistoryItem.0&quot;;&quot;Content.CustodialHistory.CustodialHistoryItem.1&quot;;&quot;Content.CustodialHistory.CustodialHistoryItem.2&quot;;&quot;Content.DocumentType&quot;;&quot;Content.Language&quot;;&quot;Content.DescriptionLanguage&quot;;&quot;Content.Version&quot;;&quot;Content.Tag.0&quot;;&quot;Content.Tag.1&quot;;&quot;Content.Tag.2&quot;;&quot;Content.Tag.3&quot;;&quot;Content.Tag.4&quot;;&quot;Content.Keyword.0.KeywordContent&quot;;&quot;Content.Keyword.0.KeywordType&quot;;&quot;Content.Keyword.1.KeywordContent&quot;;&quot;Content.Keyword.1.KeywordType&quot;;&quot;Content.Keyword.2.KeywordContent&quot;;&quot;Content.Keyword.2.KeywordType&quot;;&quot;Content.Keyword.3.KeywordContent&quot;;&quot;Content.Keyword.3.KeywordType&quot;;&quot;Content.Keyword.4.KeywordContent&quot;;&quot;Content.Keyword.4.KeywordType&quot;;&quot;Content.Coverage.Spatial.0&quot;;&quot;Content.Coverage.Spatial.1&quot;;&quot;Content.Coverage.Spatial.2&quot;;&quot;Content.Coverage.Spatial.3&quot;;&quot;Content.Coverage.Temporal&quot;;&quot;Content.Coverage.Juridictional.0&quot;;&quot;Content.Coverage.Juridictional.1&quot;;&quot;Content.Coverage.Juridictional.2&quot;;&quot;Content.Coverage.Juridictional.3&quot;;&quot;Content.OriginatingAgency.Identifier&quot;;&quot;Content.SubmissionAgency.Identifier&quot;;&quot;Content.StartDate&quot;;&quot;Content.EndDate&quot;;&quot;Management.AccessRule.Rule&quot;;&quot;Management.AccessRule.StartDate&quot;
  &quot;AU1/27juillet1888/5FI6_/5FI6_16&quot;;&quot;RecordGrp&quot;;&quot;Brantes. Combe de la Mure.&quot;;&quot;instrument_recherche/5FI6/5FI6_16&quot;;&quot;5 Fi 6/16&quot;;&quot;Dim. 18x24 cm.&quot;;;;;;&quot;fre&quot;;&quot;fre&quot;;&quot;Original&quot;;&quot;Combe de la Mure (Brantes, Vaucluse, France)&quot;;&quot;Brantes (Vaucluse, France)&quot;;;;;&quot;Combe de la Mure (Brantes, Vaucluse, France)&quot;;&quot;geogname&quot;;&quot;Brantes (Vaucluse, France)&quot;;&quot;geogname&quot;;;;;;;;&quot;Combe de la Mure (Brantes, Vaucluse, France)&quot;;&quot;Brantes (Vaucluse, France)&quot;;;;1888;&quot;Combe de la Mure (Brantes, Vaucluse, France)&quot;;&quot;Brantes (Vaucluse, France)&quot;;;;;;;&quot;1888-12-30T00:00:00&quot;;&quot;ACC-00001&quot;;&quot;1888-12-30&quot;
  &quot;AU1/27juillet1888&quot;;&quot;RecordGrp&quot;;&quot;Clichés du 27 juillet 1888&quot;;;;;;;;;&quot;fre&quot;;&quot;fre&quot;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
</pre></div>
</div>
<p><em>Exemple 2 : contenu d’un fichier « metadata.csv » décrivant un contexte de signature détachée.</em></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>  &quot;File&quot;;&quot;ObjectFiles&quot;;&quot;Content.DescriptionLevel&quot;;&quot;Content.Title&quot;;&quot;Content.Description&quot;;&quot;Content.DocumentType&quot;;&quot;Content.Tag&quot;;&quot;Content.EndDate&quot;;&quot;Content.SigningInformation.SigningRole.0&quot;;&quot;Content.SigningInformation.SigningRole.1&quot;;&quot;Content.SigningInformation.SigningRole.2&quot;;&quot;Content.SigningInformation.SignatureDescription.0.Signer.FullName&quot;;&quot;Content.SigningInformation.SignatureDescription.0.Signer.SigningTime&quot;;&quot;Content.SigningInformation.TimestampingInformation.TimeStamp&quot;;&quot;Content.SigningInformation.AdditionalProof.0.AdditionalProofInformation.0&quot;;&quot;Content.SigningInformation.AdditionalProof.0.AdditionalProofInformation.1&quot;;&quot;Management.AppraisalRule.Rule&quot;;&quot;Management.AppraisalRule.StartDate&quot;;&quot;Management.AppraisalRule.FinalAction&quot;;&quot;Management.AccessRule.Rule&quot;;&quot;Management.AccessRule.StartDate&quot;
  &quot;**Parapheur**&quot;;&quot;Parapheur/20230615_note_Vu AB.pdf&quot;;&quot;Item&quot;;&quot;20230615_note_Vu AB.pdf&quot;;&quot;Parapheur créé par Al Capone. Note&quot;;&quot;Document signé&quot;;&quot;Note&quot;;&quot;2023-06-15&quot;;&quot;SignedDocument&quot;;&quot;Signature&quot;;&quot;Timestamp&quot;;&quot;Al Capone&quot;;&quot;2023-06-15T11:18:12&quot;;&quot;2023-06-15T11:18:12&quot;;&quot;EvidenceRecords&quot;;&quot;Report&quot;;&quot;APP-00003&quot;;&quot;2023-06-15&quot;;&quot;Keep&quot;;&quot;ACC-00020&quot;;&quot;2023-06-15&quot;
  &quot;Parapheur/aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq-evidenceRecord.pdf&quot;;&quot;**Parapheur/aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq-evidenceRecord.pdf**&quot;;&quot;Item&quot;;&quot;aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq-evidenceRecord.pdf&quot;;;&quot;Fichier de preuve&quot;;;;&quot;AdditionalProof&quot;;;;;;;;;;;;;
  &quot;Parapheur/report_aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq.pdf&quot;;&quot;**Parapheur/report_aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq.pdf**&quot;;&quot;Item&quot;;&quot;report_aeaaaaaaaaecb7ovabhryamreeao2oyaaaaq.pdf&quot;;;&quot;Rapport&quot;;;;&quot;AdditionalProof&quot;;;;;;;;;;;;;```
</pre></div>
</div>
<p><em>Exemple 3 : contenu d’un fichier « metadata.csv » déclarant un rattachement.</em></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>  &quot;File&quot;;&quot;Content.DescriptionLevel&quot;;&quot;Content.Title&quot;;**&quot;Management.UpdateOperation.ArchiveUnitIdentifierKey.MetadataName**&quot;;&quot;**Management.UpdateOperation.ArchiveUnitIdentifierKey.MetadataValue**&quot;
  &quot;Discours hors parlement&quot;;&quot;RecordGrp&quot;;&quot;Discours hors parlement&quot;;&quot;**ArchivalAgencyArchiveUnitIdentifier**&quot;;&quot;**20130456/3**&quot;
  &quot;Discours hors parlement/Discours d&#39;inauguration&quot;;&quot;RecordGrp&quot;;&quot;Discours d’inauguration&quot;;;
  &quot;Discours hors parlement/Discours d&#39;inauguration/Inauguration de Notre-Dame.odt&quot;;&quot;Item&quot;;&quot;Inauguration de Notre-Dame&quot;;;
</pre></div>
</div>
</section>
</section>
<section id="annexe-2-types-json">
<h2><span class="section-number">14.6. </span>Annexe 2 : Types JSON<a class="headerlink" href="#annexe-2-types-json" title="Lien vers cette rubrique"></a></h2>
<p>Pour les éléments propres au SEDA, le tableau suivant précise les types de certains d’entre eux :</p>
<ul class="simple">
<li><p><em>Métadonnées d’en-tête :</em></p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>obligatoire</p></th>
<th class="head"><p>string</p></th>
<th class="head"><p>number</p></th>
<th class="head"><p>boolean</p></th>
<th class="head"><p>object</p></th>
<th class="head"><p>array</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ArchivalAgreement</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>MessageIdentifier</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Comment</p></td>
<td><p></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id169" id="id113" role="doc-noteref"><span class="fn-bracket">[</span>31<span class="fn-bracket">]</span></a></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>OriginatingAgencyIdentifier</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SubmissionAgencyIdentifier</p></td>
<td><p></p></td>
<td><p>x</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>ArchivalAgencyIdentifier</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>TransferringAgencyIdentifier</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>ArchivalProfile</p></td>
<td><p></p></td>
<td><p>x</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>AcquisitionInformation</p></td>
<td><p></p></td>
<td><p>x</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><em>Métadonnées descriptives et de gestion d’une unité archivistique :</em></p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>obligatoire</p></th>
<th class="head"><p>string</p></th>
<th class="head"><p>number</p></th>
<th class="head"><p>boolean</p></th>
<th class="head"><p>object</p></th>
<th class="head"><p>array</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ArchiveUnitProfile</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>#management<a class="footnote-reference brackets" href="#id170" id="id114" role="doc-noteref"><span class="fn-bracket">[</span>32<span class="fn-bracket">]</span></a></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>AccessRule</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>AppraisalRule</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>StorageRule</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>ReuseRule</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>ClassificationRule</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>HoldRule</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Rules</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Rule</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>StartDate</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id171" id="id115" role="doc-noteref"><span class="fn-bracket">[</span>33<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>EndDate</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id172" id="id116" role="doc-noteref"><span class="fn-bracket">[</span>34<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>FinalAction<a class="footnote-reference brackets" href="#id173" id="id117" role="doc-noteref"><span class="fn-bracket">[</span>35<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Inheritance</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>PreventInheritance</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>PreventRulesId</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id174" id="id118" role="doc-noteref"><span class="fn-bracket">[</span>36<span class="fn-bracket">]</span></a></p></td>
</tr>
<tr class="row-even"><td><p>HoldEndDate</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id175" id="id119" role="doc-noteref"><span class="fn-bracket">[</span>37<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>HoldOwner</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>HoldReason</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>HoldReassessingDate</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id176" id="id120" role="doc-noteref"><span class="fn-bracket">[</span>38<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>PreventRearrangement</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>ClassificationOwner</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>ClassificationReassessingDate</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id177" id="id121" role="doc-noteref"><span class="fn-bracket">[</span>39<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>NeedReassessingAuthorization</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>ClassificationLevel</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>ClassificationAudience</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Logbook</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>NeedAuthorization</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>DescriptionLevel</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Title</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Title_</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>FilePlanPosition</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>SystemId</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>OriginatingSystemId</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>ArchivalAgencyArchiveUnitIdentifier</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>OriginatingAgencyArchiveUnitIdentifier</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>TransferringAgencyArchiveUnitIdentifier</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Description</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Description_</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>CustodialHistory</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>CustodialHistoryItem</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Type</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>DocumentType</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Language</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id178" id="id122" role="doc-noteref"><span class="fn-bracket">[</span>40<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>DescriptionLanguage</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id179" id="id123" role="doc-noteref"><span class="fn-bracket">[</span>41<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Version</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Tag</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Keyword</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>KeywordContent</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>KeywordReference</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>KeywordType</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Coverage</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Spatial</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Temporal</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Juridictional</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>OriginatingAgency</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>SubmissionAgency</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Identifier</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>AuthorizedAgent</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Writer</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Addressee</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Recipient</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Transmitter</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Sender</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>FirstName</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>BirthName</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>FullName</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>GivenName</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Gender</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>BirthDate</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id180" id="id124" role="doc-noteref"><span class="fn-bracket">[</span>42<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>DeathDate</p></td>
<td><p><br></p></td>
<td><p>x<a class="footnote-reference brackets" href="#id181" id="id125" role="doc-noteref"><span class="fn-bracket">[</span>43<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>BirthPlace</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>DeathPlace</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Geogname</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Address</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>PostalCode</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>City</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Region</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Country</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Nationality</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Corpname</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Identifier</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Activity</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Position</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Role</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Mandate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>RelatedObjectReference</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>IsVersionOf</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Replaces</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Requires</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>IsPartOf</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>References</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>ArchiveUnitRefId</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>DataObjectReference</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>DataObjectReferenceId</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>DataObjectGroupReferenceId</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>RepositoryArchiveUnitPID</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>RepositoryObjectPID</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>CreatedDate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>TransactedDate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>AcquiredDate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>SentDate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>ReceivedDate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>RegisteredDate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>StartDate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>EndDate</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Event</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>evId<a class="footnote-reference brackets" href="#id182" id="id126" role="doc-noteref"><span class="fn-bracket">[</span>44<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>evTypeProc<a class="footnote-reference brackets" href="#id183" id="id127" role="doc-noteref"><span class="fn-bracket">[</span>45<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>evType<a class="footnote-reference brackets" href="#id184" id="id128" role="doc-noteref"><span class="fn-bracket">[</span>46<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>EvDateTime<a class="footnote-reference brackets" href="#id185" id="id129" role="doc-noteref"><span class="fn-bracket">[</span>47<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>evTypeDetail<a class="footnote-reference brackets" href="#id186" id="id130" role="doc-noteref"><span class="fn-bracket">[</span>48<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>outcome<a class="footnote-reference brackets" href="#id187" id="id131" role="doc-noteref"><span class="fn-bracket">[</span>49<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>outDetail<a class="footnote-reference brackets" href="#id188" id="id132" role="doc-noteref"><span class="fn-bracket">[</span>50<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>outMessg<a class="footnote-reference brackets" href="#id189" id="id133" role="doc-noteref"><span class="fn-bracket">[</span>51<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>evDetData<a class="footnote-reference brackets" href="#id190" id="id134" role="doc-noteref"><span class="fn-bracket">[</span>52<span class="fn-bracket">]</span></a></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Signature</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>Signer</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Validator</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>ValidationTime</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>MasterData</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>ReferencedObject</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>SignedObjectId</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>SignedObjectDigest</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>Gps</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>GpsVersionId</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>GpsAltitude</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>GpsAltitudeRef</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>GpsLatitude</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>GpsLongitude</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-even"><td><p>GpsLongitudeRef</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
<tr class="row-odd"><td><p>GpsDateStamp</p></td>
<td><p><br></p></td>
<td><p>x</p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
<td><p><br></p></td>
</tr>
</tbody>
</table>
</section>
<section id="annexe-3-liste-des-points-dapi">
<h2><span class="section-number">14.7. </span>Annexe 3 : Liste des points d’API<a class="headerlink" href="#annexe-3-liste-des-points-dapi" title="Lien vers cette rubrique"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Permission</p></th>
<th class="head"><p>Verbe</p></th>
<th class="head"><p>EndPoint</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>project</p></td>
<td><p>Création d’un projet de versement</p></td>
<td><p>project:create</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/projects/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Récupère la liste des projets de versement</p></td>
<td><p>project:read</p></td>
<td><p>GET</p></td>
<td><p>/collect-external/v1/projects/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Récupère un projet de versement</p></td>
<td><p>project:id:read</p></td>
<td><p>GET</p></td>
<td><p>/collect-external/v1/projects/{projectId}/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Récupère la liste des projets de versement par critère de recherche</p></td>
<td><p>project:query:read</p></td>
<td><p>GET</p></td>
<td><p>project:query:read</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Mise à jour d’un projet de versement</p></td>
<td><p>project:update</p></td>
<td><p>PUT</p></td>
<td><p>/collect-external/v1/projects</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Supprime un projet de versement</p></td>
<td><p>project:id:delete</p></td>
<td><p>DELETE</p></td>
<td><p>/collect-external/v1/projects/{projectId}/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Verser une archive arborescente ZIP à un projet de versement automatique sans transaction</p></td>
<td><p>project:id:zip:create</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/projects/{projectId}/upload/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Récupérer la liste des transactions du projet</p></td>
<td><p>project:id:transactions</p></td>
<td><p>GET</p></td>
<td><p>/collect-external/v1/projects/{projectId}/transactions/</p></td>
</tr>
<tr class="row-even"><td><p>transaction</p></td>
<td><p>Création de la transaction</p></td>
<td><p>transaction:create</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/projects/{projectId}/transactions/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Mise à jour d’une transaction</p></td>
<td><p>transaction:update</p></td>
<td><p>PUT</p></td>
<td><p>/collect-external/v1/transactions/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Récupère une transaction</p></td>
<td><p>transaction:id:read</p></td>
<td><p>GET</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Clôture de la transaction</p></td>
<td><p>transaction:close</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/close/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Envoi de la transaction</p></td>
<td><p>transaction:send</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/send/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Abandonner une transaction</p></td>
<td><p>transaction:abort</p></td>
<td><p>PUT</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/abort/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Rouvrir une transaction</p></td>
<td><p>transaction:reopen</p></td>
<td><p>PUT</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/reopen/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Charge les binaires en lot</p></td>
<td><p>transaction:zip:create</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/upload/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Crée une unité archivistique</p></td>
<td><p>transaction:unit:create</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/units/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Récupère toutes les unités archivistiques</p></td>
<td><p>transaction:unit:read</p></td>
<td><p>GET</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/units/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Supprime une transaction</p></td>
<td><p>transaction:id:delete</p></td>
<td><p>DELETE</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/</p></td>
</tr>
<tr class="row-odd"><td><p>units</p></td>
<td><p>Crée ou modifie un groupe d’objets techniques</p></td>
<td><p>transaction:object:upsert</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/units/{unitId}/objects/{usage}/{version}/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Insère ou modifie un objet binaire</p></td>
<td><p>transaction:binary:upsert</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/units/{unitId}/objects/{usage}/{version}/binary/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Récupère une unité archivistique</p></td>
<td><p>transaction:unit:id:read</p></td>
<td><p>GET</p></td>
<td><p>/collect-external/v1/units/{{unit-id}}/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Mettre à jour les unités archivistiques</p></td>
<td><p>transaction:id:units:update</p></td>
<td><p>PUT</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/units/</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Télécharge un usage/version du binaire<br> d’un groupe d’objets techniques</p></td>
<td><p>transaction:binary:read</p></td>
<td><p>GET</p></td>
<td><p>/collect-external/v1/units/{unitId}/objects/{usage}/{version}/binary/</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Réorganisation des arborescences</p></td>
<td><p>transaction:reclassification</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/reclassification</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Supprime des archives</p></td>
<td><p>transaction:deletion:action</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/deletion</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Elimine des archives</p></td>
<td><p>transaction:elimination:action</p></td>
<td><p>POST</p></td>
<td><p>/collect-external/v1/transactions/{transactionId}/elimination/action</p></td>
</tr>
<tr class="row-odd"><td><p>objects</p></td>
<td><p>Récupère un groupe d’objets techniques</p></td>
<td><p>transaction:object:read</p></td>
<td><p>GET</p></td>
<td><p>/collect-external/v1/objects/{gotId}/</p></td>
</tr>
</tbody>
</table>
</section>
<section id="annexe-4-exemples-de-transformations-jslt">
<h2><span class="section-number">14.8. </span>Annexe 4 : Exemples de transformations JSLT<a class="headerlink" href="#annexe-4-exemples-de-transformations-jslt" title="Lien vers cette rubrique"></a></h2>
<p>*Nota bene *: les cas présentés ci-dessous sont des exemples fictifs.</p>
<section id="exemple-1">
<h3><span class="section-number">14.8.1. </span>Exemple 1<a class="headerlink" href="#exemple-1" title="Lien vers cette rubrique"></a></h3>
<p>On souhaite transformer les métadonnées du fichier .csv suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">NomDocument</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Description</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Cote</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">DateDerniereModif</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">SortFinal</span>
<span class="s2">&quot;file1.txt&quot;</span><span class="p">;</span><span class="s2">&quot;Title 1&quot;</span><span class="p">;</span><span class="n">description</span> <span class="n">title</span> <span class="mi">1</span><span class="p">;</span><span class="s2">&quot;1 M 59&quot;</span><span class="p">;</span><span class="s2">&quot;2007-06-17&quot;</span><span class="p">;</span><span class="s2">&quot;Destroy&quot;</span>
<span class="s2">&quot;file2.txt&quot;</span><span class="p">;</span><span class="s2">&quot;Title 2&quot;</span><span class="p">;</span><span class="n">description</span> <span class="n">title</span> <span class="mi">2</span><span class="p">;</span><span class="s2">&quot;1 M 60&quot;</span><span class="p">;</span><span class="s2">&quot;2007-03-02&quot;</span><span class="p">;</span><span class="s2">&quot;Keep&quot;</span>
<span class="s2">&quot;file3.txt&quot;</span><span class="p">;</span><span class="s2">&quot;Title 3&quot;</span><span class="p">;</span><span class="n">description</span> <span class="n">title</span> <span class="mi">3</span><span class="p">;</span><span class="s2">&quot;1 M 61&quot;</span><span class="p">;</span><span class="s2">&quot;2022-07-12&quot;</span><span class="p">;</span><span class="s2">&quot;Keep&quot;</span>
<span class="s2">&quot;file4.txt&quot;</span><span class="p">;</span><span class="s2">&quot;Title 4&quot;</span><span class="p">;</span><span class="n">description</span> <span class="n">title</span> <span class="mi">4</span><span class="p">;</span><span class="s2">&quot;1 M 62&quot;</span><span class="p">;</span><span class="s2">&quot;2011-11-27&quot;</span><span class="p">;</span><span class="s2">&quot;Destroy&quot;</span>
</pre></div>
</div>
<p>Un enregistrement (correspondant à une ligne du fichier .csv) exprimé en JSON correspond à :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;NomDocument&quot;</span><span class="p">:</span> <span class="s2">&quot;Title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;description title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cote&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1 M 59&quot;</span><span class="p">],</span>
    <span class="s2">&quot;DateDerniereModif&quot;</span><span class="p">:[</span><span class="s2">&quot;2007-06-17&quot;</span><span class="p">],</span>
    <span class="s2">&quot;SortFinal&quot;</span><span class="p">:[</span><span class="s2">&quot;Destroy&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>En sachant qu’on souhaite :</p>
<ul class="simple">
<li><p>ajouter systématiquement une métadonnée DescriptionLevel avec « Item » comme valeur,</p></li>
<li><p>créer une métadonnée ArchivalAgencyArchiveUnitIdentifier reprenant les valeurs de la métadonnée Cote,</p></li>
<li><p>créer une métadonnée Title reprenant les valeurs de la métadonnée NomDocument,</p></li>
<li><p>ajouter des règles de gestion :</p>
<ul>
<li><p>règle de communicabilité avec « ACC-00001 » pour règle et les valeurs de la métadonnée DateDerniereModif pour date de début (StartDate),</p></li>
<li><p>une DUA avec pour sort final les valeurs de la métadonnée SortFinal</p></li>
</ul>
</li>
<li><p>ne pas reprendre les contenus des colonnes NomDocument, Cote, DateDerniereModif, SortFinal,</p></li>
<li><p>récupérere le contenu de la métadonnée Description,</p></li>
</ul>
<p>les commandes JSLT prendront la forme suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
	<span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="o">.</span><span class="n">NomDocument</span><span class="p">,</span>
    <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span><span class="p">:</span> <span class="o">.</span><span class="n">Cote</span><span class="p">,</span>
    <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;AccessRule&quot;</span> <span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;Rules&quot;</span><span class="p">:[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;Rule&quot;</span><span class="p">:</span><span class="s2">&quot;ACC-00001&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span><span class="o">.</span><span class="n">DateDerniereModif</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">],</span>
        <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:[</span>
            <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span><span class="o">.</span><span class="n">SortFinal</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="o">*</span> <span class="o">-</span> <span class="n">NomDocument</span><span class="p">,</span> <span class="n">Cote</span><span class="p">,</span> <span class="n">DateDerniereModif</span><span class="p">,</span> <span class="n">SortFinal</span> <span class="p">:</span> <span class="o">.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Le résultat obtenu sera le suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;Title&quot;</span> <span class="p">:</span> <span class="s2">&quot;Title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span> <span class="p">:</span> <span class="s2">&quot;1 M 59&quot;</span><span class="p">,</span>
    <span class="s2">&quot;#management&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;AccessRule&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
        <span class="s2">&quot;Rule&quot;</span> <span class="p">:</span> <span class="s2">&quot;ACC-00001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;StartDate&quot;</span> <span class="p">:</span> <span class="s2">&quot;2007-06-17&quot;</span>
      <span class="p">}</span> <span class="p">],</span>
	  <span class="s2">&quot;AppraisaRule&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
      <span class="p">},</span><span class="s2">&quot;FinalAction&quot;</span> <span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span> <span class="p">]</span> 
    <span class="p">},</span>
    <span class="s2">&quot;Description&quot;</span> <span class="p">:</span> <span class="s2">&quot;description title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DescriptionLevel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Item&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="exemple-2">
<h3><span class="section-number">14.8.2. </span>Exemple 2<a class="headerlink" href="#exemple-2" title="Lien vers cette rubrique"></a></h3>
<p>On souhaite transformer les métadonnées du fichier .csv suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Title</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Description</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">StartDate</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">ArchivalAgencyArchiveUnitIdentifier</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Tag</span><span class="p">;</span><span class="n">Management</span><span class="o">.</span><span class="n">AppraisalRule</span><span class="o">.</span><span class="n">FinalAction</span>
<span class="s2">&quot;dossier/file1.txt&quot;</span><span class="p">;</span><span class="s2">&quot;Title 1&quot;</span><span class="p">;</span><span class="s2">&quot;description title 1&quot;</span><span class="p">;</span><span class="s2">&quot;2007-06-17&quot;</span><span class="p">;</span><span class="s2">&quot;1 M 59&quot;</span><span class="p">;</span><span class="s2">&quot;facture&quot;</span><span class="p">;</span><span class="s2">&quot;Destroy&quot;</span>
<span class="s2">&quot;dossier/file2.txt&quot;</span><span class="p">;</span><span class="s2">&quot;Title 2&quot;</span><span class="p">;</span><span class="s2">&quot;description title 2&quot;</span><span class="p">;</span><span class="s2">&quot;2007-03-02&quot;</span><span class="p">;</span><span class="s2">&quot;1 M 60&quot;</span><span class="p">;</span><span class="s2">&quot;mail&quot;</span><span class="p">;</span><span class="s2">&quot;Keep&quot;</span>
<span class="s2">&quot;dossier/file3.txt&quot;</span><span class="p">;</span><span class="s2">&quot;Title 3&quot;</span><span class="p">;</span><span class="s2">&quot;description title 3&quot;</span><span class="p">;</span><span class="s2">&quot;2022-07-12&quot;</span><span class="p">;</span><span class="s2">&quot;1 M 61&quot;</span><span class="p">;</span><span class="s2">&quot;dossierRH&quot;</span><span class="p">;</span><span class="s2">&quot;Keep&quot;</span>
<span class="s2">&quot;dossier/file4.txt&quot;</span><span class="p">;</span><span class="s2">&quot;Title 4&quot;</span><span class="p">;</span><span class="s2">&quot;description title 4&quot;</span><span class="p">;</span><span class="s2">&quot;2011-11-27&quot;</span><span class="p">;</span><span class="s2">&quot;1 M 62&quot;</span><span class="p">;</span><span class="s2">&quot;dossierRH&quot;</span><span class="p">;</span><span class="s2">&quot;Keep&quot;</span>
<span class="s2">&quot;dossier&quot;</span><span class="p">;</span><span class="s2">&quot;Dossier&quot;</span><span class="p">;</span><span class="s2">&quot;description dossier&quot;</span><span class="p">;</span><span class="s2">&quot;2003-04-13&quot;</span><span class="p">;;;</span><span class="s2">&quot;Destroy&quot;</span>
</pre></div>
</div>
<p>Un enregistrement (correspondant à une ligne du fichier .csv) exprimé en JSON correspond à :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;description title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span><span class="s2">&quot;2007-06-17&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;1 M 59&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Tag&quot;</span><span class="p">:[</span><span class="s2">&quot;facture&quot;</span><span class="p">]</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>En sachant qu’on souhaite :</p>
<ul class="simple">
<li><p>ajouter une DUA en fonction des tags,</p></li>
<li><p>utiliser la StartDate pour la Startdate de la DUA,</p></li>
</ul>
<p>les commandes JSLT prendront la forme suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;AppraisalRule&quot;</span> <span class="p">:</span> <span class="k">if</span> <span class="p">(</span><span class="o">.</span><span class="n">Tag</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;facture&quot;</span><span class="p">])</span> <span class="p">{</span>
            <span class="s2">&quot;Rules&quot;</span><span class="p">:[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;Rule&quot;</span><span class="p">:</span><span class="s2">&quot;APP-00001&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span><span class="o">.</span><span class="n">StartDate</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">.</span><span class="n">Tag</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;mail&quot;</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="s2">&quot;Rules&quot;</span><span class="p">:[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;Rule&quot;</span><span class="p">:</span><span class="s2">&quot;APP-00002&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span><span class="o">.</span><span class="n">StartDate</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">.</span><span class="n">Tag</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;dossierRH&quot;</span><span class="p">]){</span>
            <span class="s2">&quot;Rules&quot;</span><span class="p">:[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;Rule&quot;</span><span class="p">:</span><span class="s2">&quot;APP-00003&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span><span class="o">.</span><span class="n">StartDate</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
        <span class="p">},</span>
        <span class="o">*</span><span class="p">:</span> <span class="o">.</span>
    <span class="p">},</span>
    <span class="o">*</span> <span class="o">-</span> <span class="n">StartDate</span><span class="p">:</span> <span class="o">.</span> 
<span class="p">}</span>
</pre></div>
</div>
<p>Le résultat obtenu sera le suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;#management&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;AppraisalRule&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Rules&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
          <span class="s2">&quot;Rule&quot;</span> <span class="p">:</span> <span class="s2">&quot;APP-00001&quot;</span><span class="p">,</span>
          <span class="s2">&quot;StartDate&quot;</span> <span class="p">:</span> <span class="s2">&quot;2007-06-17&quot;</span>
        <span class="p">}</span> <span class="p">],</span>
        <span class="s2">&quot;FinalAction&quot;</span> <span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;Title&quot;</span> <span class="p">:</span> <span class="s2">&quot;Title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Description&quot;</span> <span class="p">:</span> <span class="s2">&quot;description title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DescriptionLevel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span> <span class="p">:</span> <span class="s2">&quot;1 M 59&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Tag&quot;</span><span class="p">:[</span><span class="s2">&quot;facture&quot;</span><span class="p">]</span>
  <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="exemple-3">
<h3><span class="section-number">14.8.3. </span>Exemple 3<a class="headerlink" href="#exemple-3" title="Lien vers cette rubrique"></a></h3>
<p>On souhaite transformer les métadonnées du fichier .csv suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Title</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Description</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">ArchivalAgencyArchiveUnitIdentifier</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Addressee</span><span class="mf">.0</span><span class="o">.</span><span class="n">FirstName</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Addressee</span><span class="mf">.0</span><span class="o">.</span><span class="n">BirthName</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Addressee</span><span class="mf">.0</span><span class="o">.</span><span class="n">BirthDate</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Addressee</span><span class="mf">.1</span><span class="o">.</span><span class="n">FirstName</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Addressee</span><span class="mf">.1</span><span class="o">.</span><span class="n">BirthName</span><span class="p">;</span><span class="n">Content</span><span class="o">.</span><span class="n">Addressee</span><span class="mf">.1</span><span class="o">.</span><span class="n">BirthDate</span><span class="p">;</span><span class="n">Management</span><span class="o">.</span><span class="n">AppraisalRule</span><span class="o">.</span><span class="n">Rule</span><span class="p">;</span><span class="n">Management</span><span class="o">.</span><span class="n">AppraisalRule</span><span class="o">.</span><span class="n">StartDate</span><span class="p">;</span><span class="n">Management</span><span class="o">.</span><span class="n">AppraisalRule</span><span class="o">.</span><span class="n">FinalAction</span>
<span class="s2">&quot;dossier/file1.txt&quot;</span><span class="p">;</span><span class="s2">&quot; Title 1 &quot;</span><span class="p">;</span><span class="s2">&quot;description title 1&quot;</span><span class="p">;</span><span class="s2">&quot;1 M 59&quot;</span><span class="p">;</span><span class="n">Albert</span><span class="p">;</span><span class="n">Dupont</span><span class="p">;</span><span class="mi">2000</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">17</span><span class="p">;</span><span class="n">Béré</span><span class="p">;</span><span class="n">Nice</span><span class="p">;</span><span class="s2">&quot;1998-09-17&quot;</span><span class="p">;</span><span class="s2">&quot;APP-00001&quot;</span><span class="p">;</span><span class="s2">&quot;2007-06-17&quot;</span><span class="p">;</span><span class="s2">&quot;Destroy&quot;</span>
<span class="s2">&quot;dossier/file2.txt&quot;</span><span class="p">;</span><span class="s2">&quot; Title 2 &quot;</span><span class="p">;</span><span class="s2">&quot;description title 2&quot;</span><span class="p">;</span><span class="s2">&quot;1 M 60&quot;</span><span class="p">;</span><span class="n">Marc</span><span class="p">;</span><span class="n">Aurèle</span><span class="p">;</span><span class="mi">1987</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">11</span><span class="p">;</span><span class="n">Marc</span><span class="p">;</span><span class="n">Antoine</span><span class="p">;</span><span class="s2">&quot;1990-06-14&quot;</span><span class="p">;</span><span class="s2">&quot;APP-00001&quot;</span><span class="p">;</span><span class="s2">&quot;2007-03-02&quot;</span><span class="p">;</span><span class="s2">&quot;Keep&quot;</span>
<span class="s2">&quot;dossier/file3.txt&quot;</span><span class="p">;</span><span class="s2">&quot; Title 3 &quot;</span><span class="p">;</span><span class="s2">&quot;description title 3&quot;</span><span class="p">;</span><span class="s2">&quot;1 M 61&quot;</span><span class="p">;</span><span class="n">Sarah</span><span class="p">;</span><span class="n">Bernardt</span><span class="p">;</span><span class="mi">2001</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">10</span><span class="p">;</span><span class="n">Edmond</span><span class="p">;</span><span class="n">Rostand</span><span class="p">;</span><span class="s2">&quot;2007-04-19&quot;</span><span class="p">;</span><span class="s2">&quot;APP-00003&quot;</span><span class="p">;</span><span class="s2">&quot;2022-07-12&quot;</span><span class="p">;</span><span class="s2">&quot;Keep&quot;</span>
<span class="s2">&quot;dossier/file4.txt&quot;</span><span class="p">;</span><span class="s2">&quot; Title 4 &quot;</span><span class="p">;</span><span class="s2">&quot;description title 4&quot;</span><span class="p">;</span><span class="s2">&quot;1 M 62&quot;</span><span class="p">;</span><span class="n">Marc</span><span class="p">;</span><span class="n">Aurèle</span><span class="p">;</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">31</span><span class="p">;</span><span class="n">Jules</span><span class="p">;</span><span class="n">César</span><span class="p">;</span><span class="s2">&quot;2000-10-14&quot;</span><span class="p">;</span><span class="n">APP</span><span class="o">-</span><span class="mi">00002</span><span class="s2">&quot;;&quot;</span><span class="mi">2011</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">27</span><span class="s2">&quot;;&quot;</span><span class="n">Keep</span><span class="s2">&quot;</span>
<span class="s2">&quot;dossier&quot;</span><span class="p">;</span><span class="s2">&quot;Dossier&quot;</span><span class="p">;</span><span class="s2">&quot;description dossier&quot;</span><span class="p">;;;;;;;;</span><span class="s2">&quot;APP-00002&quot;</span><span class="p">;</span><span class="s2">&quot;2003-04-13&quot;</span><span class="p">;</span><span class="s2">&quot;Destroy&quot;</span>
</pre></div>
</div>
<p>Un enregistrement (correspondant à une ligne du fichier .csv) exprimé en JSON correspond à :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;#management&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;AppraisalRule&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Rules&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;Rule&quot;</span><span class="p">:</span> <span class="s2">&quot;APP-00001&quot;</span><span class="p">,</span>
            <span class="s2">&quot;StartDate&quot;</span><span class="p">:</span> <span class="s2">&quot;17/06/2007&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;FinalAction&quot;</span><span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;description title 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DescriptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;1 M 59&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Addressee&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;Albert&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;Dupont&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BirthDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2000-10-14&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;FirstName&quot;</span><span class="p">:</span> <span class="s2">&quot;Béré&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BirthName&quot;</span><span class="p">:</span> <span class="s2">&quot;Nice&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BirthDate&quot;</span><span class="p">:</span> <span class="s2">&quot;1998-09-17&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>En sachant qu’on souhaite :</p>
<ul class="simple">
<li><p>modifier la cote de l’ensemble des unités archivistiques en la remplaçant par une empreinte calculée à partir des titres,</p></li>
<li><p>mettre les titres en majuscules et enlever les espaces vides présents,</p></li>
<li><p>remplacer le mot « title » présent dans la métadonnée Description par « titre »,</p></li>
<li><p>ne pas reprendre les contenus des métadonnées ArchivalAgencyArchiveUnitIdentifier, Description puisqu’elles ont été traitées spécifiquement dans des commandes,</p></li>
</ul>
<p>les commandes JSLT prendront la forme suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span><span class="p">:</span><span class="n">sha256</span><span class="o">-</span><span class="nb">hex</span><span class="p">(</span><span class="o">.</span><span class="n">Title</span><span class="p">),</span>
    <span class="s2">&quot;Title&quot;</span><span class="p">:</span><span class="n">trim</span><span class="p">(</span><span class="n">uppercase</span><span class="p">(</span><span class="o">.</span><span class="n">Title</span><span class="p">)),</span>
    <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="n">replace</span><span class="p">(</span><span class="o">.</span><span class="n">Description</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="s2">&quot;titre&quot;</span><span class="p">),</span>
    <span class="o">*-</span> <span class="n">ArchivalAgencyArchiveUnitIdentifier</span><span class="p">,</span> <span class="n">Description</span><span class="p">:</span> <span class="o">.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Le résultat obtenu sera le suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;ArchivalAgencyArchiveUnitIdentifier&quot;</span> <span class="p">:</span> <span class="s2">&quot;ab03af41c2940e7584b62df48a964db37cd0202137fc60a9e782d16d4cc03843&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Title&quot;</span> <span class="p">:</span> <span class="s2">&quot;TITLE 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;#management&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;AppraisalRule&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Rules&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
          <span class="s2">&quot;Rule&quot;</span> <span class="p">:</span> <span class="s2">&quot;APP-00001&quot;</span><span class="p">,</span>
          <span class="s2">&quot;StartDate&quot;</span> <span class="p">:</span> <span class="s2">&quot;17/06/2007&quot;</span>
        <span class="p">}</span> <span class="p">],</span>
        <span class="s2">&quot;FinalAction&quot;</span> <span class="p">:</span> <span class="s2">&quot;Destroy&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;Description&quot;</span> <span class="p">:</span> <span class="s2">&quot;description titre 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DescriptionLevel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Item&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Addressee&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
      <span class="s2">&quot;FirstName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Marc&quot;</span><span class="p">,</span>
      <span class="s2">&quot;BirthName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Aurèle&quot;</span><span class="p">,</span>
      <span class="s2">&quot;BirthDate&quot;</span> <span class="p">:</span> <span class="s2">&quot;2000-10-14&quot;</span>
    <span class="p">},</span> <span class="p">{</span>
      <span class="s2">&quot;FirstName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Béré&quot;</span><span class="p">,</span>
      <span class="s2">&quot;BirthName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Nice&quot;</span><span class="p">,</span>
      <span class="s2">&quot;BirthDate&quot;</span> <span class="p">:</span> <span class="s2">&quot;1998-09-17&quot;</span>
    <span class="p">}</span> <span class="p">]</span>
  <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="exemple-4">
<h3><span class="section-number">14.8.4. </span>Exemple 4<a class="headerlink" href="#exemple-4" title="Lien vers cette rubrique"></a></h3>
<p>Voici un exemple complexe de commandes JSLT contenant des variables et des expressions conditionnelles appelant ces variables :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>let hasAppraisal = .&quot;#management&quot;.AppraisalRule != null
let existingAppraisalRules = .&quot;#management&quot;.AppraisalRule.Rules
let existingAppraisalFinalAction = .&quot;#management&quot;.AppraisalRule.FinalAction

let appraisalRuleToAdd = if      (contains(.DOSSIER[0].nomTypeDossier[0], [&quot;DP&quot;, &quot;PC&quot;, &quot;PA&quot;, &quot;PD&quot;, &quot;DT&quot;])) &quot;XXX&quot;
                         else if (contains(.DOSSIER[0].nomTypeDossier[0], [ &quot;CUa&quot;, &quot;CUb&quot;]))                &quot;YYY&quot;
                         else                                                                              null

let appraisalRuleStartDate = if ( contains(.TYPE_DOSSIER[0], [ &quot;CUa&quot;, &quot;CUb&quot;]) ) .terrains[0].dtDecisionDossierCU[0]
                             else                                               .decisionsUrba[0].dtDecisionUrba[0]

let appraisalFinalAction = if        (contains(.DOSSIER[0].nomTypeDossier[0], [&quot;CUa&quot;, &quot;CUb&quot;]) and contains(.DOSSIER[0].nomEtatsOuSousEtatsGenera[0], [ &quot;Rejet&quot;, &quot;Refus&quot;] ))    &quot;Destroy&quot;
                           else if   (contains(.DOSSIER[0].nomTypeDossier[0], [&quot;CUa&quot;, &quot;CUb&quot;]) and contains(.DOSSIER[0].nomEtatsOuSousEtatsGenera[0], [ &quot;Accord &quot;, &quot;Sursis&quot;] )) &quot;Keep&quot;
                           else                                                                                                                                                 null
        
{
    &quot;#management&quot;: {
        // Only set AppraisalRule if existing field (rule, properties and/or inheritance) OR new rule to set
        &quot;AppraisalRule&quot;: if ($hasAppraisal or $appraisalRuleToAdd != null) {
            // Add new rule to existing ones
            &quot;Rules&quot;: if ($appraisalRuleToAdd != null)     [ { &quot;Rule&quot;: $appraisalRuleToAdd, &quot;StartDate&quot;: $appraisalRuleStartDate } ] + $existingAppraisalRules
                else if ($existingAppraisalRules != null) $existingAppraisalRules
                else                                      [],
            // Final action is required, if no value found set &quot;Keep&quot;
            &quot;FinalAction&quot;: if($appraisalFinalAction != null)               $appraisalFinalAction 
                           else if ($existingAppraisalFinalAction != null) $existingAppraisalFinalAction
                           else                                            &quot;Keep&quot;,
            * : .
        } else {},
        * : .
    },
    * : .
}
</pre></div>
</div>
</section>
</section>
<section id="annexe-5-liste-de-fonctions-jslt">
<h2><span class="section-number">14.9. </span>Annexe 5 : Liste de fonctions JSLT<a class="headerlink" href="#annexe-5-liste-de-fonctions-jslt" title="Lien vers cette rubrique"></a></h2>
<p>*Nota bene *: les cas présentés ne sont pas exhaustifs et sont issus de la documentation disponible sur le site suivant : https://github.com/schibsted/jslt/blob/master/functions.md.</p>
<section id="fonctions-generales">
<h3><span class="section-number">14.9.1. </span>Fonctions générales<a class="headerlink" href="#fonctions-generales" title="Lien vers cette rubrique"></a></h3>
<p><strong>contains(element, sequence) -&gt; boolean	oui</strong></p>
<p>Renvoie « true » si <em>element</em> est contenu dans <em>sequence</em>, sinon renvoie « false ».
<em>sequence</em> peut être un tableau, une chaîne de caractères ou un objet :</p>
<ul class="simple">
<li><p>Si <em>sequence</em> est un tableau, <em>element</em> doit être un élément de ce tableau.</p></li>
<li><p>Si <em>sequence</em> est une chaîne de caractères, <em>element</em> est converti en chaîne et doit être une sous-chaîne de sequence. Si element est « null », le résultat est « false ».</p></li>
<li><p>Si <em>sequence</em> est un objet, <em>element</em> est converti en chaîne et doit être une clé de l’objet.</p></li>
</ul>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">contains</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>      <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="n">contains</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>         <span class="o">=&gt;</span> <span class="n">true</span>  
<span class="o">-</span>   <span class="n">contains</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>         <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="n">contains</span><span class="p">(</span><span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;no&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="n">true</span>  
<span class="o">-</span>   <span class="n">contains</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;1&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">})</span>     <span class="o">=&gt;</span> <span class="n">true</span>  
<span class="o">-</span>   <span class="n">contains</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">,</span> <span class="s2">&quot;abc&quot;</span><span class="p">)</span>          <span class="o">=&gt;</span> <span class="n">true</span>
</pre></div>
</div>
<p><strong>size(sequence) -&gt; integer</strong></p>
<p>Renvoie le nombre d’éléments dans <em>sequence</em>, qui peut être un tableau, un objet ou une chaîne de caractères.
Si <em>sequence</em> est « null », la fonction renvoie « null ».</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="mi">3</span>  
<span class="o">-</span>   <span class="n">size</span><span class="p">({</span><span class="s2">&quot;1&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="n">size</span><span class="p">(</span><span class="s2">&quot;abcdef&quot;</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="mi">6</span>  
<span class="o">-</span>   <span class="n">size</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>      <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>error(message)</strong></p>
<p>Interrompt la transformation avec une erreur et affiche le message donné en paramètre.</p>
<p><em>Exemple :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="ow">not</span><span class="p">(</span><span class="ow">is</span><span class="o">-</span><span class="n">array</span><span class="p">(</span><span class="o">.</span><span class="n">things</span><span class="p">)))</span>  
  <span class="n">error</span><span class="p">(</span><span class="s2">&quot;&#39;things&#39; is not an array&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>fallback(arg1, arg2, …) -&gt; value</strong></p>
<p>Renvoie le premier argument qui a une valeur, c’est-à-dire le premier qui n’est ni « null », ni un tableau vide « [] », ni un objet vide « {} ».</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">fallback</span><span class="p">(</span><span class="o">.</span><span class="n">not_existing_key</span><span class="p">,</span> <span class="o">.</span><span class="n">another_not_existing</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="n">fallback</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{},</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>                        <span class="o">=&gt;</span> <span class="s2">&quot;value&quot;</span>
</pre></div>
</div>
<p><strong>min(arg1, arg2) -&gt; value</strong></p>
<p>Renvoie l’argument le plus petit selon la comparaison.
Si un des arguments est « null », le résultat est « null ».</p>
<p><em>Exemple :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="o">-&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="nb">min</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;a&quot;</span>  
<span class="o">-</span>   <span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">null</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>max(arg1, arg2) -&gt; value</strong></p>
<p>Renvoie l’argument le plus grand selon la comparaison.
Si un des arguments est « null », le résultat est « null ».</p>
<p><em>Exemple :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="o">-&gt;</span> <span class="mi">10</span>  
<span class="o">-</span>   <span class="nb">max</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;b&quot;</span>  
<span class="o">-</span>   <span class="nb">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">null</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">null</span>  
</pre></div>
</div>
</section>
<section id="fonctions-string">
<h3><span class="section-number">14.9.2. </span>Fonctions string<a class="headerlink" href="#fonctions-string" title="Lien vers cette rubrique"></a></h3>
<p><strong>is-string(object) -&gt; boolean</strong></p>
<p>Renvoie « true » si l’argument est une chaîne de caractères, sinon renvoie « false ».</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">string</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">string</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">string</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>     <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">string</span><span class="p">([])</span>      <span class="o">=&gt;</span> <span class="n">false</span>  
</pre></div>
</div>
<p><strong>string(object, fallback?) -&gt; string</strong></p>
<p>Convertit l’argument en chaîne de caractères si cela est possible.</p>
<ul class="simple">
<li><p>Les nombres, booléens et objets sont convertis en chaînes de caractères.</p></li>
<li><p>« null » renvoie « null ».</p></li>
<li><p>Tout autre type provoque une erreur, sauf si un <em>fallback</em> est spécifié.</p></li>
</ul>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">string</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>     <span class="o">=&gt;</span> <span class="s2">&quot;123&quot;</span>  
<span class="o">-</span>   <span class="n">string</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="s2">&quot;true&quot;</span>  
<span class="o">-</span>   <span class="n">string</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">null</span>  
<span class="o">-</span>   <span class="n">string</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="o">=&gt;</span> <span class="n">error</span>  
<span class="o">-</span>   <span class="n">string</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;fallback&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;fallback&quot;</span>  <span class="o">*</span>
</pre></div>
</div>
<p><strong>test(input, regexp) -&gt; boolean</strong></p>
<p>Cette fonction renvoie « true » si et seulement si l’entrée correspond à l’expression régulière (<em>regexp</em>).
Elle renvoie « true » si l’expression correspond uniquement à une partie de la chaîne, sauf si les ancres ^ et $ sont utilisées.
Si l’entrée est « null », la fonction retourne « false ».</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">test</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">,</span> <span class="s2">&quot;\d+&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Erreur</span> <span class="p">(</span>\<span class="n">d</span> <span class="n">n</span><span class="s1">&#39;est pas un code d&#39;</span><span class="n">échappement</span> <span class="n">connu</span><span class="p">)</span>
<span class="o">-</span>   <span class="n">test</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">,</span> <span class="s2">&quot;\d+&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="n">test</span><span class="p">(</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span> <span class="s2">&quot;\d+&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span> <span class="p">(</span><span class="n">une</span> <span class="n">correspondance</span> <span class="n">partielle</span> <span class="n">suffit</span><span class="p">)</span>
<span class="o">-</span>   <span class="n">test</span><span class="p">(</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span> <span class="s2">&quot;^\d+$&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>capture(input, regexp) -&gt; object</strong></p>
<p>Si l’entrée correspond à l’expression régulière (<em>regexp</em>), la fonction retourne un objet contenant une clé pour chaque groupe nommé dans l’expression.
Si l’entrée est « null », la fonction retourne « null ».
Si l’expression ne correspond pas, un objet vide est retourné.</p>
<p>Par exemple, étant donné l’entrée suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://schemas.schibsted.io/thing/pulse-simple.json#1.json&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>la fonction <em>capture()</em> peut être utilisée avec l’expression régulière suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">capture</span><span class="p">(</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span> <span class="s2">&quot;http://(?&lt;host&gt;[^/]+)/(?&lt;rest&gt;.+)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Les deux groupes nommés (host et rest) correspondent à différentes parties de la chaîne, donc la sortie contiendra une clé pour chaque groupe nommé :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;host&quot;</span> <span class="p">:</span> <span class="s2">&quot;schemas.schibsted.io&quot;</span><span class="p">,</span>
  <span class="s2">&quot;rest&quot;</span> <span class="p">:</span> <span class="s2">&quot;thing/pulse-simple.json#1.json&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>split(string, separator) -&gt; array</strong></p>
<p>Cette fonction divise la chaîne en un tableau de sous-chaînes en utilisant <em>separator</em>.
Si <em>separator</em> est une chaîne vide « « , la chaîne est divisée caractère par caractère.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">split</span><span class="p">(</span><span class="s2">&quot;a,b,c&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>  
<span class="o">-</span>   <span class="n">split</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">]</span>  
<span class="o">-</span>   <span class="n">split</span><span class="p">(</span><span class="s2">&quot;one|two&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>join(array, separator) -&gt; string</strong></p>
<p>Cette fonction concatène les éléments du tableau en une seule chaîne de caractères, séparés par <em>separator</em>.
Si <em>array</em> est vide, une chaîne vide est renvoyée.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">join</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="s2">&quot;a,b,c&quot;</span>  
<span class="o">-</span>   <span class="n">join</span><span class="p">([</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">],</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span>   <span class="o">=&gt;</span> <span class="s2">&quot;one|two&quot;</span>  
<span class="o">-</span>   <span class="n">join</span><span class="p">([],</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>               <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span>  
</pre></div>
</div>
<p><strong>lowercase(string) -&gt; string</strong></p>
<p>Convertit la chaîne de caractères en minuscules.
Si l’argument est « null », il est retourné tel quel.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">lowercase</span><span class="p">(</span><span class="s2">&quot;HELLO&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;hello&quot;</span>  
<span class="o">-</span>   <span class="n">lowercase</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">null</span>  
</pre></div>
</div>
<p><em><strong>Point d’attention</strong></em>: les fonctions <em>lowercase()</em> et <em>uppercase()</em> ne comprennent que les caractères ASCII.</p>
<p><strong>uppercase(string) -&gt; string</strong></p>
<p>Convertit la chaîne en majuscules.
Si l’argument est null, il est retourné tel quel.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">uppercase</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;HELLO&quot;</span>  
<span class="o">-</span>   <span class="n">uppercase</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><em><strong>Point d’attention</strong></em>: les fonctions <em>lowercase()</em> et <em>uppercase()</em> ne comprennent que les caractères ASCII.</p>
<p><strong>sha256-hex(string) -&gt; string</strong></p>
<p>Cette fonction génère une chaîne de caractères contenant la représentation hexadécimale du hachage SHA256 de la chaîne d’entrée.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">sha256</span><span class="o">-</span><span class="nb">hex</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae&quot;</span>
<span class="o">-</span>   <span class="n">sha256</span><span class="o">-</span><span class="nb">hex</span><span class="p">(</span><span class="s2">&quot;42&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;73475cb40a568e8da8a045ced110137e159f890ac4da883b6b17dc651b3a8049&quot;</span>
<span class="o">-</span>   <span class="n">sha256</span><span class="o">-</span><span class="nb">hex</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;73475cb40a568e8da8a045ced110137e159f890ac4da883b6b17dc651b3a8049&quot;</span>
<span class="o">-</span>   <span class="n">sha256</span><span class="o">-</span><span class="nb">hex</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>starts-with(tested, prefix) -&gt; boolean</strong></p>
<p>Renvoie « true » si et seulement si la chaîne testée commence par le préfixe (<em>prefix</em>).</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">starts</span><span class="o">-</span><span class="k">with</span><span class="p">(</span><span class="s2">&quot;prohibition&quot;</span><span class="p">,</span> <span class="s2">&quot;pro&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="n">starts</span><span class="o">-</span><span class="k">with</span><span class="p">(</span><span class="s2">&quot;prohibition&quot;</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="n">starts</span><span class="o">-</span><span class="k">with</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>ends-with(tested, suffix) -&gt; boolean</strong></p>
<p>Renvoie « true » si et seulement si la chaîne testée se termine par le suffixe (<em>suffix</em>).</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">ends</span><span class="o">-</span><span class="k">with</span><span class="p">(</span><span class="s2">&quot;prohibition&quot;</span><span class="p">,</span> <span class="s2">&quot;pro&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="n">ends</span><span class="o">-</span><span class="k">with</span><span class="p">(</span><span class="s2">&quot;prohibition&quot;</span><span class="p">,</span> <span class="s2">&quot;ion&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="n">ends</span><span class="o">-</span><span class="k">with</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="s2">&quot;ion&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>from-json(string, fallback?) -&gt; value</strong></p>
<p>Cette fonction analyse la chaîne de caractères donnée (<em>string</em>) en tant que JSON et retourne le résultat. Ainsi, analyser « 22 » retournera 22. Si la chaîne est « null », la fonction retournera « null ».
Si l’argument facultatif <em>fallback</em> n’est pas spécifié, les erreurs d’analyse JSON provoqueront une erreur. Si cet argument est précisé, cette valeur sera retournée en cas d’échec de l’analyse JSON.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">from</span><span class="o">-</span><span class="n">json</span><span class="p">(</span><span class="s2">&quot;[1,2]&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">-</span>   <span class="n">from</span><span class="o">-</span><span class="n">json</span><span class="p">(</span><span class="s2">&quot;[1,2&quot;</span><span class="p">,</span> <span class="s2">&quot;BAD&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;BAD&quot;</span>
<span class="o">-</span>   <span class="n">from</span><span class="o">-</span><span class="n">json</span><span class="p">(</span><span class="s2">&quot;[1,2&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">erreur</span>
<span class="o">-</span>   <span class="n">from</span><span class="o">-</span><span class="n">json</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>to-json(value) -&gt; string</strong></p>
<p>Cette fonction est l’inverse de <em>from-json</em>. Il prend donc une valeur JSON et la sérialise sous forme de chaîne de caractères.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">to</span><span class="o">-</span><span class="n">json</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="s2">&quot;[1, 2]&quot;</span>
<span class="o">-</span>   <span class="n">to</span><span class="o">-</span><span class="n">json</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;1&quot;</span>
<span class="o">-</span>   <span class="n">to</span><span class="o">-</span><span class="n">json</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="n">foo</span><span class="s2">&quot;&quot;</span>
<span class="o">-</span>   <span class="n">to</span><span class="o">-</span><span class="n">json</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;null&quot;</span>
</pre></div>
</div>
<p><strong>replace(value, regexp, out) -&gt; string</strong></p>
<p>Cette fonction remplace chaque sous-chaîne de value correspondant à l’expression régulière <em>regexp</em> par <em>out</em>. Si <em>value</em> n’est pas une chaîne, elle est convertie en chaîne, sauf si elle est « null ». <em>regexp</em> et <em>out</em> doivent être des chaînes de caractères.</p>
<p><em><strong>Point d’attention</strong></em>: <em>regexp</em> ne peut être une chaîne vide.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">replace</span><span class="p">(</span><span class="s2">&quot;abc def ghi&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;abc-def-ghi&quot;</span>
<span class="o">-</span>   <span class="n">replace</span><span class="p">(</span><span class="s2">&quot;abc def ghi&quot;</span><span class="p">,</span> <span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;abc-def-ghi&quot;</span>
<span class="o">-</span>   <span class="n">replace</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="n">replace</span><span class="p">(</span><span class="s2">&quot; whoah&quot;</span><span class="p">,</span> <span class="s2">&quot;^\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;whoah&quot;</span>
<span class="o">-</span>   <span class="n">replace</span><span class="p">(</span><span class="s2">&quot;abc def ghi&quot;</span><span class="p">,</span> <span class="s2">&quot;[a-z]&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;xxx xxx xxx&quot;</span>
<span class="o">-</span>   <span class="n">replace</span><span class="p">(</span><span class="s2">&quot;abc def ghi&quot;</span><span class="p">,</span> <span class="s2">&quot;[a-z]+&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;x x x&quot;</span>
</pre></div>
</div>
<p><strong>trim(string) -&gt; string</strong></p>
<p>Cette fonction supprime les espaces au début et à la fin de la chaîne.
Si l’argument est « null », il est retourné tel quel. Les autres valeurs non textuelles sont converties en chaînes de caractères.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">trim</span><span class="p">(</span><span class="s2">&quot;  hello  &quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;hello&quot;</span>
<span class="o">-</span>   <span class="n">trim</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>       <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="n">trim</span><span class="p">(</span><span class="s2">&quot;abc </span><span class="se">\t\r\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;abc&quot;</span>
</pre></div>
</div>
<p><strong>uuid(long, long) -&gt; string</strong></p>
<p>Cette fonction génère une chaîne UUID formatée avec des tirets.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">uuid</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="s2">&quot;b02c39c0-6f8f-4250-97cd-78500af36e27&quot;</span>
<span class="o">-</span>   <span class="n">uuid</span><span class="p">(</span><span class="mi">123</span><span class="n">sh4567890</span><span class="p">,</span> <span class="mi">1234567890</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;00000000-4996-102d-8000-0000499602d2&quot;</span>
<span class="o">-</span>   <span class="n">uuid</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;00000000-0000-1000-8000-000000000000&quot;</span>
<span class="o">-</span>   <span class="n">uuid</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span>
</pre></div>
</div>
</section>
<section id="fonctions-date">
<h3><span class="section-number">14.9.3. </span>Fonctions date<a class="headerlink" href="#fonctions-date" title="Lien vers cette rubrique"></a></h3>
<p><strong>now() -&gt; double</strong></p>
<p>Cette fonction retourne le nombre de secondes écoulées depuis minuit, le 1er janvier 1970 UTC dans le fuseau horaire UTC. Les millisecondes sont renvoyées sous forme de décimales du nombre.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">now</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="mf">1.529677371698E9</span>
<span class="o">-</span>   <span class="nb">round</span><span class="p">(</span><span class="n">now</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="mi">1529677391</span>
</pre></div>
</div>
<p><strong>parse-time(time, format, fallback?) -&gt; double</strong></p>
<p>Analyse la date/heure en utilisant le format spécifié (au format date/heure de Java) et retourne le nombre de secondes écoulées depuis l’époque dans le fuseau horaire UTC. Si aucun fuseau horaire n’est spécifié dans la chaîne de date/heure, le fuseau horaire par défaut est UTC.</p>
<ul class="simple">
<li><p>Si le paramètre <em>fallback</em> n’est pas spécifié, la fonction génère une erreur si <em>time</em> est du mauvais type ou ne correspond pas au format.</p></li>
<li><p>Si <em>fallback</em> est spécifié, cette valeur sera retournée à la place.</p></li>
</ul>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">time</span><span class="p">(</span><span class="s2">&quot;2018-05-30T11:46:37Z&quot;</span><span class="p">,</span> <span class="s2">&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ssX&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mf">1.527680797E9</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">time</span><span class="p">(</span><span class="s2">&quot;2018-05-30T11:46:37&quot;</span><span class="p">,</span> <span class="s2">&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ssX&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">error</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">time</span><span class="p">(</span><span class="s2">&quot;2018-05-30T11:46:37&quot;</span><span class="p">,</span> <span class="s2">&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ssX&quot;</span><span class="p">,</span> <span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">time</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="s2">&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ssX&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>format-time(timestamp, format, timezone?) -&gt; string</strong></p>
<p>Cette fonction formate <em>timestamp</em> (le nombre de secondes écoulées depuis l’époque) en utilisant le format spécifié et retourne la chaîne formatée. Le fuseau horaire par défaut est UTC, mais il peut être remplacé en utilisant l’argument <em>timezone</em>.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">format</span><span class="o">-</span><span class="n">time</span><span class="p">(</span><span class="mi">1529677391</span><span class="p">,</span> <span class="s2">&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;2018-06-22T14:23:11&quot;</span>
<span class="o">-</span>   <span class="nb">format</span><span class="o">-</span><span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;yyyy-MM-dd&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">&quot;1970-01-01&quot;</span>
<span class="o">-</span>   <span class="nb">format</span><span class="o">-</span><span class="n">time</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="s2">&quot;yyyy-MM-dd&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
</section>
<section id="fonctions-booleen">
<h3><span class="section-number">14.9.4. </span>Fonctions booléen<a class="headerlink" href="#fonctions-booleen" title="Lien vers cette rubrique"></a></h3>
<p><strong>boolean(value) -&gt; boolean</strong></p>
<p>Cette fonction convertit la valeur d’entrée en un booléen. Tout est considéré comme « true », sauf « null », [], {}, « « , « false » et 0.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">boolean</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="n">boolean</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="n">boolean</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="n">boolean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="n">boolean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="n">boolean</span><span class="p">(</span><span class="n">true</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="n">boolean</span><span class="p">(</span><span class="n">false</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="n">boolean</span><span class="p">([])</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="n">boolean</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">true</span>
</pre></div>
</div>
<p><strong>not(boolean) -&gt; boolean</strong></p>
<p>Cette fonction retourne la valeur booléenne opposée au paramètre. L’entrée est automatiquement convertie en booléen, donc <em>not(null)</em> retournera « true ».</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="ow">not</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">not</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">not</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="ow">not</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">not</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="ow">not</span><span class="p">(</span><span class="n">true</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="ow">not</span><span class="p">(</span><span class="n">false</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">not</span><span class="p">([])</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">not</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>is-boolean(value) -&gt; boolean</strong></p>
<p>Renvoie « true » si et seulement si la valeur est un booléen.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">boolean</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">boolean</span><span class="p">(</span><span class="n">true</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">boolean</span><span class="p">(</span><span class="n">false</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">boolean</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">boolean</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
</section>
<section id="fonctions-numeriques">
<h3><span class="section-number">14.9.5. </span>Fonctions numériques<a class="headerlink" href="#fonctions-numeriques" title="Lien vers cette rubrique"></a></h3>
<p><strong>is-number(object) -&gt; boolean</strong></p>
<p>Renvoie « true » si l’argument <em>object</em> est un nombre, sinon renvoie « false ».</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">number</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">true</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">number</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">true</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">number</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>is-integer(object) -&gt; boolean</strong></p>
<p>Renvoie « true » si l’argument object  est un entier, sinon renvoie « false ».</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">integer</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">true</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">integer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">integer</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>is-decimal(object) -&gt; boolean</strong></p>
<p>Renvoie « true » si l’argument <em>object</em> est un nombre à virgule flottante, sinon renvoie « false ».
Dans ce contexte, « 1.0 » est considéré comme un nombre à virgule flottante et « 1 » ne l’est pas.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">decimal</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">false</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">decimal</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">true</span>  
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">decimal</span><span class="p">(</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>number(object, fallback?) -&gt; integer|float</strong></p>
<p>Convertit l’argument <em>object</em> en nombre si cela est possible.</p>
<ul class="simple">
<li><p>Les entiers et les nombres décimaux sont retournés tels quels.</p></li>
<li><p>Les chaînes de caractères sont converties en nombres.</p></li>
<li><p>« null » renvoie « null ».</p></li>
<li><p>Tout autre type provoque une erreur, sauf si un <em>fallback</em> est spécifié.</p></li>
</ul>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>      <span class="o">=&gt;</span> <span class="mi">23</span>  
<span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="s2">&quot;23&quot;</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="mi">23</span>  
<span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="s2">&quot;023&quot;</span><span class="p">)</span>   <span class="o">=&gt;</span> <span class="mi">23</span>  
<span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="mf">23.0</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="mf">23.0</span>  
<span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="s2">&quot;.23&quot;</span><span class="p">)</span>   <span class="o">=&gt;</span>  <span class="mf">0.23</span>  
<span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="s2">&quot;-.23&quot;</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="o">-</span><span class="mf">0.23</span>  
<span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">null</span>  
<span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="n">error</span>  
<span class="o">-</span>   <span class="n">number</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">0</span>
</pre></div>
</div>
<p><strong>round(float) -&gt; integer</strong></p>
<p>Arrondit l’argument à l’entier le plus proche.
Les entiers et « null » sont retournés tels quels. Tout autre type provoque une erreur.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="nb">round</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="nb">round</span><span class="p">(</span><span class="mf">1.51</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">2</span>  
<span class="o">-</span>   <span class="nb">round</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>floor(float) -&gt; integer</strong></p>
<p>Arrondit l’argument à l’entier inférieur ou égal.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">floor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="n">floor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="n">floor</span><span class="p">(</span><span class="mf">1.51</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="n">floor</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>ceiling(float) -&gt; integer</strong></p>
<p>Arrondit l’argument à l’entier supérieur ou égal.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">ceiling</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="n">ceiling</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="mi">1</span>  
<span class="o">-</span>   <span class="n">ceiling</span><span class="p">(</span><span class="mf">1.51</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">2</span>  
<span class="o">-</span>   <span class="n">ceiling</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>random() -&gt; float</strong></p>
<p>Renvoie un nombre aléatoire entre 0.0 et 1.0.</p>
<p><em>Exemple :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">random</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="mf">0.24712712424</span>
</pre></div>
</div>
<p><strong>sum(array) -&gt; number</strong></p>
<p>Renvoie la somme des nombres d’un tableau. Le paramètre doit obligatoirement être un tableau constitué uniquement de nombres.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>    <span class="o">=&gt;</span> <span class="mi">6</span>
<span class="o">-</span>   <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>        <span class="o">=&gt;</span> <span class="mi">1</span> 
<span class="o">-</span>   <span class="nb">sum</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="mf">3.0</span>
<span class="o">-</span>   <span class="nb">sum</span><span class="p">([])</span>         <span class="o">=&gt;</span> <span class="mi">0</span>
<span class="o">-</span>   <span class="nb">sum</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>       <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>mod(a,d) -&gt; integer</strong></p>
<p>Renvoie a modulo d. Cette fonction est l’équivalent de l’opérateur % de la plupart des langages de programmation. Son comportement est néanmoins différent pour les nombres négatifs. Il renvoie un résultat compris entre 0 et abs(d).
Mathématiquement, la fonction est définie de la façon suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">floor</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">mod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="mi">0</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="mi">1</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>    <span class="o">=&gt;</span> <span class="mi">2</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>   <span class="o">=&gt;</span> <span class="mi">2</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="mi">2</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>   <span class="o">=&gt;</span> <span class="mi">1</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="mf">10.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">error</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">error</span>
<span class="o">-</span>   <span class="n">mod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">error</span>
</pre></div>
</div>
<p><strong>hash-int(object) -&gt; int</strong></p>
<p>Renvoie une empreinte pour un <em>object</em> donné. L’empreinte est constituée uniquement de chiffres.</p>
<p><em><strong>Point d’attention</strong></em>: Dans des environnements différents, il est possible que, pour un même objet, l’empreinte retournée soit différente.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">3556808</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">310</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">({})</span> <span class="o">=&gt;</span> <span class="mi">8</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">([])</span> <span class="o">=&gt;</span> <span class="mi">1</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="mi">8928</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="mi">9858</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">248</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">6</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="mi">10519540</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">({</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="mi">10519540</span>
<span class="o">-</span>   <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span> <span class="o">==</span> <span class="nb">hash</span><span class="o">-</span><span class="nb">int</span><span class="p">({</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="fonctions-objet">
<h3><span class="section-number">14.9.6. </span>Fonctions objet<a class="headerlink" href="#fonctions-objet" title="Lien vers cette rubrique"></a></h3>
<p><strong>is-object(value) -&gt; boolean</strong></p>
<p>Renvoie « true » si et seulement si la valeur est un objet.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="nb">object</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="nb">object</span><span class="p">({})</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="nb">object</span><span class="p">([])</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="nb">object</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>get-key(object, key, fallback?) -&gt; value</strong></p>
<p>Fait la même chose que <em>.key</em> sur un objet, à la différence que la clé peut être dynamique. Autrement dit, elle peut provenir d’une variable, être recherchée dans des données d’entrée, etc.
Si la clé n’existe pas :</p>
<ul class="simple">
<li><p>« null » est retourné si l’argument de secours (<em>fallback</em>) n’est pas fourni,</p></li>
<li><p>si <em>fallback</em> est spécifié, cette valeur sera retournéee.</p></li>
</ul>
<p><em>Exemple : Fonction retournant la valeur « Norway ».</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>let lookup = {  
  &quot;no&quot; : &quot;Norway&quot;,  
  &quot;se&quot; : &quot;Sweden&quot;  
}  

get-key($lookup, &quot;no&quot;)
</pre></div>
</div>
<p><em>Exemple : Fonction utilisant une valeur de secours et retournant la valeur « <unknown> »</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>let lookup = {  
  &quot;no&quot; : &quot;Norway&quot;,  
  &quot;se&quot; : &quot;Sweden&quot;  
}  

get-key($lookup, &quot;dk&quot;, &quot;&lt;unknown&gt;&quot;) 
</pre></div>
</div>
</section>
<section id="fonctions-tableau-array">
<h3><span class="section-number">14.9.7. </span>Fonctions tableau (array)<a class="headerlink" href="#fonctions-tableau-array" title="Lien vers cette rubrique"></a></h3>
<p><strong>array(value) -&gt; array</strong></p>
<p>Cette fonction convertit la valeur d’entrée en un tableau. Les nombres, les booléens et les chaînes de caractères ne peuvent pas être convertis en tableau.
Les objets sont convertis en tableaux sous la forme suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>  
  <span class="p">{</span><span class="s2">&quot;key&quot;</span> <span class="p">:</span> <span class="n">première</span> <span class="n">clé</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="n">première</span> <span class="n">valeur</span><span class="p">},</span>  
  <span class="p">{</span><span class="s2">&quot;key&quot;</span> <span class="p">:</span> <span class="n">deuxième</span> <span class="n">clé</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="n">deuxième</span> <span class="n">valeur</span><span class="p">},</span>  
  <span class="p">{</span><span class="s2">&quot;key&quot;</span> <span class="p">:</span> <span class="n">troisième</span> <span class="n">clé</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="n">troisième</span> <span class="n">valeur</span><span class="p">},</span>  
  <span class="o">...</span>  
<span class="p">]</span>
</pre></div>
</div>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">array</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">-</span>   <span class="n">array</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">error</span>
<span class="o">-</span>   <span class="n">array</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span> <span class="o">=&gt;</span>  
  	<span class="p">[</span>  
    		<span class="p">{</span><span class="s2">&quot;key&quot;</span> <span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">},</span>  
    		<span class="p">{</span><span class="s2">&quot;key&quot;</span> <span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">}</span>  
 	 <span class="p">]</span>
</pre></div>
</div>
<p><strong>is-array(value) -&gt; boolean</strong></p>
<p>Cette fonction renvoie « true » si et seulement si la valeur est un tableau.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">array</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="ow">is</span><span class="o">-</span><span class="n">array</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>flatten(array) -&gt; array</strong></p>
<p>Aplatit un tableau contenant d’autres tableaux de manière à ce que chaque valeur à l’intérieur d’un sous-tableau soit directement contenue dans le tableau de sortie. Tous les sous-tableaux à n’importe quel niveau d’imbrication sont aplatis, mais les objets et autres valeurs restent inchangés.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">flatten</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="o">-</span>   <span class="n">flatten</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="o">-</span>   <span class="n">flatten</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">[]]]]])</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="o">-</span>   <span class="n">flatten</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
</pre></div>
</div>
<p><strong>all(array) -&gt; boolean</strong></p>
<p>Cette fonction renvoie « true » si et seulement si tous les éléments du tableau sont évalués comme vrais.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">all</span><span class="p">([</span><span class="n">true</span><span class="p">,</span> <span class="n">true</span><span class="p">,</span> <span class="n">true</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="nb">all</span><span class="p">([</span><span class="n">true</span><span class="p">,</span> <span class="n">true</span><span class="p">,</span> <span class="n">false</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="nb">all</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="nb">all</span><span class="p">([])</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="nb">all</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">error</span>
</pre></div>
</div>
<p><strong>any(array) -&gt; boolean</strong></p>
<p>Cette fonction renvoie « true » si et seulement si au moins un élément du tableau est évalué comme vrai.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">any</span><span class="p">([</span><span class="n">false</span><span class="p">,</span> <span class="n">false</span><span class="p">,</span> <span class="n">false</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="nb">any</span><span class="p">([</span><span class="n">false</span><span class="p">,</span> <span class="n">false</span><span class="p">,</span> <span class="n">true</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">true</span>
<span class="o">-</span>   <span class="nb">any</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="nb">any</span><span class="p">([])</span> <span class="o">=&gt;</span> <span class="n">false</span>
<span class="o">-</span>   <span class="nb">any</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">error</span>
</pre></div>
</div>
<p><strong>zip(array1, array2) -&gt; array</strong></p>
<p>Fusionne les deux tableaux en un nouveau tableau constitué de tableaux à deux éléments. Le premier tableau à deux éléments contient le premier élément de array1 et le premier élément de array2, le second contient les deuxièmes éléments, et ainsi de suite. Une erreur est renvoyée si les deux tableaux ont des longueurs différentes.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="o">-</span>   <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="nb">zip</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="nb">zip</span><span class="p">([],</span> <span class="p">[])</span> <span class="o">=&gt;</span> <span class="p">[]</span>
<span class="o">-</span>   <span class="nb">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[])</span> <span class="o">=&gt;</span> <span class="n">error</span>
</pre></div>
</div>
<p><strong>zip-with-index(array) -&gt; array</strong></p>
<p>Cette fonction transforme un tableau en un nouveau tableau où chaque élément du tableau d’entrée est mappé à un objet sous la forme {« value » : &lt;élément du tableau&gt;, « index » : &lt;index de l’élément&gt;}.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="nb">zip</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">[</span>  
          <span class="p">{</span><span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">},</span>  
          <span class="p">{</span><span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">},</span>  
          <span class="p">{</span><span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">}</span>  
      <span class="p">]</span>  
<span class="o">-</span>   <span class="nb">zip</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">index</span><span class="p">([])</span> <span class="o">=&gt;</span> <span class="p">[]</span>
<span class="o">-</span>   <span class="nb">zip</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">index</span><span class="p">(</span><span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="nb">zip</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">error</span>
</pre></div>
</div>
<p><strong>index-of(array, value) -&gt; integer</strong></p>
<p>Cette fonction retourne l’index de <em>value</em> dans <em>array</em>, ou « -1 » si la valeur ne peut pas être trouvée.</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">index</span><span class="o">-</span><span class="n">of</span><span class="p">([],</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">-</span><span class="mi">1</span>
<span class="o">-</span>   <span class="n">index</span><span class="o">-</span><span class="n">of</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">1</span>
<span class="o">-</span>   <span class="n">index</span><span class="o">-</span><span class="n">of</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">null</span><span class="p">],</span> <span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">3</span>
<span class="o">-</span>   <span class="n">index</span><span class="o">-</span><span class="n">of</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">null</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">-</span><span class="mi">1</span>
<span class="o">-</span>   <span class="n">index</span><span class="o">-</span><span class="n">of</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="n">index</span><span class="o">-</span><span class="n">of</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">error</span>
</pre></div>
</div>
</section>
<section id="autres-fonctions">
<h3><span class="section-number">14.9.8. </span>Autres fonctions<a class="headerlink" href="#autres-fonctions" title="Lien vers cette rubrique"></a></h3>
<p><strong>parse-url(url) -&gt; object</strong></p>
<p>Cette fonction analyse l’URL et renvoie un objet avec les clés [<em>scheme</em>, <em>userinfo</em>, <em>host</em>, <em>port</em>, <em>path</em>, <em>query</em>, <em>parameters</em>, <em>fragment</em>].</p>
<p><em>Exemples :</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;http://example.com&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scheme</span> <span class="o">=&gt;</span> <span class="s2">&quot;http&quot;</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;http://example.com&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">host</span> <span class="o">=&gt;</span> <span class="s2">&quot;example.com&quot;</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;http://example.com&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">path</span> <span class="o">=&gt;</span> <span class="n">null</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;http://example.com/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;https://www.example.com/?aa=1&amp;aa=2&amp;bb=&amp;cc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span> <span class="o">=&gt;</span>  <span class="s2">&quot;aa=1&amp;aa=2&amp;bb=&amp;cc&quot;</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;https://www.example.com/?aa=1&amp;aa=2&amp;bb=&amp;cc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">aa</span> <span class="o">=&gt;</span>  <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">]</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;https://www.example.com/?aa=1&amp;aa=2&amp;bb=&amp;cc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">bb</span> <span class="o">=&gt;</span>  <span class="p">[</span><span class="n">null</span><span class="p">]</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;https://www.example.com/?aa=1&amp;aa=2&amp;bb=&amp;cc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">cc</span> <span class="o">=&gt;</span>  <span class="p">[</span><span class="n">null</span><span class="p">]</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;ftp://username:password@host.com/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">userinfo</span> <span class="o">=&gt;</span> <span class="s2">&quot;username:password&quot;</span>
<span class="o">-</span>   <span class="n">parse</span><span class="o">-</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;https://example.com:8443&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">port</span> <span class="o">=&gt;</span> <span class="mi">8443</span>
</pre></div>
</div>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id135" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Pour plus d’informations, consulter le document <em>Modèle de données</em>, « Collection Project ». Un exemple de projet de versement se trouve dans l’<a class="reference internal" href="#annexe-1-exemples-de-donnees-entrantes"><span class="xref myst">annexe 1</span></a> du présent document.</p>
</aside>
<aside class="footnote brackets" id="id136" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>À noter que, dans l’APP « Collecte et préparation des versements », ce champ est alimenté par la valeur du champ « MessageIdentifier ».</p>
</aside>
<aside class="footnote brackets" id="id137" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">3</a><span class="fn-bracket">]</span></span>
<p>Pour plus d’informations, consulter le document <em>Modèle de données</em>, « Collection Transaction ». Un exemple de contexte de collecte se trouve dans l’<a class="reference internal" href="#annexe-1-exemples-de-donnees-entrantes"><span class="xref myst">annexe 1</span></a> du présent document.</p>
</aside>
<aside class="footnote brackets" id="id138" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id14">5</a><span class="fn-bracket">]</span></span>
<p>Si la transaction est clôturée (son statut est égal à « READY »), il n’est plus possible de lui adjoindre des unités archivistiques, ainsi que des métadonnées techniques et des objets.</p>
</aside>
<aside class="footnote brackets" id="id139" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id15">6</a><span class="fn-bracket">]</span></span>
<p>Pour plus d’informations sur l’enregistrement de l’unité archivistique dans la base de données, il est recommandé de consulter le document <em>Modèle de données</em>.</p>
</aside>
<aside class="footnote brackets" id="id140" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">7</a><span class="fn-bracket">]</span></span>
<p>Si la transaction est clôturée (son statut est égal à « READY »), il n’est plus possible de lui adjoindre des unités archivistiques, ainsi que des métadonnées techniques et des objets.</p>
</aside>
<aside class="footnote brackets" id="id141" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id19">8</a><span class="fn-bracket">]</span></span>
<p>Pour plus d’informations sur l’enregistrement du groupe d’objets techniques dans la base de données, il est recommandé de consulter le document <em>Modèle de données</em>.</p>
</aside>
<aside class="footnote brackets" id="id142" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id22">9</a><span class="fn-bracket">]</span></span>
<p>Si la transaction est clôturée (son statut est égal à « READY »), il n’est plus possible de lui adjoindre des unités archivistiques, ainsi que des métadonnées techniques et des objets.</p>
</aside>
<aside class="footnote brackets" id="id143" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id25">1</a>,<a role="doc-backlink" href="#id28">2</a>,<a role="doc-backlink" href="#id29">3</a>,<a role="doc-backlink" href="#id36">4</a>,<a role="doc-backlink" href="#id37">5</a>,<a role="doc-backlink" href="#id43">6</a>,<a role="doc-backlink" href="#id44">7</a>,<a role="doc-backlink" href="#id94">8</a>)</span>
<p>Pour plus d’informations sur l’enregistrement de l’unité archivistique dans la base de données, il est recommandé de consulter le document <em>Modèle de données</em>.</p>
</aside>
<aside class="footnote brackets" id="id144" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id26">1</a>,<a role="doc-backlink" href="#id95">2</a>)</span>
<p>Le fonctionnement est identique à celui de l’import d’arborescence bureautique dans ReSIP.</p>
</aside>
<aside class="footnote brackets" id="id145" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id27">1</a>,<a role="doc-backlink" href="#id96">2</a>)</span>
<p>Pour plus d’informations sur l’enregistrement du groupe d’objets techniques dans la base de données, il est recommandé de consulter le document <em>Modèle de données</em>.</p>
</aside>
<aside class="footnote brackets" id="id146" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>13<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id32">1</a>,<a role="doc-backlink" href="#id40">2</a>)</span>
<p>Se référer à la sous-section « Envoi d’une arborescence bureautique » du présent document.</p>
</aside>
<aside class="footnote brackets" id="id147" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id33">14</a><span class="fn-bracket">]</span></span>
<p>Son modèle est identique au modèle de fichier .csv importé dans ReSIP, hors colonnes ID et ParentID qui ne sont pas supportées par le module de collecte en l’état actuel des développements.</p>
</aside>
<aside class="footnote brackets" id="id148" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>15<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id34">1</a>,<a role="doc-backlink" href="#id41">2</a>)</span>
<p>Pour plus d’informations sur l’enregistrement de l’unité archivistique dans la base de données, il est recommandé de consulter le document <em>Modèle de données</em>.</p>
</aside>
<aside class="footnote brackets" id="id149" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>16<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id35">1</a>,<a role="doc-backlink" href="#id42">2</a>)</span>
<p>Pour plus d’informations sur l’enregistrement du groupe d’objets techniques dans la base de données, il est recommandé de consulter le document <em>Modèle de données</em>.</p>
</aside>
<aside class="footnote brackets" id="id150" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>58<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id60">1</a>,<a role="doc-backlink" href="#id62">2</a>,<a role="doc-backlink" href="#id64">3</a>,<a role="doc-backlink" href="#id66">4</a>,<a role="doc-backlink" href="#id68">5</a>,<a role="doc-backlink" href="#id70">6</a>,<a role="doc-backlink" href="#id73">7</a>,<a role="doc-backlink" href="#id75">8</a>,<a role="doc-backlink" href="#id76">9</a>,<a role="doc-backlink" href="#id79">10</a>)</span>
<p>Pour une vision d’ensemble des différents statuts d’une transaction, se référer à la sous-section « Comment sont gérés les statuts d’une transaction ? » du présent document.</p>
</aside>
<aside class="footnote brackets" id="id151" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id61">19</a><span class="fn-bracket">]</span></span>
<p>Le paramétrage de la purge automatique s’effectue depuis le fichier collect.conf. Pour modifier le délai par défaut, il faut modifier les valeurs des paramètres « purgeTransactionThreadFrequency » et « purgeTransactionDelayInMinutes » pour le(s) tenant(s) concerné(s).</p>
</aside>
<aside class="footnote brackets" id="id152" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id71">21</a><span class="fn-bracket">]</span></span>
<p>Se référer à la sous-section « Réouverture » du présent document.</p>
</aside>
<aside class="footnote brackets" id="id153" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id77">22</a><span class="fn-bracket">]</span></span>
<p>Le paramétrage de la purge automatique s’effectue depuis le fichier collect.conf. Pour modifier le délai par défaut, il faut modifier les valeurs des paramètres « purgeTransactionThreadFrequency » et « purgeTransactionDelayInMinutes » pour le(s) tenant(s) concerné(s).</p>
</aside>
<aside class="footnote brackets" id="id154" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>18<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id82">1</a>,<a role="doc-backlink" href="#id86">2</a>,<a role="doc-backlink" href="#id89">3</a>)</span>
<p>Pour plus d’informations sur l’enregistrement de l’unité archivistique dans la base de données, il est recommandé de consulter le document <em>Modèle de données</em>.</p>
</aside>
<aside class="footnote brackets" id="id155" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id85">17</a><span class="fn-bracket">]</span></span>
<p>Son modèle est identique au modèle de fichier .csv importé dans ReSIP, hors colonnes ID et ParentID qui ne sont pas supportées par le module de collecte en l’état actuel des développements.</p>
</aside>
<aside class="footnote brackets" id="id156" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id100">23</a><span class="fn-bracket">]</span></span>
<p>Ces appels API sont décrits dans la section « Versement » du présent document.</p>
</aside>
<aside class="footnote brackets" id="id157" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id101">24</a><span class="fn-bracket">]</span></span>
<p>La partie ci-dessous explicite la grammaire attendue par le format JSON dans le cadre d’un appel API. Des précisions sur le formalisme attendu est également disponible dans le document <em>Modèle de données</em>.</p>
</aside>
<aside class="footnote brackets" id="id158" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id102">25</a><span class="fn-bracket">]</span></span>
<p>Pour plus d’informations sur les vocabulaires, consulter le document Ontologie.</p>
</aside>
<aside class="footnote brackets" id="id159" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id103">26</a><span class="fn-bracket">]</span></span>
<p>Pour plus d’informations sur ces modélisations particulières, il est recommandé de consulter le document Modèle de données, chapitre 5.1, « Collection Unit ».</p>
</aside>
<aside class="footnote brackets" id="id160" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id104">27</a><span class="fn-bracket">]</span></span>
<p>Les types des éléments propres au SEDA sont listés dans l”<a class="reference internal" href="#annexe-2-types-json"><span class="xref myst">annexe 2</span></a> « Types JSON ». Il est conseillé de se reporter à cette annexe, afin de typer correctement les éléments.</p>
</aside>
<aside class="footnote brackets" id="id161" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id105">28</a><span class="fn-bracket">]</span></span>
<p>La présence de crochets dans le tableau de correspondances indique que le vocabulaire employé dans l’enregistrement peut ou doit se présenter sous la forme d’un tableau ou « array », pouvant contenir un type de valeur en particulier. Le vocabulaire représenté entre crochets est également répétable.</p>
</aside>
<aside class="footnote brackets" id="id162" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id106">29</a><span class="fn-bracket">]</span></span>
<p>Les types des éléments propres au SEDA sont listés dans l’<a class="reference internal" href="#annexe-2-types-json"><span class="xref myst">annexe 2</span></a> « Types JSON ». du présent document.</p>
</aside>
<aside class="footnote brackets" id="id163" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id107">30</a><span class="fn-bracket">]</span></span>
<p>Pour plus d’informations sur ces modélisations particulières, il est recommandé de consulter le document <em>Modèle de données</em>, chapitre 5.1, « Collection Unit ».</p>
</aside>
<aside class="footnote brackets" id="id164" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id108">53</a><span class="fn-bracket">]</span></span>
<p>Se référer à la sous-section « Quels sont les rattachements possibles ? » du présent document.</p>
</aside>
<aside class="footnote brackets" id="id165" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id109">54</a><span class="fn-bracket">]</span></span>
<p>Se référer à la sous-section « Comment paramétrer des règles de transformation ? » du présent document.</p>
</aside>
<aside class="footnote brackets" id="id166" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id110">55</a><span class="fn-bracket">]</span></span>
<p>Pour en savoir plus sur le formalisme JSLT, consulter la documentation disponible sur ce site : https://github.com/schibsted/jslt/blob/master/tutorial.md</p>
</aside>
<aside class="footnote brackets" id="id167" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id111">56</a><span class="fn-bracket">]</span></span>
<p>Pour en savoir plus sur le fonctionnement du format JSON, se référer à la sous-section « Comment formaliser les données dans les API du module de collecte ? » du présent document.</p>
</aside>
<aside class="footnote brackets" id="id168" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id112">57</a><span class="fn-bracket">]</span></span>
<p>Pour en savoir plus, une liste de fonctions est disponible sur ce site : https://github.com/schibsted/jslt/blob/master/functions.md.</p>
</aside>
<aside class="footnote brackets" id="id169" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id113">31</a><span class="fn-bracket">]</span></span>
<p>En l’état actuel des développements, le champ Comment est non répétable, alors que, dans le SEDA, il l’est.</p>
</aside>
<aside class="footnote brackets" id="id170" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id114">32</a><span class="fn-bracket">]</span></span>
<p>#management est à employer en lieu et place de la balise Management pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id171" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id115">33</a><span class="fn-bracket">]</span></span>
<p>Avec un pattern date.</p>
</aside>
<aside class="footnote brackets" id="id172" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id116">34</a><span class="fn-bracket">]</span></span>
<p>Avec un pattern date.</p>
</aside>
<aside class="footnote brackets" id="id173" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id117">35</a><span class="fn-bracket">]</span></span>
<p>Simple énumération.</p>
</aside>
<aside class="footnote brackets" id="id174" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id118">36</a><span class="fn-bracket">]</span></span>
<p>Tableau contenant des éléments de type string.</p>
</aside>
<aside class="footnote brackets" id="id175" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id119">37</a><span class="fn-bracket">]</span></span>
<p>Avec un pattern date.</p>
</aside>
<aside class="footnote brackets" id="id176" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id120">38</a><span class="fn-bracket">]</span></span>
<p>Avec un pattern date.</p>
</aside>
<aside class="footnote brackets" id="id177" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id121">39</a><span class="fn-bracket">]</span></span>
<p>Avec un pattern date.</p>
</aside>
<aside class="footnote brackets" id="id178" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id122">40</a><span class="fn-bracket">]</span></span>
<p>Le SEDA attend plus précisément un pattern langue.</p>
</aside>
<aside class="footnote brackets" id="id179" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id123">41</a><span class="fn-bracket">]</span></span>
<p>Le SEDA attend plus précisément un pattern langue.</p>
</aside>
<aside class="footnote brackets" id="id180" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id124">42</a><span class="fn-bracket">]</span></span>
<p>Avec un pattern date.</p>
</aside>
<aside class="footnote brackets" id="id181" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id125">43</a><span class="fn-bracket">]</span></span>
<p>Avec un pattern date.</p>
</aside>
<aside class="footnote brackets" id="id182" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id126">44</a><span class="fn-bracket">]</span></span>
<p>evId est à employer en lieu et place de la balise EventIdentifier dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id183" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id127">45</a><span class="fn-bracket">]</span></span>
<p>evTypeProc est à employer en lieu et place de la balise EventTypeCode dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id184" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id128">46</a><span class="fn-bracket">]</span></span>
<p>evType est à employer en lieu et place de la balise EventType dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id185" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id129">47</a><span class="fn-bracket">]</span></span>
<p>evDateTime est à employer en lieu et place de la balise EventDateTime dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id186" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id130">48</a><span class="fn-bracket">]</span></span>
<p>evTypeDetail est à employer en lieu et place de la balise EventDetail dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id187" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id131">49</a><span class="fn-bracket">]</span></span>
<p>outcome est à employer en lieu et place de la balise Outcome dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id188" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id132">50</a><span class="fn-bracket">]</span></span>
<p>outDetail est à employer en lieu et place de la balise OutcomeDetail dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id189" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id133">51</a><span class="fn-bracket">]</span></span>
<p>outMessg est à employer en lieu et place de la balise OutcomeDetailMessage dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
<aside class="footnote brackets" id="id190" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id134">52</a><span class="fn-bracket">]</span></span>
<p>evDetData est à employer en lieu et place de la balise EventDetailData dans un schéma de contrôle pour se conformer aux attendus de la solution logicielle Vitam.</p>
</aside>
</aside>
</section>
</section>
</section>


           </div>
          </div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="modele_de_workflow.html" class="btn btn-neutral float-left" title="13. Description des workflows et des opérations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="eliminations.html" class="btn btn-neutral float-right" title="15. Les éliminations avec la solution logicielle Vitam" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2022, Programme Vitam.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: master_8.1.x
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../master_7.1.x/sections/module_de_collecte.html">master_7.1.x</a></dd>
      <dd><a href="module_de_collecte.html">master_8.1.x</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>